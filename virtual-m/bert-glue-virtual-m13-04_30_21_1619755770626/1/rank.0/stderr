My commit is 6731413b Het solver: Incorporate communication overheads (/root/dev/models/deploy)

==========================================================================
My environment variables:
--------------------------------------------------------------------------
CUDNN_VERSION=7.6.2.24-1+cuda10.1
PMIX_ID=4179558401.0
BERT_CONFIG_FILE=/root/dev/dataset/bert/uncased_L-12_H-768_A-12/bert_config.json
LD_LIBRARY_PATH=/usr/local/lib:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:
OMPI_FIRST_RANKS=0
MPI_HOSTS=8603225c1c76
OMPI_MCA_orte_top_session_dir=/tmp/ompi.8603225c1c76.0
LOG_MEMORY_ENABLED=false
PMIX_SYSTEM_TMPDIR=/tmp
EVAL_BATCH_SIZE=48
OMPI_MCA_orte_num_nodes=1
OMPI_COMMAND=run_bert_glue.sh
MODEL=bert
LANG=C.UTF-8
HFI_NO_BACKTRACE=1
HOSTNAME=8603225c1c76
OMPI_MCA_ess_base_vpid=0
OLDPWD=/root
OMPI_MCA_initial_wdir=/root/dev/models/deploy
V100_CONTAINER1=8603225c1c76
ENVIRONMENT=docker
TF_DIR=/root/dev/tensorflow
USE_KERAS_COMPILE_FIT=true
DATA_DIR=/root/dev/dataset/bert/finetuning
HOST_FLAG=--host 8603225c1c76
OMPI_MCA_btl_tcp_if_exclude=lo,docker0,eth1
DATASET=cifar10
DTYPE=fp32
NUM_CHECKPOINTS_TO_KEEP=5
OMPI_COMM_WORLD_NODE_RANK=0
NVIDIA_VISIBLE_DEVICES=all
OMPI_MCA_orte_precondition_transports=2470d961f008a0aa-c55f82ab4b880486
BASE_DIR=/root/dev
OMPI_MCA_orte_ess_node_rank=0
OMPI_MCA_shmem_RUNTIME_QUERY_hint=mmap
OMPI_COMM_WORLD_RANK=0
LOG_STEPS=1
PMIX_RANK=0
OMPI_FILE_LOCATION=/tmp/ompi.8603225c1c76.0/pid.8718/0/0
TRAIN_BATCH_SIZE=48
NCCL_VERSION=2.4.7-1+cuda10.1
OMPI_MCA_orte_local_daemon_uri=4179558400.0;tcp://10.0.1.6,172.18.0.3:57109
GLUE_TASK=CoLA
LEARNING_RATE=2e-5
HOROVOD_GPU_OPERATIONS=NCCL
PWD=/root/dev/models/deploy
NUM_GPUS_PER_NODE=8
HOME=/root
ENABLE_XLA=true
PMIX_SERVER_TMPDIR=/tmp/ompi.8603225c1c76.0/pid.8718
RUN_SCRIPT=run_bert_glue.sh
PMIX_PTL_MODULE=tcp,usock
IPATH_NO_BACKTRACE=1
JOB_NAME=bert-glue-virtual-m13-04_30_21_1619755770626
OMPI_MCA_rmaps_base_oversubscribe=1
P100_CONTAINER1=344e7e96a479
OMPI_MCA_orte_launch=1
CODE_DIR=/root/dev/models/official/nlp/bert
OMPI_MCA_orte_tmpdir_base=/tmp
LOG_DIR=/root/dev/logs
TIMESTAMP=04_30_21_1619755770668
MPI_HOST_FILE=/root/container_hosts/hosts.txt
NUM_VIRTUAL_NODES_PER_DEVICE=1
BERT_MODEL_NAME=uncased_L-12_H-768_A-12
OMPI_APP_CTX_NUM_PROCS=1
OMPI_MCA_orte_output_filename=/root/dev/logs/bert-glue-virtual-m13-04_30_21_1619755770626
LOG_FILE=/dev/stderr
STEPS_PER_LOOP=1
MODELS_DIR=/root/dev/models
OMPI_MCA_orte_app_num=0
PMIX_MCA_mca_base_component_show_load_errors=1
NUM_NODES=1
OMPI_MCA_pml=ob1
PYTHON_COMMAND=/usr/bin/python3
IN_DOCKER_CONTAINER=true
BERT_MODEL_DIR=/root/dev/dataset/bert/uncased_L-12_H-768_A-12
NUM_EPOCHS=1
PMIX_BFROP_BUFFER_TYPE=PMIX_BFROP_BUFFER_NON_DESC
MPI_HOME=/usr/local
CHECKPOINT_NAME=bert_model.ckpt
TERM=xterm
CUDA_PKG_VERSION=10-1=10.1.243-1
CUDA_VERSION=10.1.243
SKIP_EVAL=true
PMIX_DSTORE_ESH_BASE_PATH=/tmp/ompi.8603225c1c76.0/pid.8718/pmix_dstor_ds12_8718
OMPI_MCA_hwloc_base_binding_policy=none
OMPI_MCA_rmaps_base_mapping_policy=node
PMIX_SERVER_URI3=4179558400.0;tcp4://127.0.0.1:38277
PMIX_SERVER_URI2=4179558400.0;tcp4://127.0.0.1:38277
NUM_STEPS=20
OMPI_MCA_orte_hnp_uri=4179558400.0;tcp://10.0.1.6,172.18.0.3:57109
TRAIN_DIR=/root/dev/logs/bert-glue-virtual-m13-04_30_21_1619755770626
OMPI_MCA_mpi_yield_when_idle=0
NVIDIA_DRIVER_CAPABILITIES=compute,utility
DEFAULT_NUM_GPUS_PER_NODE=8
ENABLE_CHECKPOINTS=false
DISTRIBUTION_STRATEGY=mirrored
OMPI_COMM_WORLD_LOCAL_SIZE=1
CUDA_VISIBLE_DEVICES=0
OMPI_COMM_WORLD_SIZE=1
SHLVL=4
PYTHONPATH=:/root/dev/models:/root/dev/models
OMPI_NUM_APP_CTX=1
NVIDIA_REQUIRE_CUDA=cuda>=10.1 brand=tesla,driver>=396,driver<397 brand=tesla,driver>=410,driver<411 brand=tesla,driver>=418,driver<419
OMPI_MCA_pmix=^s1,s2,cray,isolated
DEFAULT_DISTRIBUTION_STRATEGY=mirrored
RUN_TAG=virtual-m13
PMIX_SERVER_URI21=4179558400.0;tcp4://127.0.0.1:38277
SAVED_CHECKPOINT_PATH=/root/dev/dataset/bert/uncased_L-12_H-768_A-12/bert_model.ckpt
PMIX_DSTORE_21_BASE_PATH=/tmp/ompi.8603225c1c76.0/pid.8718/pmix_dstor_ds21_8718
ENABLE_MONITOR_MEMORY=false
CUBLAS_VERSION=10.1.0.105-1
BATCH_SIZE=48
PATH=/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
PMIX_SECURITY_MODE=native
OMPI_MCA_ess=^singleton
NCCL_DEBUG=INFO
PMIX_NAMESPACE=4179558401
OMPI_MCA_orte_ess_num_procs=1
NCCL_SOCKET_IFNAME=^lo,docker0,eth1
OMPI_MCA_ess_base_jobid=4179558401
OMPI_COMM_WORLD_LOCAL_RANK=0
OMPI_UNIVERSE_SIZE=1
OMPI_MCA_orte_jobfam_session_dir=/tmp/ompi.8603225c1c76.0/pid.8718
DEFAULT_NUM_EPOCHS=1
PMIX_GDS_MODULE=ds21,ds12,hash
ENABLE_ELASTICITY=false
NUM_GPUS=1
OMPI_MCA_btl=^openib
_=/usr/bin/printenv
==========================================================================

2021-04-30 04:09:30.886310: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
/usr/local/lib/python3.6/dist-packages/absl/flags/_validators.py:356: UserWarning: Flag --model_dir has a non-None default value; therefore, mark_flag_as_required will pass even if flag is not specified in the command line!
  'command line!' % flag_name)
I0430 04:09:33.069382 139622403405632 virtual_helper.py:221] Setting TF_CONFIG to {"cluster": {"worker": ["8603225c1c76:2222"]}, "task": {"type": "worker", "index": 0}}
INFO:tensorflow:Initializing local devices since in-graph multi-worker training with `MirroredStrategy` is not supported in eager mode. TF_CONFIG will be ignored when when initializing `MirroredStrategy`.
I0430 04:09:33.069997 139622403405632 mirrored_strategy.py:306] Initializing local devices since in-graph multi-worker training with `MirroredStrategy` is not supported in eager mode. TF_CONFIG will be ignored when when initializing `MirroredStrategy`.
2021-04-30 04:09:33.070318: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-30 04:09:33.070423: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-30 04:09:33.111837: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-30 04:09:33.112218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.75GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-30 04:09:33.112241: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-30 04:09:33.114392: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-04-30 04:09:33.114455: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-04-30 04:09:33.116276: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-30 04:09:33.116620: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-30 04:09:33.118704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-30 04:09:33.119975: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-04-30 04:09:33.124614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-04-30 04:09:33.124745: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-30 04:09:33.125155: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-30 04:09:33.125511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-30 04:09:33.125854: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-30 04:09:33.126562: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-30 04:09:33.126697: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-30 04:09:33.127082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.75GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-30 04:09:33.127103: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-30 04:09:33.127130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-04-30 04:09:33.127148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-04-30 04:09:33.127161: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-30 04:09:33.127175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-30 04:09:33.127186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-30 04:09:33.127199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-04-30 04:09:33.127211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-04-30 04:09:33.127281: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-30 04:09:33.127683: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-30 04:09:33.128007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-30 04:09:33.128041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-30 04:10:25.358228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-30 04:10:25.358263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-30 04:10:25.358271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-30 04:10:25.358521: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-30 04:10:25.358975: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-30 04:10:25.359365: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-30 04:10:25.359782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14660 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:04.0, compute capability: 7.0)
INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
I0430 04:10:25.362844 139622403405632 mirrored_strategy.py:350] Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
2021-04-30 04:10:25.365835: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-30 04:10:25.365866: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-30 04:10:25.365895: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-04-30 04:10:25.366860: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so.10.1
2021-04-30 04:10:25.467351: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1415] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI_ERROR_INSUFFICIENT_PRIVILEGES
2021-04-30 04:10:25.467412: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
I0430 04:10:25.467547 139622403405632 run_classifier.py:187] Training using TF 2.x Keras compile/fit API with distribution strategy.
I0430 04:10:28.473021 139622403405632 optimization.py:89] using Adamw optimizer
I0430 04:10:28.473351 139622403405632 optimization.py:142] gradient_clip_norm=1.000000
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0430 04:10:29.231469 139622403405632 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0430 04:10:29.232538 139622403405632 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0430 04:10:29.236186 139622403405632 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0430 04:10:29.237109 139622403405632 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
WARNING:tensorflow:The argument `steps_per_execution` is no longer experimental. Pass `steps_per_execution` instead of `experimental_steps_per_execution`.
W0430 04:10:29.237943 139622403405632 training.py:532] The argument `steps_per_execution` is no longer experimental. Pass `steps_per_execution` instead of `experimental_steps_per_execution`.
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0430 04:10:29.251165 139622403405632 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0430 04:10:29.252000 139622403405632 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0430 04:10:29.253372 139622403405632 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0430 04:10:29.254130 139622403405632 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2021-04-30 04:10:29.287073: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-30 04:10:29.287560: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2000160000 Hz
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0430 04:10:33.917642 139622403405632 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0430 04:10:33.919520 139622403405632 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2021-04-30 04:10:46.029739: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7efafc003b50 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-04-30 04:10:46.029798: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2021-04-30 04:10:46.190593: I tensorflow/compiler/jit/xla_compilation_cache.cc:333] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
Training on virtual node 1 / 1
2021-04-30 04:10:46.832952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
 1/20 [>.............................] - ETA: 12:36 - loss: 0.7071 - accuracy: 0.4583I0430 04:11:09.141812 139622403405632 keras_utils.py:163] TimeHistory: 39.8123 seconds, 1.2057 examples/second between steps 0 and 1
2021-04-30 04:11:09.638044: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-30 04:11:09.638101: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-30 04:11:09.639341: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1415] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI_ERROR_INSUFFICIENT_PRIVILEGES
Training on virtual node 1 / 1
 2/20 [==>...........................] - ETA: 14s - loss: 0.7112 - accuracy: 0.4479  I0430 04:11:09.928404 139622403405632 keras_utils.py:163] TimeHistory: 0.2905 seconds, 165.2567 examples/second between steps 1 and 2
2021-04-30 04:11:09.931141: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-04-30 04:11:09.941326: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 0 callback api events and 0 activity events. 
2021-04-30 04:11:09.945528: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-04-30 04:11:09.951686: I tensorflow/core/profiler/rpc/client/save_profile.cc:137] Creating directory: /root/dev/logs/bert-glue-virtual-m13-04_30_21_1619755770626/summaries/train/plugins/profile/2021_04_30_04_11_09
2021-04-30 04:11:09.955392: I tensorflow/core/profiler/rpc/client/save_profile.cc:143] Dumped gzipped tool data for trace.json.gz to /root/dev/logs/bert-glue-virtual-m13-04_30_21_1619755770626/summaries/train/plugins/profile/2021_04_30_04_11_09/8603225c1c76.trace.json.gz
2021-04-30 04:11:09.992998: I tensorflow/core/profiler/rpc/client/save_profile.cc:137] Creating directory: /root/dev/logs/bert-glue-virtual-m13-04_30_21_1619755770626/summaries/train/plugins/profile/2021_04_30_04_11_09
2021-04-30 04:11:09.998966: I tensorflow/core/profiler/rpc/client/save_profile.cc:143] Dumped gzipped tool data for memory_profile.json.gz to /root/dev/logs/bert-glue-virtual-m13-04_30_21_1619755770626/summaries/train/plugins/profile/2021_04_30_04_11_09/8603225c1c76.memory_profile.json.gz
2021-04-30 04:11:09.999325: I tensorflow/core/profiler/rpc/client/capture_profile.cc:251] Creating directory: /root/dev/logs/bert-glue-virtual-m13-04_30_21_1619755770626/summaries/train/plugins/profile/2021_04_30_04_11_09Dumped tool data for xplane.pb to /root/dev/logs/bert-glue-virtual-m13-04_30_21_1619755770626/summaries/train/plugins/profile/2021_04_30_04_11_09/8603225c1c76.xplane.pb
Dumped tool data for overview_page.pb to /root/dev/logs/bert-glue-virtual-m13-04_30_21_1619755770626/summaries/train/plugins/profile/2021_04_30_04_11_09/8603225c1c76.overview_page.pb
Dumped tool data for input_pipeline.pb to /root/dev/logs/bert-glue-virtual-m13-04_30_21_1619755770626/summaries/train/plugins/profile/2021_04_30_04_11_09/8603225c1c76.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to /root/dev/logs/bert-glue-virtual-m13-04_30_21_1619755770626/summaries/train/plugins/profile/2021_04_30_04_11_09/8603225c1c76.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to /root/dev/logs/bert-glue-virtual-m13-04_30_21_1619755770626/summaries/train/plugins/profile/2021_04_30_04_11_09/8603225c1c76.kernel_stats.pb

Training on virtual node 1 / 1
 3/20 [===>..........................] - ETA: 9s - loss: 0.7097 - accuracy: 0.4560 I0430 04:11:10.287582 139622403405632 keras_utils.py:163] TimeHistory: 0.2865 seconds, 167.5106 examples/second between steps 2 and 3
Training on virtual node 1 / 1
 4/20 [=====>........................] - ETA: 7s - loss: 0.7088 - accuracy: 0.4566I0430 04:11:10.576142 139622403405632 keras_utils.py:163] TimeHistory: 0.2866 seconds, 167.4558 examples/second between steps 3 and 4
Training on virtual node 1 / 1
 5/20 [======>.......................] - ETA: 6s - loss: 0.7075 - accuracy: 0.4594I0430 04:11:10.867717 139622403405632 keras_utils.py:163] TimeHistory: 0.2899 seconds, 165.5772 examples/second between steps 4 and 5
Training on virtual node 1 / 1
 6/20 [========>.....................] - ETA: 5s - loss: 0.7061 - accuracy: 0.4650I0430 04:11:11.156459 139622403405632 keras_utils.py:163] TimeHistory: 0.2870 seconds, 167.2692 examples/second between steps 5 and 6
Training on virtual node 1 / 1
 7/20 [=========>....................] - ETA: 4s - loss: 0.7050 - accuracy: 0.4692I0430 04:11:11.445427 139622403405632 keras_utils.py:163] TimeHistory: 0.2871 seconds, 167.2074 examples/second between steps 6 and 7
Training on virtual node 1 / 1
 8/20 [===========>..................] - ETA: 4s - loss: 0.7043 - accuracy: 0.4727I0430 04:11:11.736411 139622403405632 keras_utils.py:163] TimeHistory: 0.2892 seconds, 165.9714 examples/second between steps 7 and 8
Training on virtual node 1 / 1
 9/20 [============>.................] - ETA: 3s - loss: 0.7033 - accuracy: 0.4770I0430 04:11:12.028693 139622403405632 keras_utils.py:163] TimeHistory: 0.2906 seconds, 165.1748 examples/second between steps 8 and 9
Training on virtual node 1 / 1
10/20 [==============>...............] - ETA: 3s - loss: 0.7019 - accuracy: 0.4829I0430 04:11:12.316160 139622403405632 keras_utils.py:163] TimeHistory: 0.2857 seconds, 168.0260 examples/second between steps 9 and 10
Training on virtual node 1 / 1
11/20 [===============>..............] - ETA: 3s - loss: 0.7006 - accuracy: 0.4882I0430 04:11:12.605497 139622403405632 keras_utils.py:163] TimeHistory: 0.2876 seconds, 166.8890 examples/second between steps 10 and 11
Training on virtual node 1 / 1
12/20 [=================>............] - ETA: 2s - loss: 0.6992 - accuracy: 0.4937I0430 04:11:12.893140 139622403405632 keras_utils.py:163] TimeHistory: 0.2860 seconds, 167.8436 examples/second between steps 11 and 12
Training on virtual node 1 / 1
13/20 [==================>...........] - ETA: 2s - loss: 0.6976 - accuracy: 0.4991I0430 04:11:13.182194 139622403405632 keras_utils.py:163] TimeHistory: 0.2874 seconds, 166.9937 examples/second between steps 12 and 13
Training on virtual node 1 / 1
14/20 [====================>.........] - ETA: 1s - loss: 0.6960 - accuracy: 0.5045I0430 04:11:13.468316 139622403405632 keras_utils.py:163] TimeHistory: 0.2845 seconds, 168.7378 examples/second between steps 13 and 14
Training on virtual node 1 / 1
15/20 [=====================>........] - ETA: 1s - loss: 0.6945 - accuracy: 0.5095I0430 04:11:13.757119 139622403405632 keras_utils.py:163] TimeHistory: 0.2871 seconds, 167.1606 examples/second between steps 14 and 15
Training on virtual node 1 / 1
16/20 [=======================>......] - ETA: 1s - loss: 0.6934 - accuracy: 0.5137I0430 04:11:14.045937 139622403405632 keras_utils.py:163] TimeHistory: 0.2873 seconds, 167.0989 examples/second between steps 15 and 16
Training on virtual node 1 / 1
17/20 [========================>.....] - ETA: 0s - loss: 0.6925 - accuracy: 0.5175I0430 04:11:14.333892 139622403405632 keras_utils.py:163] TimeHistory: 0.2862 seconds, 167.6890 examples/second between steps 16 and 17
Training on virtual node 1 / 1
18/20 [==========================>...] - ETA: 0s - loss: 0.6917 - accuracy: 0.5208I0430 04:11:14.626202 139622403405632 keras_utils.py:163] TimeHistory: 0.2905 seconds, 165.2355 examples/second between steps 17 and 18
Training on virtual node 1 / 1
19/20 [===========================>..] - ETA: 0s - loss: 0.6910 - accuracy: 0.5239I0430 04:11:14.919191 139622403405632 keras_utils.py:163] TimeHistory: 0.2906 seconds, 165.1604 examples/second between steps 18 and 19
Training on virtual node 1 / 1
20/20 [==============================] - ETA: 0s - loss: 0.6903 - accuracy: 0.5269I0430 04:11:15.207927 139622403405632 keras_utils.py:163] TimeHistory: 0.2868 seconds, 167.3650 examples/second between steps 19 and 20
20/20 [==============================] - 46s 319ms/step - loss: 0.6896 - accuracy: 0.5295
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._masked_softmax
W0430 04:11:17.744742 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._dropout
W0430 04:11:17.744932 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._masked_softmax
W0430 04:11:17.744985 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._dropout
W0430 04:11:17.745029 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._masked_softmax
W0430 04:11:17.745100 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._dropout
W0430 04:11:17.745146 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._masked_softmax
W0430 04:11:17.745193 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._dropout
W0430 04:11:17.745238 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._masked_softmax
W0430 04:11:17.745283 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._dropout
W0430 04:11:17.745328 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._masked_softmax
W0430 04:11:17.745374 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._dropout
W0430 04:11:17.745419 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._masked_softmax
W0430 04:11:17.745464 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._dropout
W0430 04:11:17.745515 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._masked_softmax
W0430 04:11:17.745563 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._dropout
W0430 04:11:17.745612 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._masked_softmax
W0430 04:11:17.745663 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._dropout
W0430 04:11:17.745710 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._masked_softmax
W0430 04:11:17.745758 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._dropout
W0430 04:11:17.745802 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._masked_softmax
W0430 04:11:17.745848 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._dropout
W0430 04:11:17.745892 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._masked_softmax
W0430 04:11:17.745940 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._dropout
W0430 04:11:17.745985 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._masked_softmax._mask_expansion_axes
W0430 04:11:17.746036 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._masked_softmax._mask_expansion_axes
W0430 04:11:17.746086 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._masked_softmax._mask_expansion_axes
W0430 04:11:17.746130 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._masked_softmax._mask_expansion_axes
W0430 04:11:17.746178 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._masked_softmax._mask_expansion_axes
W0430 04:11:17.746222 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._masked_softmax._mask_expansion_axes
W0430 04:11:17.746268 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._masked_softmax._mask_expansion_axes
W0430 04:11:17.746313 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._masked_softmax._mask_expansion_axes
W0430 04:11:17.746361 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._masked_softmax._mask_expansion_axes
W0430 04:11:17.746408 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._masked_softmax._mask_expansion_axes
W0430 04:11:17.746455 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._masked_softmax._mask_expansion_axes
W0430 04:11:17.746505 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._masked_softmax._mask_expansion_axes
W0430 04:11:17.746553 139622403405632 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:A checkpoint was restored (e.g. tf.train.Checkpoint.restore or tf.keras.Model.load_weights) but not all checkpointed values were used. See above for specific issues. Use expect_partial() on the load status object, e.g. tf.train.Checkpoint.restore(...).expect_partial(), to silence these warnings, or use assert_consumed() to make the check explicit. See https://www.tensorflow.org/guide/checkpoint#loading_mechanics for details.
W0430 04:11:17.746605 139622403405632 util.py:169] A checkpoint was restored (e.g. tf.train.Checkpoint.restore or tf.keras.Model.load_weights) but not all checkpointed values were used. See above for specific issues. Use expect_partial() on the load status object, e.g. tf.train.Checkpoint.restore(...).expect_partial(), to silence these warnings, or use assert_consumed() to make the check explicit. See https://www.tensorflow.org/guide/checkpoint#loading_mechanics for details.
