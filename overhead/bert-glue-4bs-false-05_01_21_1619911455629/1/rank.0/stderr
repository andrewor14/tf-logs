My commit is c9ca78b6 Add run_overhead_microbenchmark.sh (/root/dev/models/deploy)

==========================================================================
My environment variables:
--------------------------------------------------------------------------
CUDNN_VERSION=7.6.2.24-1+cuda10.1
PMIX_ID=1314455553.0
BERT_CONFIG_FILE=/root/dev/dataset/bert/uncased_L-12_H-768_A-12/bert_config.json
LD_LIBRARY_PATH=/usr/local/lib:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:
USE_RANK_FOR_CVD=true
OMPI_FIRST_RANKS=0
MPI_HOSTS=113f839a85ff,dafd9a5d0ab9
OMPI_MCA_orte_top_session_dir=/tmp/ompi.dafd9a5d0ab9.0
LOG_MEMORY_ENABLED=false
PMIX_SYSTEM_TMPDIR=/tmp
EVAL_BATCH_SIZE=4
OMPI_MCA_orte_num_nodes=1
OMPI_COMMAND=run_bert_glue.sh
MODEL=bert
LANG=C.UTF-8
HFI_NO_BACKTRACE=1
HOSTNAME=dafd9a5d0ab9
OMPI_MCA_ess_base_vpid=0
OLDPWD=/root/dev/logs
OMPI_MCA_initial_wdir=/root/dev/models/deploy
ENVIRONMENT=docker
TF_DIR=/root/dev/tensorflow
USE_KERAS_COMPILE_FIT=true
DATA_DIR=/root/dev/dataset/bert/finetuning
HOST_FLAG=--host 113f839a85ff,dafd9a5d0ab9
OMPI_MCA_btl_tcp_if_exclude=lo,docker0,eth1
DTYPE=fp32
NUM_CHECKPOINTS_TO_KEEP=5
OMPI_COMM_WORLD_NODE_RANK=0
NVIDIA_VISIBLE_DEVICES=all
OMPI_MCA_orte_precondition_transports=3ddf9b6373eed876-ff8732666e51f329
BASE_DIR=/root/dev
OMPI_MCA_orte_ess_node_rank=0
OMPI_MCA_shmem_RUNTIME_QUERY_hint=mmap
OMPI_COMM_WORLD_RANK=0
LOG_STEPS=1
PMIX_RANK=0
OMPI_FILE_LOCATION=/tmp/ompi.dafd9a5d0ab9.0/pid.16357/0/0
TRAIN_BATCH_SIZE=4
NCCL_VERSION=2.4.7-1+cuda10.1
TF_FORCE_GPU_ALLOW_GROWTH=true
OMPI_MCA_orte_local_daemon_uri=1314455552.0;tcp://10.0.1.2,172.19.0.3:57539
GLUE_TASK=CoLA
LEARNING_RATE=2e-5
HOROVOD_GPU_OPERATIONS=NCCL
PWD=/root/dev/models/deploy
NUM_GPUS_PER_NODE=8
HOME=/root
ENABLE_XLA=true
PMIX_SERVER_TMPDIR=/tmp/ompi.dafd9a5d0ab9.0/pid.16357
RUN_SCRIPT=run_bert_glue.sh
PMIX_PTL_MODULE=tcp,usock
IPATH_NO_BACKTRACE=1
JOB_NAME=bert-glue-4bs-false-05_01_21_1619911455629
OMPI_MCA_rmaps_base_oversubscribe=1
OMPI_MCA_orte_launch=1
CODE_DIR=/root/dev/models/official/nlp/bert
OMPI_MCA_orte_tmpdir_base=/tmp
LOG_DIR=/root/dev/logs
TIMESTAMP=05_01_21_1619911456874
MPI_HOST_FILE=/root/container_hosts/hosts.txt
NUM_VIRTUAL_NODES_PER_DEVICE=1
BERT_MODEL_NAME=uncased_L-12_H-768_A-12
OMPI_APP_CTX_NUM_PROCS=1
OMPI_MCA_orte_output_filename=/root/dev/logs/bert-glue-4bs-false-05_01_21_1619911455629
LOG_FILE=/dev/stderr
STEPS_PER_LOOP=1
MODELS_DIR=/root/dev/models
OMPI_MCA_orte_app_num=0
DISABLE_VIRTUAL_NODES=false
PMIX_MCA_mca_base_component_show_load_errors=1
NUM_NODES=1
OMPI_MCA_pml=ob1
PYTHON_COMMAND=/usr/bin/python3
IN_DOCKER_CONTAINER=true
BERT_MODEL_DIR=/root/dev/dataset/bert/uncased_L-12_H-768_A-12
NUM_EPOCHS=1
PMIX_BFROP_BUFFER_TYPE=PMIX_BFROP_BUFFER_NON_DESC
MPI_HOME=/usr/local
CHECKPOINT_NAME=bert_model.ckpt
TERM=xterm
CUDA_PKG_VERSION=10-1=10.1.243-1
CUDA_VERSION=10.1.243
SKIP_EVAL=true
PMIX_DSTORE_ESH_BASE_PATH=/tmp/ompi.dafd9a5d0ab9.0/pid.16357/pmix_dstor_ds12_16357
OMPI_MCA_hwloc_base_binding_policy=none
OMPI_MCA_rmaps_base_mapping_policy=node
PMIX_SERVER_URI3=1314455552.0;tcp4://127.0.0.1:59511
PMIX_SERVER_URI2=1314455552.0;tcp4://127.0.0.1:59511
NUM_STEPS=20
OMPI_MCA_orte_hnp_uri=1314455552.0;tcp://10.0.1.2,172.19.0.3:57539
TRAIN_DIR=/root/dev/logs/bert-glue-4bs-false-05_01_21_1619911455629
OMPI_MCA_mpi_yield_when_idle=0
NVIDIA_DRIVER_CAPABILITIES=compute,utility
DEFAULT_NUM_GPUS_PER_NODE=8
ENABLE_CHECKPOINTS=false
DISTRIBUTION_STRATEGY=mirrored
OMPI_COMM_WORLD_LOCAL_SIZE=1
CUDA_VISIBLE_DEVICES=0
OMPI_COMM_WORLD_SIZE=1
SHLVL=4
PYTHONPATH=$PYTHONPATH:/root/dev/models:/root/dev/models:/root/dev/models
OMPI_NUM_APP_CTX=1
NVIDIA_REQUIRE_CUDA=cuda>=10.1 brand=tesla,driver>=396,driver<397 brand=tesla,driver>=410,driver<411 brand=tesla,driver>=418,driver<419
OMPI_MCA_pmix=^s1,s2,cray,isolated
DEFAULT_DISTRIBUTION_STRATEGY=mirrored
RUN_TAG=4bs-false
PMIX_SERVER_URI21=1314455552.0;tcp4://127.0.0.1:59511
SAVED_CHECKPOINT_PATH=/root/dev/dataset/bert/uncased_L-12_H-768_A-12/bert_model.ckpt
PMIX_DSTORE_21_BASE_PATH=/tmp/ompi.dafd9a5d0ab9.0/pid.16357/pmix_dstor_ds21_16357
ENABLE_MONITOR_MEMORY=false
CUBLAS_VERSION=10.1.0.105-1
BATCH_SIZE=4
PATH=/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
PMIX_SECURITY_MODE=native
OMPI_MCA_ess=^singleton
NCCL_DEBUG=INFO
PMIX_NAMESPACE=1314455553
OMPI_MCA_orte_ess_num_procs=1
NCCL_SOCKET_IFNAME=^lo,docker0,eth1
OMPI_MCA_ess_base_jobid=1314455553
OMPI_COMM_WORLD_LOCAL_RANK=0
OMPI_UNIVERSE_SIZE=2
OMPI_MCA_orte_jobfam_session_dir=/tmp/ompi.dafd9a5d0ab9.0/pid.16357
DEFAULT_NUM_EPOCHS=1
PMIX_GDS_MODULE=ds21,ds12,hash
ENABLE_ELASTICITY=false
NUM_GPUS=1
OMPI_MCA_btl=^openib
_=/usr/bin/printenv
==========================================================================

2021-05-01 23:24:17.152902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
/usr/local/lib/python3.6/dist-packages/tensorflow_addons/utils/ensure_tf_install.py:68: UserWarning: Tensorflow Addons supports using Python ops for all Tensorflow versions above or equal to 2.2.0 and strictly below 2.4.0 (nightly versions are not supported). 
 The versions of TensorFlow you are currently using is 2.4.0-rc3 and is not supported. 
Some things might work, some things might not.
If you were to encounter a bug, do not file an issue.
If you want to make sure you're using a tested and supported configuration, either change the TensorFlow version or the TensorFlow Addons's version. 
You can find the compatibility matrix in TensorFlow Addon's readme:
https://github.com/tensorflow/addons
  UserWarning,
/usr/local/lib/python3.6/dist-packages/absl/flags/_validators.py:359: UserWarning: Flag --model_dir has a non-None default value; therefore, mark_flag_as_required will pass even if flag is not specified in the command line!
  'command line!' % flag_name)
I0501 23:24:19.789574 140405297018688 virtual_helper.py:221] Setting TF_CONFIG to {"cluster": {"worker": ["dafd9a5d0ab9:2222"]}, "task": {"type": "worker", "index": 0}}
INFO:tensorflow:Initializing local devices since in-graph multi-worker training with `MirroredStrategy` is not supported in eager mode. TF_CONFIG will be ignored when when initializing `MirroredStrategy`.
I0501 23:24:19.790450 140405297018688 mirrored_strategy.py:306] Initializing local devices since in-graph multi-worker training with `MirroredStrategy` is not supported in eager mode. TF_CONFIG will be ignored when when initializing `MirroredStrategy`.
2021-05-01 23:24:19.790737: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-01 23:24:19.790856: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-05-01 23:24:26.712477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.665GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-05-01 23:24:26.712538: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-05-01 23:24:26.715117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-05-01 23:24:26.715179: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-05-01 23:24:26.717402: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-01 23:24:26.717754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-01 23:24:26.720236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-01 23:24:26.721536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-05-01 23:24:26.726767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-05-01 23:24:26.728179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-01 23:24:26.730525: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-05-01 23:24:26.731323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.665GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2021-05-01 23:24:26.731344: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-05-01 23:24:26.731365: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-05-01 23:24:26.731383: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-05-01 23:24:26.731400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-05-01 23:24:26.731417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-05-01 23:24:26.731433: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-05-01 23:24:26.731449: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-05-01 23:24:26.731465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-05-01 23:24:26.732765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-05-01 23:24:26.732804: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-05-01 23:24:27.515132: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-01 23:24:27.515210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-05-01 23:24:27.515220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-05-01 23:24:27.517435: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2021-05-01 23:24:27.517482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10097 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:03:00.0, compute capability: 7.5)
INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
I0501 23:24:27.525669 140405297018688 mirrored_strategy.py:350] Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
2021-05-01 23:24:27.529568: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-05-01 23:24:27.529589: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-05-01 23:24:27.529617: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-05-01 23:24:27.530768: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so.10.1
2021-05-01 23:24:27.631290: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1415] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI_ERROR_INSUFFICIENT_PRIVILEGES
2021-05-01 23:24:27.631361: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
I0501 23:24:27.631543 140405297018688 run_classifier.py:187] Training using TF 2.x Keras compile/fit API with distribution strategy.
I0501 23:24:30.821296 140405297018688 optimization.py:89] using Adamw optimizer
I0501 23:24:30.821666 140405297018688 optimization.py:142] gradient_clip_norm=1.000000
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0501 23:24:31.883378 140405297018688 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0501 23:24:31.884586 140405297018688 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0501 23:24:31.888672 140405297018688 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0501 23:24:31.889536 140405297018688 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
WARNING:tensorflow:The argument `steps_per_execution` is no longer experimental. Pass `steps_per_execution` instead of `experimental_steps_per_execution`.
W0501 23:24:31.890440 140405297018688 training.py:532] The argument `steps_per_execution` is no longer experimental. Pass `steps_per_execution` instead of `experimental_steps_per_execution`.
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0501 23:24:31.906338 140405297018688 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0501 23:24:31.907167 140405297018688 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0501 23:24:31.908677 140405297018688 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0501 23:24:31.909558 140405297018688 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2021-05-01 23:24:31.948977: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-05-01 23:24:31.968929: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2095335000 Hz
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0501 23:24:37.379066 140405297018688 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0501 23:24:37.381194 140405297018688 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2021-05-01 23:24:51.500810: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fb01c0015d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-05-01 23:24:51.500883: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2021-05-01 23:24:51.764355: I tensorflow/compiler/jit/xla_compilation_cache.cc:333] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
Training on virtual node 1 / 1
2021-05-01 23:24:52.510663: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
 1/20 [>.............................] - ETA: 13:52 - loss: 0.6357 - accuracy: 1.0000I0501 23:25:15.862482 140405297018688 keras_utils.py:163] TimeHistory: 43.8415 seconds, 0.0912 examples/second between steps 0 and 1
2021-05-01 23:25:16.514744: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-05-01 23:25:16.514817: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-05-01 23:25:16.517153: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1415] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI_ERROR_INSUFFICIENT_PRIVILEGES
Training on virtual node 1 / 1
 2/20 [==>...........................] - ETA: 13s - loss: 0.6391 - accuracy: 0.9375  I0501 23:25:16.589494 140405297018688 keras_utils.py:163] TimeHistory: 0.0749 seconds, 53.3776 examples/second between steps 1 and 2
2021-05-01 23:25:16.594877: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-05-01 23:25:16.608526: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 0 callback api events and 0 activity events. 
2021-05-01 23:25:16.613300: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-05-01 23:25:16.617993: I tensorflow/core/profiler/rpc/client/save_profile.cc:137] Creating directory: /root/dev/logs/bert-glue-4bs-false-05_01_21_1619911455629/summaries/train/plugins/profile/2021_05_01_23_25_16
2021-05-01 23:25:16.620613: I tensorflow/core/profiler/rpc/client/save_profile.cc:143] Dumped gzipped tool data for trace.json.gz to /root/dev/logs/bert-glue-4bs-false-05_01_21_1619911455629/summaries/train/plugins/profile/2021_05_01_23_25_16/dafd9a5d0ab9.trace.json.gz
2021-05-01 23:25:16.659165: I tensorflow/core/profiler/rpc/client/save_profile.cc:137] Creating directory: /root/dev/logs/bert-glue-4bs-false-05_01_21_1619911455629/summaries/train/plugins/profile/2021_05_01_23_25_16
2021-05-01 23:25:16.666338: I tensorflow/core/profiler/rpc/client/save_profile.cc:143] Dumped gzipped tool data for memory_profile.json.gz to /root/dev/logs/bert-glue-4bs-false-05_01_21_1619911455629/summaries/train/plugins/profile/2021_05_01_23_25_16/dafd9a5d0ab9.memory_profile.json.gz
2021-05-01 23:25:16.666769: I tensorflow/core/profiler/rpc/client/capture_profile.cc:251] Creating directory: /root/dev/logs/bert-glue-4bs-false-05_01_21_1619911455629/summaries/train/plugins/profile/2021_05_01_23_25_16Dumped tool data for xplane.pb to /root/dev/logs/bert-glue-4bs-false-05_01_21_1619911455629/summaries/train/plugins/profile/2021_05_01_23_25_16/dafd9a5d0ab9.xplane.pb
Dumped tool data for overview_page.pb to /root/dev/logs/bert-glue-4bs-false-05_01_21_1619911455629/summaries/train/plugins/profile/2021_05_01_23_25_16/dafd9a5d0ab9.overview_page.pb
Dumped tool data for input_pipeline.pb to /root/dev/logs/bert-glue-4bs-false-05_01_21_1619911455629/summaries/train/plugins/profile/2021_05_01_23_25_16/dafd9a5d0ab9.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to /root/dev/logs/bert-glue-4bs-false-05_01_21_1619911455629/summaries/train/plugins/profile/2021_05_01_23_25_16/dafd9a5d0ab9.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to /root/dev/logs/bert-glue-4bs-false-05_01_21_1619911455629/summaries/train/plugins/profile/2021_05_01_23_25_16/dafd9a5d0ab9.kernel_stats.pb

Training on virtual node 1 / 1
 3/20 [===>..........................] - ETA: 7s - loss: 0.6416 - accuracy: 0.8750 I0501 23:25:16.733180 140405297018688 keras_utils.py:163] TimeHistory: 0.0645 seconds, 62.0556 examples/second between steps 2 and 3
Training on virtual node 1 / 1
 4/20 [=====>........................] - ETA: 4s - loss: 0.6386 - accuracy: 0.8594I0501 23:25:16.798808 140405297018688 keras_utils.py:163] TimeHistory: 0.0625 seconds, 63.9788 examples/second between steps 3 and 4
Training on virtual node 1 / 1
 5/20 [======>.......................] - ETA: 3s - loss: 0.6401 - accuracy: 0.8375I0501 23:25:16.858385 140405297018688 keras_utils.py:163] TimeHistory: 0.0569 seconds, 70.3432 examples/second between steps 4 and 5
Training on virtual node 1 / 1
 6/20 [========>.....................] - ETA: 2s - loss: 0.6434 - accuracy: 0.8090I0501 23:25:16.918210 140405297018688 keras_utils.py:163] TimeHistory: 0.0572 seconds, 69.9602 examples/second between steps 5 and 6
WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0618s vs `on_train_batch_end` time: 0.1246s). Check your callbacks.
W0501 23:25:16.920923 140405297018688 callbacks.py:340] Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0618s vs `on_train_batch_end` time: 0.1246s). Check your callbacks.
Training on virtual node 1 / 1
 7/20 [=========>....................] - ETA: 2s - loss: 0.6464 - accuracy: 0.7904I0501 23:25:16.976145 140405297018688 keras_utils.py:163] TimeHistory: 0.0548 seconds, 72.9898 examples/second between steps 6 and 7
Training on virtual node 1 / 1
 8/20 [===========>..................] - ETA: 2s - loss: 0.6498 - accuracy: 0.7736I0501 23:25:17.034426 140405297018688 keras_utils.py:163] TimeHistory: 0.0556 seconds, 71.9851 examples/second between steps 7 and 8
Training on virtual node 1 / 1
 9/20 [============>.................] - ETA: 1s - loss: 0.6537 - accuracy: 0.7556I0501 23:25:17.089365 140405297018688 keras_utils.py:163] TimeHistory: 0.0522 seconds, 76.6801 examples/second between steps 8 and 9
Training on virtual node 1 / 1
10/20 [==============>...............] - ETA: 1s - loss: 0.6563 - accuracy: 0.7425I0501 23:25:17.145370 140405297018688 keras_utils.py:163] TimeHistory: 0.0533 seconds, 75.1018 examples/second between steps 9 and 10
Training on virtual node 1 / 1
11/20 [===============>..............] - ETA: 1s - loss: 0.6580 - accuracy: 0.7329I0501 23:25:17.201136 140405297018688 keras_utils.py:163] TimeHistory: 0.0530 seconds, 75.4599 examples/second between steps 10 and 11
Training on virtual node 1 / 1
12/20 [=================>............] - ETA: 1s - loss: 0.6596 - accuracy: 0.7221I0501 23:25:17.256453 140405297018688 keras_utils.py:163] TimeHistory: 0.0526 seconds, 76.0664 examples/second between steps 11 and 12
Training on virtual node 1 / 1
13/20 [==================>...........] - ETA: 0s - loss: 0.6607 - accuracy: 0.7139I0501 23:25:17.314957 140405297018688 keras_utils.py:163] TimeHistory: 0.0558 seconds, 71.7438 examples/second between steps 12 and 13
Training on virtual node 1 / 1
14/20 [====================>.........] - ETA: 0s - loss: 0.6619 - accuracy: 0.7050I0501 23:25:17.371655 140405297018688 keras_utils.py:163] TimeHistory: 0.0539 seconds, 74.2079 examples/second between steps 13 and 14
Training on virtual node 1 / 1
15/20 [=====================>........] - ETA: 0s - loss: 0.6630 - accuracy: 0.6980I0501 23:25:17.428758 140405297018688 keras_utils.py:163] TimeHistory: 0.0543 seconds, 73.6861 examples/second between steps 14 and 15
Training on virtual node 1 / 1
16/20 [=======================>......] - ETA: 0s - loss: 0.6640 - accuracy: 0.6915I0501 23:25:17.484482 140405297018688 keras_utils.py:163] TimeHistory: 0.0528 seconds, 75.6989 examples/second between steps 15 and 16
Training on virtual node 1 / 1
17/20 [========================>.....] - ETA: 0s - loss: 0.6649 - accuracy: 0.6854I0501 23:25:17.539483 140405297018688 keras_utils.py:163] TimeHistory: 0.0522 seconds, 76.5656 examples/second between steps 16 and 17
Training on virtual node 1 / 1
18/20 [==========================>...] - ETA: 0s - loss: 0.6655 - accuracy: 0.6805I0501 23:25:17.594694 140405297018688 keras_utils.py:163] TimeHistory: 0.0524 seconds, 76.2798 examples/second between steps 17 and 18
Training on virtual node 1 / 1
19/20 [===========================>..] - ETA: 0s - loss: 0.6662 - accuracy: 0.6752I0501 23:25:17.649683 140405297018688 keras_utils.py:163] TimeHistory: 0.0523 seconds, 76.5073 examples/second between steps 18 and 19
Training on virtual node 1 / 1
20/20 [==============================] - ETA: 0s - loss: 0.6668 - accuracy: 0.6702I0501 23:25:17.705379 140405297018688 keras_utils.py:163] TimeHistory: 0.0530 seconds, 75.4772 examples/second between steps 19 and 20
20/20 [==============================] - 46s 97ms/step - loss: 0.6673 - accuracy: 0.6656
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._masked_softmax
W0501 23:25:20.918014 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._dropout
W0501 23:25:20.918284 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._masked_softmax
W0501 23:25:20.918362 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._dropout
W0501 23:25:20.918436 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._masked_softmax
W0501 23:25:20.918506 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._dropout
W0501 23:25:20.918572 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._masked_softmax
W0501 23:25:20.918638 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._dropout
W0501 23:25:20.918703 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._masked_softmax
W0501 23:25:20.918769 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._dropout
W0501 23:25:20.918834 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._masked_softmax
W0501 23:25:20.918900 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._dropout
W0501 23:25:20.918965 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._masked_softmax
W0501 23:25:20.919031 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._dropout
W0501 23:25:20.919096 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._masked_softmax
W0501 23:25:20.919167 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._dropout
W0501 23:25:20.919234 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._masked_softmax
W0501 23:25:20.919303 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._dropout
W0501 23:25:20.919369 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._masked_softmax
W0501 23:25:20.919437 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._dropout
W0501 23:25:20.919502 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._masked_softmax
W0501 23:25:20.919568 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._dropout
W0501 23:25:20.919633 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._masked_softmax
W0501 23:25:20.919701 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._dropout
W0501 23:25:20.919765 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._masked_softmax._mask_expansion_axes
W0501 23:25:20.919834 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._masked_softmax._mask_expansion_axes
W0501 23:25:20.919903 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._masked_softmax._mask_expansion_axes
W0501 23:25:20.919970 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._masked_softmax._mask_expansion_axes
W0501 23:25:20.920036 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._masked_softmax._mask_expansion_axes
W0501 23:25:20.920102 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._masked_softmax._mask_expansion_axes
W0501 23:25:20.920168 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._masked_softmax._mask_expansion_axes
W0501 23:25:20.920234 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._masked_softmax._mask_expansion_axes
W0501 23:25:20.920300 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._masked_softmax._mask_expansion_axes
W0501 23:25:20.920366 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._masked_softmax._mask_expansion_axes
W0501 23:25:20.920433 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._masked_softmax._mask_expansion_axes
W0501 23:25:20.920499 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._masked_softmax._mask_expansion_axes
W0501 23:25:20.920591 140405297018688 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:A checkpoint was restored (e.g. tf.train.Checkpoint.restore or tf.keras.Model.load_weights) but not all checkpointed values were used. See above for specific issues. Use expect_partial() on the load status object, e.g. tf.train.Checkpoint.restore(...).expect_partial(), to silence these warnings, or use assert_consumed() to make the check explicit. See https://www.tensorflow.org/guide/checkpoint#loading_mechanics for details.
W0501 23:25:20.920662 140405297018688 util.py:169] A checkpoint was restored (e.g. tf.train.Checkpoint.restore or tf.keras.Model.load_weights) but not all checkpointed values were used. See above for specific issues. Use expect_partial() on the load status object, e.g. tf.train.Checkpoint.restore(...).expect_partial(), to silence these warnings, or use assert_consumed() to make the check explicit. See https://www.tensorflow.org/guide/checkpoint#loading_mechanics for details.
