My commit is 5f91d180 Add script to run simulator across a variety of traces (/root/dev/models/deploy)

==========================================================================
My environment variables:
--------------------------------------------------------------------------
CUDNN_VERSION=7.6.2.24-1+cuda10.1
PMIX_ID=3722117121.0
LD_LIBRARY_PATH=/usr/local/lib:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:
OMPI_FIRST_RANKS=0
MPI_HOSTS=7ad7ded07caf
OMPI_MCA_orte_top_session_dir=/tmp/ompi.7ad7ded07caf.0
LOG_MEMORY_ENABLED=false
PMIX_SYSTEM_TMPDIR=/tmp
OMPI_MCA_orte_num_nodes=1
OMPI_COMMAND=run_transformer.sh
MODEL=transformer
LANG=C.UTF-8
PARAM_SET=big
HFI_NO_BACKTRACE=1
HOSTNAME=7ad7ded07caf
DECODE_BATCH_SIZE=32
OMPI_MCA_ess_base_vpid=0
OLDPWD=/root/dev/logs
OMPI_MCA_initial_wdir=/root/dev/models/deploy
VOCAB_FILE=/root/dev/dataset/transformer/vocab.ende.32768
ENVIRONMENT=docker
TF_DIR=/root/dev/tensorflow
STEPS_BETWEEN_EVALS=100000
DATA_DIR=/root/dev/dataset/transformer
HOST_FLAG=--host 7ad7ded07caf
OMPI_MCA_btl_tcp_if_exclude=lo,docker0,eth1
DTYPE=fp16
NUM_CHECKPOINTS_TO_KEEP=5
OMPI_COMM_WORLD_NODE_RANK=0
NVIDIA_VISIBLE_DEVICES=all
OMPI_MCA_orte_precondition_transports=2bde44b189756089-7a0362b567a0911e
BASE_DIR=/root/dev
OMPI_MCA_orte_ess_node_rank=0
OMPI_MCA_shmem_RUNTIME_QUERY_hint=mmap
OMPI_COMM_WORLD_RANK=0
LOG_STEPS=1
PMIX_RANK=0
OMPI_FILE_LOCATION=/tmp/ompi.7ad7ded07caf.0/pid.1269/0/0
NCCL_VERSION=2.4.7-1+cuda10.1
OMPI_MCA_orte_local_daemon_uri=3722117120.0;tcp://10.0.1.2,172.18.0.3:35675
HOROVOD_GPU_OPERATIONS=NCCL
PWD=/root/dev/models/deploy
NUM_GPUS_PER_NODE=8
HOME=/root
ENABLE_XLA=true
PMIX_SERVER_TMPDIR=/tmp/ompi.7ad7ded07caf.0/pid.1269
RUN_SCRIPT=run_transformer.sh
PMIX_PTL_MODULE=tcp,usock
IPATH_NO_BACKTRACE=1
JOB_NAME=transformer-04_25_21_1619378609039
OMPI_MCA_rmaps_base_oversubscribe=1
OMPI_MCA_orte_launch=1
CODE_DIR=/root/dev/models/official/nlp/transformer
OMPI_MCA_orte_tmpdir_base=/tmp
LOG_DIR=/root/dev/logs
TIMESTAMP=04_25_21_1619378609094
MPI_HOST_FILE=/root/container_hosts/hosts.txt
BLEU_SOURCE=
NUM_VIRTUAL_NODES_PER_DEVICE=1
OMPI_APP_CTX_NUM_PROCS=1
OMPI_MCA_orte_output_filename=/root/dev/logs/transformer-04_25_21_1619378609039
LOG_FILE=/dev/stderr
MODELS_DIR=/root/dev/models
OMPI_MCA_orte_app_num=0
DISABLE_VIRTUAL_NODES=true
PMIX_MCA_mca_base_component_show_load_errors=1
NUM_NODES=1
MAX_LENGTH=64
OMPI_MCA_pml=ob1
PYTHON_COMMAND=/usr/bin/python3
IN_DOCKER_CONTAINER=true
NUM_EPOCHS=100000
PMIX_BFROP_BUFFER_TYPE=PMIX_BFROP_BUFFER_NON_DESC
MPI_HOME=/usr/local
TERM=xterm
CUDA_PKG_VERSION=10-1=10.1.243-1
CUDA_VERSION=10.1.243
SKIP_EVAL=true
PMIX_DSTORE_ESH_BASE_PATH=/tmp/ompi.7ad7ded07caf.0/pid.1269/pmix_dstor_ds12_1269
OMPI_MCA_hwloc_base_binding_policy=none
BLEU_REF=
OMPI_MCA_rmaps_base_mapping_policy=node
PMIX_SERVER_URI3=3722117120.0;tcp4://127.0.0.1:46929
PMIX_SERVER_URI2=3722117120.0;tcp4://127.0.0.1:46929
NUM_STEPS=100000
OMPI_MCA_orte_hnp_uri=3722117120.0;tcp://10.0.1.2,172.18.0.3:35675
TRAIN_DIR=/root/dev/logs/transformer-04_25_21_1619378609039
OMPI_MCA_mpi_yield_when_idle=0
NVIDIA_DRIVER_CAPABILITIES=compute,utility
DEFAULT_NUM_GPUS_PER_NODE=8
ENABLE_CHECKPOINTS=false
DISTRIBUTION_STRATEGY=mirrored
OMPI_COMM_WORLD_LOCAL_SIZE=1
CUDA_VISIBLE_DEVICES=0
OMPI_COMM_WORLD_SIZE=1
SHLVL=4
PYTHONPATH=:/root/dev/models:/root/dev/models
OMPI_NUM_APP_CTX=1
NVIDIA_REQUIRE_CUDA=cuda>=10.1 brand=tesla,driver>=396,driver<397 brand=tesla,driver>=410,driver<411 brand=tesla,driver>=418,driver<419
OMPI_MCA_pmix=^s1,s2,cray,isolated
DEFAULT_DISTRIBUTION_STRATEGY=mirrored
PMIX_SERVER_URI21=3722117120.0;tcp4://127.0.0.1:46929
SAVED_CHECKPOINT_PATH=
PMIX_DSTORE_21_BASE_PATH=/tmp/ompi.7ad7ded07caf.0/pid.1269/pmix_dstor_ds21_1269
ENABLE_MONITOR_MEMORY=false
ENABLE_HETEROGENEOUS_PROFILE=true
CUBLAS_VERSION=10.1.0.105-1
BATCH_SIZE=3072
PATH=/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
PMIX_SECURITY_MODE=native
OMPI_MCA_ess=^singleton
NCCL_DEBUG=INFO
PMIX_NAMESPACE=3722117121
OMPI_MCA_orte_ess_num_procs=1
NCCL_SOCKET_IFNAME=^lo,docker0,eth1
OMPI_MCA_ess_base_jobid=3722117121
OMPI_COMM_WORLD_LOCAL_RANK=0
OMPI_UNIVERSE_SIZE=1
OMPI_MCA_orte_jobfam_session_dir=/tmp/ompi.7ad7ded07caf.0/pid.1269
PMIX_GDS_MODULE=ds21,ds12,hash
ENABLE_ELASTICITY=false
NUM_GPUS=1
OMPI_MCA_btl=^openib
_=/usr/bin/printenv
==========================================================================

2021-04-25 19:23:29.330619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
I0425 19:23:34.110260 140656272164672 virtual_helper.py:221] Setting TF_CONFIG to {"cluster": {"worker": ["7ad7ded07caf:2222"]}, "task": {"type": "worker", "index": 0}}
INFO:tensorflow:Initializing local devices since in-graph multi-worker training with `MirroredStrategy` is not supported in eager mode. TF_CONFIG will be ignored when when initializing `MirroredStrategy`.
I0425 19:23:34.111003 140656272164672 mirrored_strategy.py:306] Initializing local devices since in-graph multi-worker training with `MirroredStrategy` is not supported in eager mode. TF_CONFIG will be ignored when when initializing `MirroredStrategy`.
2021-04-25 19:23:34.111337: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-25 19:23:34.111419: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-25 19:23:34.204419: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-25 19:23:34.205861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla K80 computeCapability: 3.7
coreClock: 0.8235GHz coreCount: 13 deviceMemorySize: 11.17GiB deviceMemoryBandwidth: 223.96GiB/s
2021-04-25 19:23:34.205891: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-25 19:23:34.208109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-04-25 19:23:34.208168: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-04-25 19:23:34.210129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-25 19:23:34.210713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-25 19:23:34.213127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-25 19:23:34.214401: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-04-25 19:23:34.218923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-04-25 19:23:34.219046: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-25 19:23:34.220535: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-25 19:23:34.221855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-25 19:23:34.225063: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-25 19:23:34.225248: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-25 19:23:34.226843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla K80 computeCapability: 3.7
coreClock: 0.8235GHz coreCount: 13 deviceMemorySize: 11.17GiB deviceMemoryBandwidth: 223.96GiB/s
2021-04-25 19:23:34.226878: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-25 19:23:34.226946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-04-25 19:23:34.226981: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-04-25 19:23:34.227003: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-25 19:23:34.227032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-25 19:23:34.227060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-25 19:23:34.227088: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-04-25 19:23:34.227117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-04-25 19:23:34.227205: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-25 19:23:34.228692: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-25 19:23:34.230213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-25 19:23:34.230293: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-25 19:23:34.815282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-25 19:23:34.815349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-25 19:23:34.815359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-25 19:23:34.815741: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-25 19:23:34.817380: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-25 19:23:34.818915: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-25 19:23:34.820308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10615 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:04.0, compute capability: 3.7)
INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
I0425 19:23:34.825630 140656272164672 mirrored_strategy.py:350] Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
I0425 19:23:34.826881 140656272164672 transformer_main.py:180] Running transformer with num_gpus = 1
I0425 19:23:34.827438 140656272164672 transformer_main.py:184] For training, using distribution strategy: <tensorflow.python.distribute.mirrored_strategy.MirroredStrategy object at 0x7feb8a490e10>
WARNING:tensorflow:From /root/dev/models/official/nlp/transformer/attention_layer.py:63: DenseEinsum.__init__ (from official.nlp.modeling.layers.dense_einsum) is deprecated and will be removed in a future version.
Instructions for updating:
DenseEinsum is deprecated. Please use tf.keras.experimental.EinsumDense layer instead.
W0425 19:23:36.416786 140656272164672 deprecation.py:339] From /root/dev/models/official/nlp/transformer/attention_layer.py:63: DenseEinsum.__init__ (from official.nlp.modeling.layers.dense_einsum) is deprecated and will be removed in a future version.
Instructions for updating:
DenseEinsum is deprecated. Please use tf.keras.experimental.EinsumDense layer instead.
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0425 19:23:39.621481 140656272164672 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0425 19:23:39.623381 140656272164672 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0425 19:23:39.627132 140656272164672 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0425 19:23:39.628158 140656272164672 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0425 19:23:40.127599 140656272164672 transformer_main.py:314] Start train iteration at global step:0
2021-04-25 19:23:40.178206: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-25 19:23:40.178759: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2199995000 Hz
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 1
I0425 19:23:40.259891 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 1
INFO:tensorflow:Running non-virtual train step
I0425 19:23:40.315972 140632756561664 training.py:940] Running non-virtual train step
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0425 19:23:45.314601 140656272164672 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0425 19:23:45.317123 140656272164672 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Running non-virtual train step
I0425 19:23:47.032495 140632756561664 training.py:940] Running non-virtual train step
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0425 19:23:51.801040 140656272164672 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0425 19:23:51.803310 140656272164672 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2021-04-25 19:23:56.245582: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
I0425 19:23:58.761012 140656272164672 keras_utils.py:163] TimeHistory: 18.50 seconds, 0.05 examples/second between steps 0 and 1
I0425 19:23:58.957255 140656272164672 keras_utils.py:163] TimeHistory: 0.20 seconds, 5.11 examples/second between steps 1 and 2
I0425 19:23:59.149627 140656272164672 keras_utils.py:163] TimeHistory: 0.19 seconds, 5.21 examples/second between steps 2 and 3
I0425 19:23:59.328888 140656272164672 keras_utils.py:163] TimeHistory: 0.18 seconds, 5.59 examples/second between steps 3 and 4
I0425 19:23:59.498718 140656272164672 keras_utils.py:163] TimeHistory: 0.17 seconds, 5.90 examples/second between steps 4 and 5
I0425 19:23:59.669856 140656272164672 keras_utils.py:163] TimeHistory: 0.17 seconds, 5.86 examples/second between steps 5 and 6
I0425 19:23:59.840302 140656272164672 keras_utils.py:163] TimeHistory: 0.17 seconds, 5.88 examples/second between steps 6 and 7
I0425 19:24:00.013665 140656272164672 keras_utils.py:163] TimeHistory: 0.17 seconds, 5.78 examples/second between steps 7 and 8
I0425 19:24:00.174841 140656272164672 keras_utils.py:163] TimeHistory: 0.16 seconds, 6.22 examples/second between steps 8 and 9
I0425 19:24:00.351464 140656272164672 keras_utils.py:163] TimeHistory: 0.18 seconds, 5.67 examples/second between steps 9 and 10
I0425 19:24:00.511853 140656272164672 keras_utils.py:163] TimeHistory: 0.16 seconds, 6.25 examples/second between steps 10 and 11
I0425 19:24:00.683113 140656272164672 keras_utils.py:163] TimeHistory: 0.17 seconds, 5.85 examples/second between steps 11 and 12
I0425 19:24:00.841880 140656272164672 keras_utils.py:163] TimeHistory: 0.16 seconds, 6.31 examples/second between steps 12 and 13
I0425 19:24:01.002375 140656272164672 keras_utils.py:163] TimeHistory: 0.16 seconds, 6.24 examples/second between steps 13 and 14
I0425 19:24:01.172430 140656272164672 keras_utils.py:163] TimeHistory: 0.17 seconds, 5.89 examples/second between steps 14 and 15
I0425 19:24:01.345362 140656272164672 keras_utils.py:163] TimeHistory: 0.17 seconds, 5.79 examples/second between steps 15 and 16
I0425 19:24:01.517842 140656272164672 keras_utils.py:163] TimeHistory: 0.17 seconds, 5.81 examples/second between steps 16 and 17
I0425 19:24:01.688299 140656272164672 keras_utils.py:163] TimeHistory: 0.17 seconds, 5.88 examples/second between steps 17 and 18
I0425 19:24:01.845750 140656272164672 keras_utils.py:163] TimeHistory: 0.16 seconds, 6.37 examples/second between steps 18 and 19
I0425 19:24:02.006801 140656272164672 keras_utils.py:163] TimeHistory: 0.16 seconds, 6.22 examples/second between steps 19 and 20
I0425 19:24:02.007630 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 2
I0425 19:24:02.007916 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 2
INFO:tensorflow:Running non-virtual train step
I0425 19:24:02.016367 140631590565632 training.py:940] Running non-virtual train step
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0425 19:24:06.930487 140656272164672 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0425 19:24:06.932893 140656272164672 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0425 19:24:11.639477 140656272164672 keras_utils.py:163] TimeHistory: 9.63 seconds, 0.21 examples/second between steps 20 and 21
I0425 19:24:11.860859 140656272164672 keras_utils.py:163] TimeHistory: 0.22 seconds, 9.05 examples/second between steps 21 and 22
I0425 19:24:12.074278 140656272164672 keras_utils.py:163] TimeHistory: 0.21 seconds, 9.38 examples/second between steps 22 and 23
I0425 19:24:12.292837 140656272164672 keras_utils.py:163] TimeHistory: 0.22 seconds, 9.16 examples/second between steps 23 and 24
I0425 19:24:12.508719 140656272164672 keras_utils.py:163] TimeHistory: 0.22 seconds, 9.28 examples/second between steps 24 and 25
I0425 19:24:12.728956 140656272164672 keras_utils.py:163] TimeHistory: 0.22 seconds, 9.09 examples/second between steps 25 and 26
I0425 19:24:12.934458 140656272164672 keras_utils.py:163] TimeHistory: 0.21 seconds, 9.74 examples/second between steps 26 and 27
I0425 19:24:13.142838 140656272164672 keras_utils.py:163] TimeHistory: 0.21 seconds, 9.61 examples/second between steps 27 and 28
I0425 19:24:13.316359 140656272164672 keras_utils.py:163] TimeHistory: 0.17 seconds, 11.54 examples/second between steps 28 and 29
I0425 19:24:13.492601 140656272164672 keras_utils.py:163] TimeHistory: 0.18 seconds, 11.37 examples/second between steps 29 and 30
I0425 19:24:13.667037 140656272164672 keras_utils.py:163] TimeHistory: 0.17 seconds, 11.48 examples/second between steps 30 and 31
I0425 19:24:13.838717 140656272164672 keras_utils.py:163] TimeHistory: 0.17 seconds, 11.67 examples/second between steps 31 and 32
I0425 19:24:14.047867 140656272164672 keras_utils.py:163] TimeHistory: 0.21 seconds, 9.58 examples/second between steps 32 and 33
I0425 19:24:14.260333 140656272164672 keras_utils.py:163] TimeHistory: 0.21 seconds, 9.42 examples/second between steps 33 and 34
I0425 19:24:14.480951 140656272164672 keras_utils.py:163] TimeHistory: 0.22 seconds, 9.07 examples/second between steps 34 and 35
I0425 19:24:14.700324 140656272164672 keras_utils.py:163] TimeHistory: 0.22 seconds, 9.13 examples/second between steps 35 and 36
I0425 19:24:14.873290 140656272164672 keras_utils.py:163] TimeHistory: 0.17 seconds, 11.58 examples/second between steps 36 and 37
I0425 19:24:15.089018 140656272164672 keras_utils.py:163] TimeHistory: 0.22 seconds, 9.28 examples/second between steps 37 and 38
I0425 19:24:15.295996 140656272164672 keras_utils.py:163] TimeHistory: 0.21 seconds, 9.67 examples/second between steps 38 and 39
I0425 19:24:15.501239 140656272164672 keras_utils.py:163] TimeHistory: 0.20 seconds, 9.76 examples/second between steps 39 and 40
I0425 19:24:15.501900 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 4
I0425 19:24:15.502145 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 4
INFO:tensorflow:Running non-virtual train step
I0425 19:24:15.509502 140631582172928 training.py:940] Running non-virtual train step
I0425 19:24:24.878880 140656272164672 keras_utils.py:163] TimeHistory: 9.38 seconds, 0.43 examples/second between steps 40 and 41
I0425 19:24:25.099423 140656272164672 keras_utils.py:163] TimeHistory: 0.22 seconds, 18.17 examples/second between steps 41 and 42
I0425 19:24:25.406563 140656272164672 keras_utils.py:163] TimeHistory: 0.31 seconds, 13.04 examples/second between steps 42 and 43
I0425 19:24:25.672921 140656272164672 keras_utils.py:163] TimeHistory: 0.27 seconds, 15.03 examples/second between steps 43 and 44
I0425 19:24:25.987700 140656272164672 keras_utils.py:163] TimeHistory: 0.31 seconds, 12.72 examples/second between steps 44 and 45
I0425 19:24:26.251007 140656272164672 keras_utils.py:163] TimeHistory: 0.26 seconds, 15.21 examples/second between steps 45 and 46
I0425 19:24:26.465392 140656272164672 keras_utils.py:163] TimeHistory: 0.21 seconds, 18.68 examples/second between steps 46 and 47
I0425 19:24:26.686382 140656272164672 keras_utils.py:163] TimeHistory: 0.22 seconds, 18.12 examples/second between steps 47 and 48
I0425 19:24:26.993587 140656272164672 keras_utils.py:163] TimeHistory: 0.31 seconds, 13.03 examples/second between steps 48 and 49
I0425 19:24:27.207987 140656272164672 keras_utils.py:163] TimeHistory: 0.21 seconds, 18.68 examples/second between steps 49 and 50
I0425 19:24:27.415488 140656272164672 keras_utils.py:163] TimeHistory: 0.21 seconds, 19.30 examples/second between steps 50 and 51
I0425 19:24:27.713141 140656272164672 keras_utils.py:163] TimeHistory: 0.30 seconds, 13.45 examples/second between steps 51 and 52
I0425 19:24:27.966173 140656272164672 keras_utils.py:163] TimeHistory: 0.25 seconds, 15.83 examples/second between steps 52 and 53
I0425 19:24:28.185749 140656272164672 keras_utils.py:163] TimeHistory: 0.22 seconds, 18.25 examples/second between steps 53 and 54
I0425 19:24:28.391208 140656272164672 keras_utils.py:163] TimeHistory: 0.21 seconds, 19.49 examples/second between steps 54 and 55
I0425 19:24:28.646681 140656272164672 keras_utils.py:163] TimeHistory: 0.26 seconds, 15.67 examples/second between steps 55 and 56
I0425 19:24:28.864278 140656272164672 keras_utils.py:163] TimeHistory: 0.22 seconds, 18.40 examples/second between steps 56 and 57
I0425 19:24:29.130218 140656272164672 keras_utils.py:163] TimeHistory: 0.27 seconds, 15.06 examples/second between steps 57 and 58
I0425 19:24:29.446906 140656272164672 keras_utils.py:163] TimeHistory: 0.32 seconds, 12.64 examples/second between steps 58 and 59
I0425 19:24:29.757520 140656272164672 keras_utils.py:163] TimeHistory: 0.31 seconds, 12.89 examples/second between steps 59 and 60
I0425 19:24:29.758128 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 8
I0425 19:24:29.758362 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 8
INFO:tensorflow:Running non-virtual train step
I0425 19:24:29.766879 140631573780224 training.py:940] Running non-virtual train step
I0425 19:24:39.582745 140656272164672 keras_utils.py:163] TimeHistory: 9.82 seconds, 0.81 examples/second between steps 60 and 61
I0425 19:24:39.874545 140656272164672 keras_utils.py:163] TimeHistory: 0.29 seconds, 27.45 examples/second between steps 61 and 62
I0425 19:24:40.302460 140656272164672 keras_utils.py:163] TimeHistory: 0.43 seconds, 18.71 examples/second between steps 62 and 63
I0425 19:24:40.748943 140656272164672 keras_utils.py:163] TimeHistory: 0.45 seconds, 17.93 examples/second between steps 63 and 64
I0425 19:24:41.100945 140656272164672 keras_utils.py:163] TimeHistory: 0.35 seconds, 22.75 examples/second between steps 64 and 65
I0425 19:24:41.409340 140656272164672 keras_utils.py:163] TimeHistory: 0.31 seconds, 25.97 examples/second between steps 65 and 66
I0425 19:24:41.763370 140656272164672 keras_utils.py:163] TimeHistory: 0.35 seconds, 22.62 examples/second between steps 66 and 67
I0425 19:24:41.987869 140656272164672 keras_utils.py:163] TimeHistory: 0.22 seconds, 35.67 examples/second between steps 67 and 68
I0425 19:24:42.373151 140656272164672 keras_utils.py:163] TimeHistory: 0.38 seconds, 20.78 examples/second between steps 68 and 69
I0425 19:24:42.627896 140656272164672 keras_utils.py:163] TimeHistory: 0.25 seconds, 31.44 examples/second between steps 69 and 70
I0425 19:24:42.925419 140656272164672 keras_utils.py:163] TimeHistory: 0.30 seconds, 26.91 examples/second between steps 70 and 71
I0425 19:24:43.395673 140656272164672 keras_utils.py:163] TimeHistory: 0.47 seconds, 17.02 examples/second between steps 71 and 72
I0425 19:24:43.714548 140656272164672 keras_utils.py:163] TimeHistory: 0.32 seconds, 25.12 examples/second between steps 72 and 73
I0425 19:24:44.091339 140656272164672 keras_utils.py:163] TimeHistory: 0.38 seconds, 21.25 examples/second between steps 73 and 74
I0425 19:24:44.398309 140656272164672 keras_utils.py:163] TimeHistory: 0.31 seconds, 26.09 examples/second between steps 74 and 75
I0425 19:24:44.840155 140656272164672 keras_utils.py:163] TimeHistory: 0.44 seconds, 18.12 examples/second between steps 75 and 76
I0425 19:24:45.263456 140656272164672 keras_utils.py:163] TimeHistory: 0.42 seconds, 18.91 examples/second between steps 76 and 77
I0425 19:24:45.618732 140656272164672 keras_utils.py:163] TimeHistory: 0.35 seconds, 22.54 examples/second between steps 77 and 78
I0425 19:24:45.962537 140656272164672 keras_utils.py:163] TimeHistory: 0.34 seconds, 23.29 examples/second between steps 78 and 79
I0425 19:24:46.268774 140656272164672 keras_utils.py:163] TimeHistory: 0.31 seconds, 26.16 examples/second between steps 79 and 80
I0425 19:24:46.269385 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 12
I0425 19:24:46.269563 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 12
INFO:tensorflow:Running non-virtual train step
I0425 19:24:46.277426 140631565387520 training.py:940] Running non-virtual train step
I0425 19:24:55.716567 140656272164672 keras_utils.py:163] TimeHistory: 9.45 seconds, 1.27 examples/second between steps 80 and 81
I0425 19:24:56.373284 140656272164672 keras_utils.py:163] TimeHistory: 0.66 seconds, 18.28 examples/second between steps 81 and 82
I0425 19:24:56.908006 140656272164672 keras_utils.py:163] TimeHistory: 0.53 seconds, 22.45 examples/second between steps 82 and 83
I0425 19:24:57.546580 140656272164672 keras_utils.py:163] TimeHistory: 0.64 seconds, 18.80 examples/second between steps 83 and 84
I0425 19:24:58.152923 140656272164672 keras_utils.py:163] TimeHistory: 0.61 seconds, 19.80 examples/second between steps 84 and 85
I0425 19:24:58.479738 140656272164672 keras_utils.py:163] TimeHistory: 0.33 seconds, 36.76 examples/second between steps 85 and 86
I0425 19:24:58.917714 140656272164672 keras_utils.py:163] TimeHistory: 0.44 seconds, 27.42 examples/second between steps 86 and 87
I0425 19:24:59.470005 140656272164672 keras_utils.py:163] TimeHistory: 0.55 seconds, 21.74 examples/second between steps 87 and 88
I0425 19:24:59.826473 140656272164672 keras_utils.py:163] TimeHistory: 0.36 seconds, 33.69 examples/second between steps 88 and 89
I0425 19:25:00.302864 140656272164672 keras_utils.py:163] TimeHistory: 0.48 seconds, 25.20 examples/second between steps 89 and 90
I0425 19:25:00.836709 140656272164672 keras_utils.py:163] TimeHistory: 0.53 seconds, 22.49 examples/second between steps 90 and 91
I0425 19:25:01.222783 140656272164672 keras_utils.py:163] TimeHistory: 0.39 seconds, 31.11 examples/second between steps 91 and 92
I0425 19:25:01.497382 140656272164672 keras_utils.py:163] TimeHistory: 0.27 seconds, 43.76 examples/second between steps 92 and 93
I0425 19:25:01.876794 140656272164672 keras_utils.py:163] TimeHistory: 0.38 seconds, 31.65 examples/second between steps 93 and 94
I0425 19:25:02.339616 140656272164672 keras_utils.py:163] TimeHistory: 0.46 seconds, 25.94 examples/second between steps 94 and 95
I0425 19:25:02.986023 140656272164672 keras_utils.py:163] TimeHistory: 0.65 seconds, 18.58 examples/second between steps 95 and 96
I0425 19:25:03.368045 140656272164672 keras_utils.py:163] TimeHistory: 0.38 seconds, 31.44 examples/second between steps 96 and 97
I0425 19:25:03.972934 140656272164672 keras_utils.py:163] TimeHistory: 0.60 seconds, 19.85 examples/second between steps 97 and 98
I0425 19:25:04.246661 140656272164672 keras_utils.py:163] TimeHistory: 0.27 seconds, 43.89 examples/second between steps 98 and 99
I0425 19:25:04.903822 140656272164672 keras_utils.py:163] TimeHistory: 0.66 seconds, 18.27 examples/second between steps 99 and 100
I0425 19:25:04.904504 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 16
I0425 19:25:04.904690 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 16
INFO:tensorflow:Running non-virtual train step
I0425 19:25:04.912787 140631556994816 training.py:940] Running non-virtual train step
I0425 19:25:14.676748 140656272164672 keras_utils.py:163] TimeHistory: 9.77 seconds, 1.64 examples/second between steps 100 and 101
I0425 19:25:15.002575 140656272164672 keras_utils.py:163] TimeHistory: 0.33 seconds, 49.17 examples/second between steps 101 and 102
I0425 19:25:15.652173 140656272164672 keras_utils.py:163] TimeHistory: 0.65 seconds, 24.64 examples/second between steps 102 and 103
I0425 19:25:16.372048 140656272164672 keras_utils.py:163] TimeHistory: 0.72 seconds, 22.24 examples/second between steps 103 and 104
I0425 19:25:16.856004 140656272164672 keras_utils.py:163] TimeHistory: 0.48 seconds, 33.08 examples/second between steps 104 and 105
I0425 19:25:17.395242 140656272164672 keras_utils.py:163] TimeHistory: 0.54 seconds, 29.69 examples/second between steps 105 and 106
I0425 19:25:17.953760 140656272164672 keras_utils.py:163] TimeHistory: 0.56 seconds, 28.67 examples/second between steps 106 and 107
I0425 19:25:18.574476 140656272164672 keras_utils.py:163] TimeHistory: 0.62 seconds, 25.79 examples/second between steps 107 and 108
I0425 19:25:19.334200 140656272164672 keras_utils.py:163] TimeHistory: 0.76 seconds, 21.07 examples/second between steps 108 and 109
I0425 19:25:19.692700 140656272164672 keras_utils.py:163] TimeHistory: 0.36 seconds, 44.67 examples/second between steps 109 and 110
I0425 19:25:20.155367 140656272164672 keras_utils.py:163] TimeHistory: 0.46 seconds, 34.62 examples/second between steps 110 and 111
I0425 19:25:20.966368 140656272164672 keras_utils.py:163] TimeHistory: 0.81 seconds, 19.74 examples/second between steps 111 and 112
I0425 19:25:21.402930 140656272164672 keras_utils.py:163] TimeHistory: 0.44 seconds, 36.68 examples/second between steps 112 and 113
I0425 19:25:22.051879 140656272164672 keras_utils.py:163] TimeHistory: 0.65 seconds, 24.67 examples/second between steps 113 and 114
I0425 19:25:22.915894 140656272164672 keras_utils.py:163] TimeHistory: 0.86 seconds, 18.52 examples/second between steps 114 and 115
I0425 19:25:23.628026 140656272164672 keras_utils.py:163] TimeHistory: 0.71 seconds, 22.48 examples/second between steps 115 and 116
I0425 19:25:24.071111 140656272164672 keras_utils.py:163] TimeHistory: 0.44 seconds, 36.14 examples/second between steps 116 and 117
I0425 19:25:24.635071 140656272164672 keras_utils.py:163] TimeHistory: 0.56 seconds, 28.39 examples/second between steps 117 and 118
I0425 19:25:25.118746 140656272164672 keras_utils.py:163] TimeHistory: 0.48 seconds, 33.10 examples/second between steps 118 and 119
I0425 19:25:25.659965 140656272164672 keras_utils.py:163] TimeHistory: 0.54 seconds, 29.58 examples/second between steps 119 and 120
I0425 19:25:25.660708 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 24
I0425 19:25:25.660906 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 24
INFO:tensorflow:Running non-virtual train step
I0425 19:25:25.669641 140631548602112 training.py:940] Running non-virtual train step
I0425 19:25:35.402821 140656272164672 keras_utils.py:163] TimeHistory: 9.74 seconds, 2.46 examples/second between steps 120 and 121
I0425 19:25:36.259422 140656272164672 keras_utils.py:163] TimeHistory: 0.86 seconds, 28.03 examples/second between steps 121 and 122
I0425 19:25:37.310410 140656272164672 keras_utils.py:163] TimeHistory: 1.05 seconds, 22.84 examples/second between steps 122 and 123
I0425 19:25:37.755746 140656272164672 keras_utils.py:163] TimeHistory: 0.45 seconds, 53.93 examples/second between steps 123 and 124
I0425 19:25:38.916984 140656272164672 keras_utils.py:163] TimeHistory: 1.16 seconds, 20.67 examples/second between steps 124 and 125
I0425 19:25:39.887721 140656272164672 keras_utils.py:163] TimeHistory: 0.97 seconds, 24.73 examples/second between steps 125 and 126
I0425 19:25:40.424371 140656272164672 keras_utils.py:163] TimeHistory: 0.54 seconds, 44.75 examples/second between steps 126 and 127
I0425 19:25:41.327869 140656272164672 keras_utils.py:163] TimeHistory: 0.90 seconds, 26.57 examples/second between steps 127 and 128
I0425 19:25:42.076277 140656272164672 keras_utils.py:163] TimeHistory: 0.75 seconds, 32.09 examples/second between steps 128 and 129
I0425 19:25:42.882398 140656272164672 keras_utils.py:163] TimeHistory: 0.81 seconds, 29.78 examples/second between steps 129 and 130
I0425 19:25:43.505415 140656272164672 keras_utils.py:163] TimeHistory: 0.62 seconds, 38.54 examples/second between steps 130 and 131
I0425 19:25:44.164235 140656272164672 keras_utils.py:163] TimeHistory: 0.66 seconds, 36.45 examples/second between steps 131 and 132
I0425 19:25:44.721635 140656272164672 keras_utils.py:163] TimeHistory: 0.56 seconds, 43.09 examples/second between steps 132 and 133
I0425 19:25:45.788153 140656272164672 keras_utils.py:163] TimeHistory: 1.07 seconds, 22.51 examples/second between steps 133 and 134
I0425 19:25:47.012776 140656272164672 keras_utils.py:163] TimeHistory: 1.22 seconds, 19.60 examples/second between steps 134 and 135
I0425 19:25:47.842428 140656272164672 keras_utils.py:163] TimeHistory: 0.83 seconds, 28.94 examples/second between steps 135 and 136
I0425 19:25:48.448463 140656272164672 keras_utils.py:163] TimeHistory: 0.61 seconds, 39.62 examples/second between steps 136 and 137
I0425 19:25:49.417254 140656272164672 keras_utils.py:163] TimeHistory: 0.97 seconds, 24.78 examples/second between steps 137 and 138
I0425 19:25:50.586610 140656272164672 keras_utils.py:163] TimeHistory: 1.17 seconds, 20.53 examples/second between steps 138 and 139
I0425 19:25:51.504760 140656272164672 keras_utils.py:163] TimeHistory: 0.92 seconds, 26.15 examples/second between steps 139 and 140
I0425 19:25:51.505465 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 32
I0425 19:25:51.505719 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 32
INFO:tensorflow:Running non-virtual train step
I0425 19:25:51.514045 140631540209408 training.py:940] Running non-virtual train step
I0425 19:26:01.373827 140656272164672 keras_utils.py:163] TimeHistory: 9.87 seconds, 3.24 examples/second between steps 140 and 141
I0425 19:26:01.777961 140656272164672 keras_utils.py:163] TimeHistory: 0.40 seconds, 79.25 examples/second between steps 141 and 142
I0425 19:26:02.715970 140656272164672 keras_utils.py:163] TimeHistory: 0.94 seconds, 34.13 examples/second between steps 142 and 143
I0425 19:26:03.335280 140656272164672 keras_utils.py:163] TimeHistory: 0.62 seconds, 51.70 examples/second between steps 143 and 144
I0425 19:26:04.319699 140656272164672 keras_utils.py:163] TimeHistory: 0.98 seconds, 32.52 examples/second between steps 144 and 145
I0425 19:26:04.857753 140656272164672 keras_utils.py:163] TimeHistory: 0.54 seconds, 59.52 examples/second between steps 145 and 146
I0425 19:26:06.229660 140656272164672 keras_utils.py:163] TimeHistory: 1.37 seconds, 23.33 examples/second between steps 146 and 147
I0425 19:26:07.094665 140656272164672 keras_utils.py:163] TimeHistory: 0.86 seconds, 37.01 examples/second between steps 147 and 148
I0425 19:26:08.275100 140656272164672 keras_utils.py:163] TimeHistory: 1.18 seconds, 27.12 examples/second between steps 148 and 149
I0425 19:26:09.552178 140656272164672 keras_utils.py:163] TimeHistory: 1.28 seconds, 25.07 examples/second between steps 149 and 150
I0425 19:26:10.639386 140656272164672 keras_utils.py:163] TimeHistory: 1.09 seconds, 29.44 examples/second between steps 150 and 151
I0425 19:26:11.302312 140656272164672 keras_utils.py:163] TimeHistory: 0.66 seconds, 48.30 examples/second between steps 151 and 152
I0425 19:26:12.781304 140656272164672 keras_utils.py:163] TimeHistory: 1.48 seconds, 21.64 examples/second between steps 152 and 153
I0425 19:26:14.355970 140656272164672 keras_utils.py:163] TimeHistory: 1.57 seconds, 20.33 examples/second between steps 153 and 154
I0425 19:26:15.163093 140656272164672 keras_utils.py:163] TimeHistory: 0.81 seconds, 39.67 examples/second between steps 154 and 155
I0425 19:26:15.883393 140656272164672 keras_utils.py:163] TimeHistory: 0.72 seconds, 44.45 examples/second between steps 155 and 156
I0425 19:26:16.817750 140656272164672 keras_utils.py:163] TimeHistory: 0.93 seconds, 34.26 examples/second between steps 156 and 157
I0425 19:26:17.573881 140656272164672 keras_utils.py:163] TimeHistory: 0.76 seconds, 42.34 examples/second between steps 157 and 158
I0425 19:26:18.955689 140656272164672 keras_utils.py:163] TimeHistory: 1.38 seconds, 23.16 examples/second between steps 158 and 159
I0425 19:26:19.946910 140656272164672 keras_utils.py:163] TimeHistory: 0.99 seconds, 32.30 examples/second between steps 159 and 160
I0425 19:26:19.947731 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 48
I0425 19:26:19.947928 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 48
INFO:tensorflow:Running non-virtual train step
I0425 19:26:19.955760 140631053694720 training.py:940] Running non-virtual train step
I0425 19:26:30.904619 140656272164672 keras_utils.py:163] TimeHistory: 10.96 seconds, 4.38 examples/second between steps 160 and 161
I0425 19:26:32.115376 140656272164672 keras_utils.py:163] TimeHistory: 1.21 seconds, 39.66 examples/second between steps 161 and 162
I0425 19:26:33.896352 140656272164672 keras_utils.py:163] TimeHistory: 1.78 seconds, 26.96 examples/second between steps 162 and 163
I0425 19:26:35.449800 140656272164672 keras_utils.py:163] TimeHistory: 1.55 seconds, 30.91 examples/second between steps 163 and 164
I0425 19:26:37.600295 140656272164672 keras_utils.py:163] TimeHistory: 2.15 seconds, 22.32 examples/second between steps 164 and 165
I0425 19:26:38.445744 140656272164672 keras_utils.py:163] TimeHistory: 0.85 seconds, 56.80 examples/second between steps 165 and 166
I0425 19:26:39.244189 140656272164672 keras_utils.py:163] TimeHistory: 0.80 seconds, 60.14 examples/second between steps 166 and 167
I0425 19:26:40.592464 140656272164672 keras_utils.py:163] TimeHistory: 1.35 seconds, 35.61 examples/second between steps 167 and 168
I0425 19:26:42.050850 140656272164672 keras_utils.py:163] TimeHistory: 1.46 seconds, 32.92 examples/second between steps 168 and 169
I0425 19:26:43.705534 140656272164672 keras_utils.py:163] TimeHistory: 1.65 seconds, 29.01 examples/second between steps 169 and 170
I0425 19:26:45.677871 140656272164672 keras_utils.py:163] TimeHistory: 1.97 seconds, 24.34 examples/second between steps 170 and 171
I0425 19:26:46.823951 140656272164672 keras_utils.py:163] TimeHistory: 1.15 seconds, 41.90 examples/second between steps 171 and 172
I0425 19:26:47.750665 140656272164672 keras_utils.py:163] TimeHistory: 0.93 seconds, 51.82 examples/second between steps 172 and 173
I0425 19:26:49.522480 140656272164672 keras_utils.py:163] TimeHistory: 1.77 seconds, 27.10 examples/second between steps 173 and 174
I0425 19:26:50.733919 140656272164672 keras_utils.py:163] TimeHistory: 1.21 seconds, 39.63 examples/second between steps 174 and 175
I0425 19:26:51.805908 140656272164672 keras_utils.py:163] TimeHistory: 1.07 seconds, 44.79 examples/second between steps 175 and 176
I0425 19:26:52.786107 140656272164672 keras_utils.py:163] TimeHistory: 0.98 seconds, 48.99 examples/second between steps 176 and 177
I0425 19:26:54.340102 140656272164672 keras_utils.py:163] TimeHistory: 1.55 seconds, 30.90 examples/second between steps 177 and 178
I0425 19:26:56.597925 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 21.26 examples/second between steps 178 and 179
I0425 19:26:58.753511 140656272164672 keras_utils.py:163] TimeHistory: 2.16 seconds, 22.27 examples/second between steps 179 and 180
I0425 19:26:58.754155 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 64
I0425 19:26:58.754462 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 64
INFO:tensorflow:Running non-virtual train step
I0425 19:26:58.762762 140631045302016 training.py:940] Running non-virtual train step
I0425 19:27:10.119470 140656272164672 keras_utils.py:163] TimeHistory: 11.37 seconds, 5.63 examples/second between steps 180 and 181
I0425 19:27:10.969113 140656272164672 keras_utils.py:163] TimeHistory: 0.85 seconds, 75.36 examples/second between steps 181 and 182
I0425 19:27:12.677789 140656272164672 keras_utils.py:163] TimeHistory: 1.71 seconds, 37.46 examples/second between steps 182 and 183
I0425 19:27:14.918286 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 28.57 examples/second between steps 183 and 184
I0425 19:27:16.735007 140656272164672 keras_utils.py:163] TimeHistory: 1.82 seconds, 35.24 examples/second between steps 184 and 185
I0425 19:27:18.996204 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 28.31 examples/second between steps 185 and 186
I0425 19:27:20.984061 140656272164672 keras_utils.py:163] TimeHistory: 1.99 seconds, 32.20 examples/second between steps 186 and 187
I0425 19:27:21.918211 140656272164672 keras_utils.py:163] TimeHistory: 0.93 seconds, 68.54 examples/second between steps 187 and 188
I0425 19:27:23.485477 140656272164672 keras_utils.py:163] TimeHistory: 1.57 seconds, 40.85 examples/second between steps 188 and 189
I0425 19:27:24.860262 140656272164672 keras_utils.py:163] TimeHistory: 1.37 seconds, 46.57 examples/second between steps 189 and 190
I0425 19:27:27.037163 140656272164672 keras_utils.py:163] TimeHistory: 2.18 seconds, 29.40 examples/second between steps 190 and 191
I0425 19:27:29.280535 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 28.53 examples/second between steps 191 and 192
I0425 19:27:31.548908 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 28.22 examples/second between steps 192 and 193
I0425 19:27:33.004220 140656272164672 keras_utils.py:163] TimeHistory: 1.45 seconds, 43.99 examples/second between steps 193 and 194
I0425 19:27:35.249832 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 28.50 examples/second between steps 194 and 195
I0425 19:27:36.356673 140656272164672 keras_utils.py:163] TimeHistory: 1.11 seconds, 57.84 examples/second between steps 195 and 196
I0425 19:27:38.170731 140656272164672 keras_utils.py:163] TimeHistory: 1.81 seconds, 35.29 examples/second between steps 196 and 197
I0425 19:27:39.378289 140656272164672 keras_utils.py:163] TimeHistory: 1.21 seconds, 53.02 examples/second between steps 197 and 198
I0425 19:27:40.654307 140656272164672 keras_utils.py:163] TimeHistory: 1.28 seconds, 50.17 examples/second between steps 198 and 199
I0425 19:27:41.311153 140656272164672 keras_utils.py:163] TimeHistory: 0.66 seconds, 97.50 examples/second between steps 199 and 200
I0425 19:27:41.311810 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 96
I0425 19:27:41.312027 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 96
INFO:tensorflow:Running non-virtual train step
I0425 19:27:41.320623 140631036909312 training.py:940] Running non-virtual train step
I0425 19:27:53.241573 140656272164672 keras_utils.py:163] TimeHistory: 11.93 seconds, 8.05 examples/second between steps 200 and 201
I0425 19:27:55.492448 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 42.66 examples/second between steps 201 and 202
I0425 19:27:57.701726 140656272164672 keras_utils.py:163] TimeHistory: 2.21 seconds, 43.46 examples/second between steps 202 and 203
I0425 19:27:59.953176 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 42.65 examples/second between steps 203 and 204
I0425 19:28:02.188138 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 42.96 examples/second between steps 204 and 205
I0425 19:28:04.416397 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 43.09 examples/second between steps 205 and 206
I0425 19:28:06.672154 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 42.57 examples/second between steps 206 and 207
I0425 19:28:08.923805 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 42.64 examples/second between steps 207 and 208
I0425 19:28:11.169232 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 42.76 examples/second between steps 208 and 209
I0425 19:28:12.327581 140656272164672 keras_utils.py:163] TimeHistory: 1.16 seconds, 82.90 examples/second between steps 209 and 210
I0425 19:28:13.599720 140656272164672 keras_utils.py:163] TimeHistory: 1.27 seconds, 75.49 examples/second between steps 210 and 211
I0425 19:28:15.852060 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 42.63 examples/second between steps 211 and 212
I0425 19:28:17.812996 140656272164672 keras_utils.py:163] TimeHistory: 1.96 seconds, 48.96 examples/second between steps 212 and 213
I0425 19:28:20.037926 140656272164672 keras_utils.py:163] TimeHistory: 2.22 seconds, 43.15 examples/second between steps 213 and 214
I0425 19:28:22.291752 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 42.60 examples/second between steps 214 and 215
I0425 19:28:24.537572 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 42.76 examples/second between steps 215 and 216
I0425 19:28:25.849803 140656272164672 keras_utils.py:163] TimeHistory: 1.31 seconds, 73.18 examples/second between steps 216 and 217
I0425 19:28:28.116631 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 42.36 examples/second between steps 217 and 218
I0425 19:28:30.364771 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 42.71 examples/second between steps 218 and 219
I0425 19:28:32.456525 140656272164672 keras_utils.py:163] TimeHistory: 2.09 seconds, 45.90 examples/second between steps 219 and 220
I0425 19:28:32.457267 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 128
I0425 19:28:32.457490 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 128
INFO:tensorflow:Running non-virtual train step
I0425 19:28:32.465472 140631028516608 training.py:940] Running non-virtual train step
I0425 19:28:43.931324 140656272164672 keras_utils.py:163] TimeHistory: 11.47 seconds, 11.16 examples/second between steps 220 and 221
I0425 19:28:46.181977 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 56.88 examples/second between steps 221 and 222
I0425 19:28:48.421758 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 57.16 examples/second between steps 222 and 223
I0425 19:28:50.668636 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 56.98 examples/second between steps 223 and 224
I0425 19:28:52.709115 140656272164672 keras_utils.py:163] TimeHistory: 2.04 seconds, 62.75 examples/second between steps 224 and 225
I0425 19:28:54.975589 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 56.49 examples/second between steps 225 and 226
I0425 19:28:57.172446 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 58.28 examples/second between steps 226 and 227
I0425 19:28:59.396530 140656272164672 keras_utils.py:163] TimeHistory: 2.22 seconds, 57.56 examples/second between steps 227 and 228
I0425 19:29:01.642843 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 56.99 examples/second between steps 228 and 229
I0425 19:29:03.882459 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 57.16 examples/second between steps 229 and 230
I0425 19:29:05.711831 140656272164672 keras_utils.py:163] TimeHistory: 1.83 seconds, 69.98 examples/second between steps 230 and 231
I0425 19:29:07.084397 140656272164672 keras_utils.py:163] TimeHistory: 1.37 seconds, 93.28 examples/second between steps 231 and 232
I0425 19:29:09.335502 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 56.87 examples/second between steps 232 and 233
I0425 19:29:11.590948 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 56.76 examples/second between steps 233 and 234
I0425 19:29:13.849511 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 56.68 examples/second between steps 234 and 235
I0425 19:29:16.118930 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 56.41 examples/second between steps 235 and 236
I0425 19:29:18.311806 140656272164672 keras_utils.py:163] TimeHistory: 2.19 seconds, 58.38 examples/second between steps 236 and 237
I0425 19:29:20.565261 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 56.81 examples/second between steps 237 and 238
I0425 19:29:22.823178 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 56.70 examples/second between steps 238 and 239
I0425 19:29:25.050049 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 57.49 examples/second between steps 239 and 240
I0425 19:29:25.050765 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 192
I0425 19:29:25.050981 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 192
INFO:tensorflow:Running non-virtual train step
I0425 19:29:25.059281 140631020123904 training.py:940] Running non-virtual train step
I0425 19:29:36.504485 140656272164672 keras_utils.py:163] TimeHistory: 11.45 seconds, 16.76 examples/second between steps 240 and 241
I0425 19:29:38.750027 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 85.52 examples/second between steps 241 and 242
I0425 19:29:41.011909 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 84.90 examples/second between steps 242 and 243
I0425 19:29:43.263366 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 85.29 examples/second between steps 243 and 244
I0425 19:29:45.457984 140656272164672 keras_utils.py:163] TimeHistory: 2.19 seconds, 87.50 examples/second between steps 244 and 245
I0425 19:29:47.683653 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 86.28 examples/second between steps 245 and 246
I0425 19:29:49.931293 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 85.44 examples/second between steps 246 and 247
I0425 19:29:52.172574 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 85.68 examples/second between steps 247 and 248
I0425 19:29:54.387750 140656272164672 keras_utils.py:163] TimeHistory: 2.21 seconds, 86.69 examples/second between steps 248 and 249
I0425 19:29:56.651660 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 84.82 examples/second between steps 249 and 250
I0425 19:29:58.901983 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 85.33 examples/second between steps 250 and 251
I0425 19:30:01.149334 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 85.45 examples/second between steps 251 and 252
I0425 19:30:03.354249 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 87.09 examples/second between steps 252 and 253
I0425 19:30:05.613050 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 85.02 examples/second between steps 253 and 254
I0425 19:30:07.821103 140656272164672 keras_utils.py:163] TimeHistory: 2.21 seconds, 86.97 examples/second between steps 254 and 255
I0425 19:30:10.043949 140656272164672 keras_utils.py:163] TimeHistory: 2.22 seconds, 86.39 examples/second between steps 255 and 256
I0425 19:30:12.301739 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 85.05 examples/second between steps 256 and 257
I0425 19:30:14.500385 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 87.34 examples/second between steps 257 and 258
I0425 19:30:16.766362 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 84.75 examples/second between steps 258 and 259
I0425 19:30:19.023584 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 85.08 examples/second between steps 259 and 260
I0425 19:30:19.024303 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 256
I0425 19:30:19.024518 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 256
INFO:tensorflow:Running non-virtual train step
I0425 19:30:19.032902 140631011731200 training.py:940] Running non-virtual train step
I0425 19:30:30.879211 140656272164672 keras_utils.py:163] TimeHistory: 11.85 seconds, 21.59 examples/second between steps 260 and 261
I0425 19:30:33.128540 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 113.83 examples/second between steps 261 and 262
I0425 19:30:35.367025 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 114.39 examples/second between steps 262 and 263
I0425 19:30:37.587437 140656272164672 keras_utils.py:163] TimeHistory: 2.22 seconds, 115.32 examples/second between steps 263 and 264
I0425 19:30:39.838146 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 113.76 examples/second between steps 264 and 265
I0425 19:30:42.063058 140656272164672 keras_utils.py:163] TimeHistory: 2.22 seconds, 115.08 examples/second between steps 265 and 266
I0425 19:30:44.311291 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 113.89 examples/second between steps 266 and 267
I0425 19:30:46.571551 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 113.28 examples/second between steps 267 and 268
I0425 19:30:48.816763 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 114.04 examples/second between steps 268 and 269
I0425 19:30:51.062968 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 113.99 examples/second between steps 269 and 270
I0425 19:30:53.267540 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 116.15 examples/second between steps 270 and 271
I0425 19:30:55.516288 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 113.86 examples/second between steps 271 and 272
I0425 19:30:57.749327 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 114.66 examples/second between steps 272 and 273
I0425 19:30:59.975047 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 115.04 examples/second between steps 273 and 274
I0425 19:31:02.256319 140656272164672 keras_utils.py:163] TimeHistory: 2.28 seconds, 112.24 examples/second between steps 274 and 275
I0425 19:31:04.508106 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 113.71 examples/second between steps 275 and 276
I0425 19:31:06.710448 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 116.26 examples/second between steps 276 and 277
I0425 19:31:08.909200 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 116.45 examples/second between steps 277 and 278
I0425 19:31:11.169243 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 113.29 examples/second between steps 278 and 279
I0425 19:31:13.427477 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 113.38 examples/second between steps 279 and 280
I0425 19:31:13.428111 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 384
I0425 19:31:13.428318 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 384
INFO:tensorflow:Running non-virtual train step
I0425 19:31:13.436474 140630651041536 training.py:940] Running non-virtual train step
I0425 19:31:24.940029 140656272164672 keras_utils.py:163] TimeHistory: 11.51 seconds, 33.36 examples/second between steps 280 and 281
I0425 19:31:27.178496 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 171.58 examples/second between steps 281 and 282
I0425 19:31:29.426659 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 170.83 examples/second between steps 282 and 283
I0425 19:31:31.672418 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 171.02 examples/second between steps 283 and 284
I0425 19:31:33.923027 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 170.65 examples/second between steps 284 and 285
I0425 19:31:36.123150 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 174.57 examples/second between steps 285 and 286
I0425 19:31:38.319790 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 174.84 examples/second between steps 286 and 287
I0425 19:31:40.534644 140656272164672 keras_utils.py:163] TimeHistory: 2.21 seconds, 173.40 examples/second between steps 287 and 288
I0425 19:31:42.769603 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 171.84 examples/second between steps 288 and 289
I0425 19:31:45.017527 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 170.86 examples/second between steps 289 and 290
I0425 19:31:47.245401 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 172.39 examples/second between steps 290 and 291
I0425 19:31:49.494580 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 170.76 examples/second between steps 291 and 292
I0425 19:31:51.769252 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 168.84 examples/second between steps 292 and 293
I0425 19:31:53.978213 140656272164672 keras_utils.py:163] TimeHistory: 2.21 seconds, 173.87 examples/second between steps 293 and 294
I0425 19:31:56.220232 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 171.30 examples/second between steps 294 and 295
I0425 19:31:58.486661 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 169.46 examples/second between steps 295 and 296
I0425 19:32:00.739001 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 170.52 examples/second between steps 296 and 297
I0425 19:32:02.942501 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 174.29 examples/second between steps 297 and 298
I0425 19:32:05.203780 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 169.84 examples/second between steps 298 and 299
I0425 19:32:07.404565 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 174.51 examples/second between steps 299 and 300
I0425 19:32:07.405251 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 512
I0425 19:32:07.405466 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 512
INFO:tensorflow:Running non-virtual train step
I0425 19:32:07.413449 140630632949504 training.py:940] Running non-virtual train step
I0425 19:32:18.911033 140656272164672 keras_utils.py:163] TimeHistory: 11.51 seconds, 44.50 examples/second between steps 300 and 301
I0425 19:32:21.153076 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 228.41 examples/second between steps 301 and 302
I0425 19:32:23.393676 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 228.56 examples/second between steps 302 and 303
I0425 19:32:25.607381 140656272164672 keras_utils.py:163] TimeHistory: 2.21 seconds, 231.33 examples/second between steps 303 and 304
I0425 19:32:27.849718 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 228.37 examples/second between steps 304 and 305
I0425 19:32:30.098159 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 227.75 examples/second between steps 305 and 306
I0425 19:32:32.298522 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 232.72 examples/second between steps 306 and 307
I0425 19:32:34.571961 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 225.25 examples/second between steps 307 and 308
I0425 19:32:36.827521 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 227.05 examples/second between steps 308 and 309
I0425 19:32:39.081172 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 227.23 examples/second between steps 309 and 310
I0425 19:32:41.318639 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 228.87 examples/second between steps 310 and 311
I0425 19:32:43.583666 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 226.08 examples/second between steps 311 and 312
I0425 19:32:45.842638 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 226.69 examples/second between steps 312 and 313
I0425 19:32:48.046881 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 232.32 examples/second between steps 313 and 314
I0425 19:32:50.281822 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 229.13 examples/second between steps 314 and 315
I0425 19:32:52.511566 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 229.68 examples/second between steps 315 and 316
I0425 19:32:54.753277 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 228.45 examples/second between steps 316 and 317
I0425 19:32:56.947991 140656272164672 keras_utils.py:163] TimeHistory: 2.19 seconds, 233.33 examples/second between steps 317 and 318
I0425 19:32:59.085594 140656272164672 keras_utils.py:163] TimeHistory: 2.14 seconds, 239.57 examples/second between steps 318 and 319
I0425 19:33:01.286856 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 232.64 examples/second between steps 319 and 320
I0425 19:33:01.287560 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 768
I0425 19:33:01.287801 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 768
INFO:tensorflow:Running non-virtual train step
I0425 19:33:01.295908 140630608041728 training.py:940] Running non-virtual train step
I0425 19:33:12.787705 140656272164672 keras_utils.py:163] TimeHistory: 11.50 seconds, 66.78 examples/second between steps 320 and 321
I0425 19:33:15.029566 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 342.63 examples/second between steps 321 and 322
I0425 19:33:17.286425 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 340.34 examples/second between steps 322 and 323
I0425 19:33:19.551142 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 339.17 examples/second between steps 323 and 324
I0425 19:33:21.802893 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 341.13 examples/second between steps 324 and 325
I0425 19:33:24.052921 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 341.39 examples/second between steps 325 and 326
I0425 19:33:26.310376 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 340.27 examples/second between steps 326 and 327
I0425 19:33:28.571460 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 339.72 examples/second between steps 327 and 328
I0425 19:33:30.764456 140656272164672 keras_utils.py:163] TimeHistory: 2.19 seconds, 350.26 examples/second between steps 328 and 329
I0425 19:33:33.012230 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 341.72 examples/second between steps 329 and 330
I0425 19:33:35.242590 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 344.39 examples/second between steps 330 and 331
I0425 19:33:37.469673 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 344.90 examples/second between steps 331 and 332
I0425 19:33:39.722450 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 340.97 examples/second between steps 332 and 333
I0425 19:33:41.947286 140656272164672 keras_utils.py:163] TimeHistory: 2.22 seconds, 345.28 examples/second between steps 333 and 334
I0425 19:33:44.204374 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 340.32 examples/second between steps 334 and 335
I0425 19:33:46.402692 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 349.41 examples/second between steps 335 and 336
I0425 19:33:48.669092 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 338.92 examples/second between steps 336 and 337
I0425 19:33:50.926155 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 340.31 examples/second between steps 337 and 338
I0425 19:33:53.200121 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 337.79 examples/second between steps 338 and 339
I0425 19:33:55.459344 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 340.00 examples/second between steps 339 and 340
I0425 19:33:55.460184 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 1024
I0425 19:33:55.460389 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 1024
INFO:tensorflow:Running non-virtual train step
I0425 19:33:55.468453 140630314710784 training.py:940] Running non-virtual train step
I0425 19:34:07.411821 140656272164672 keras_utils.py:163] TimeHistory: 11.95 seconds, 85.68 examples/second between steps 340 and 341
I0425 19:34:09.663026 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 454.95 examples/second between steps 341 and 342
I0425 19:34:11.903301 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 457.17 examples/second between steps 342 and 343
I0425 19:34:14.096729 140656272164672 keras_utils.py:163] TimeHistory: 2.19 seconds, 466.93 examples/second between steps 343 and 344
I0425 19:34:16.344772 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 455.59 examples/second between steps 344 and 345
I0425 19:34:18.587151 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 456.73 examples/second between steps 345 and 346
I0425 19:34:20.827656 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 457.11 examples/second between steps 346 and 347
I0425 19:34:23.058128 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 459.18 examples/second between steps 347 and 348
I0425 19:34:25.260220 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 465.09 examples/second between steps 348 and 349
I0425 19:34:27.461812 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 465.20 examples/second between steps 349 and 350
I0425 19:34:29.741406 140656272164672 keras_utils.py:163] TimeHistory: 2.28 seconds, 449.27 examples/second between steps 350 and 351
I0425 19:34:31.996017 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 454.26 examples/second between steps 351 and 352
I0425 19:34:34.235694 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 457.28 examples/second between steps 352 and 353
I0425 19:34:36.502508 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 451.82 examples/second between steps 353 and 354
I0425 19:34:38.741400 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 457.45 examples/second between steps 354 and 355
I0425 19:34:41.012418 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 450.99 examples/second between steps 355 and 356
I0425 19:34:43.210435 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 465.96 examples/second between steps 356 and 357
I0425 19:34:45.476645 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 451.94 examples/second between steps 357 and 358
I0425 19:34:47.730114 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 454.50 examples/second between steps 358 and 359
I0425 19:34:49.985354 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 454.13 examples/second between steps 359 and 360
I0425 19:34:49.986037 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 1536
I0425 19:34:49.986252 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 1536
INFO:tensorflow:Running non-virtual train step
I0425 19:34:49.995059 140630289803008 training.py:940] Running non-virtual train step
I0425 19:35:01.357430 140656272164672 keras_utils.py:163] TimeHistory: 11.37 seconds, 135.08 examples/second between steps 360 and 361
I0425 19:35:03.546995 140656272164672 keras_utils.py:163] TimeHistory: 2.19 seconds, 701.63 examples/second between steps 361 and 362
I0425 19:35:05.734308 140656272164672 keras_utils.py:163] TimeHistory: 2.19 seconds, 702.34 examples/second between steps 362 and 363
I0425 19:35:07.994473 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 679.72 examples/second between steps 363 and 364
I0425 19:35:10.212668 140656272164672 keras_utils.py:163] TimeHistory: 2.22 seconds, 692.62 examples/second between steps 364 and 365
I0425 19:35:12.459732 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 683.66 examples/second between steps 365 and 366
I0425 19:35:14.729283 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 676.89 examples/second between steps 366 and 367
I0425 19:35:16.988326 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 680.03 examples/second between steps 367 and 368
I0425 19:35:19.237332 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 683.09 examples/second between steps 368 and 369
I0425 19:35:21.452926 140656272164672 keras_utils.py:163] TimeHistory: 2.22 seconds, 693.42 examples/second between steps 369 and 370
I0425 19:35:23.688103 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 687.31 examples/second between steps 370 and 371
I0425 19:35:25.930888 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 684.98 examples/second between steps 371 and 372
I0425 19:35:28.179369 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 683.23 examples/second between steps 372 and 373
I0425 19:35:30.372203 140656272164672 keras_utils.py:163] TimeHistory: 2.19 seconds, 700.59 examples/second between steps 373 and 374
I0425 19:35:32.556815 140656272164672 keras_utils.py:163] TimeHistory: 2.18 seconds, 703.23 examples/second between steps 374 and 375
I0425 19:35:34.789587 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 688.07 examples/second between steps 375 and 376
I0425 19:35:37.051341 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 679.23 examples/second between steps 376 and 377
I0425 19:35:39.272602 140656272164672 keras_utils.py:163] TimeHistory: 2.22 seconds, 691.62 examples/second between steps 377 and 378
I0425 19:35:41.485232 140656272164672 keras_utils.py:163] TimeHistory: 2.21 seconds, 694.33 examples/second between steps 378 and 379
I0425 19:35:43.755028 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 676.81 examples/second between steps 379 and 380
I0425 19:35:43.755840 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 2048
I0425 19:35:43.756038 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 2048
INFO:tensorflow:Running non-virtual train step
I0425 19:35:43.764232 140630264895232 training.py:940] Running non-virtual train step
I0425 19:35:55.328236 140656272164672 keras_utils.py:163] TimeHistory: 11.57 seconds, 176.98 examples/second between steps 380 and 381
I0425 19:35:57.556742 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 919.17 examples/second between steps 381 and 382
I0425 19:35:59.833334 140656272164672 keras_utils.py:163] TimeHistory: 2.28 seconds, 899.73 examples/second between steps 382 and 383
I0425 19:36:02.088804 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 908.17 examples/second between steps 383 and 384
I0425 19:36:04.337281 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 911.02 examples/second between steps 384 and 385
I0425 19:36:06.580727 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 913.06 examples/second between steps 385 and 386
I0425 19:36:08.847289 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 903.72 examples/second between steps 386 and 387
I0425 19:36:11.045970 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 931.63 examples/second between steps 387 and 388
I0425 19:36:13.291083 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 912.37 examples/second between steps 388 and 389
I0425 19:36:15.543584 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 909.39 examples/second between steps 389 and 390
I0425 19:36:17.774472 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 918.18 examples/second between steps 390 and 391
I0425 19:36:19.998748 140656272164672 keras_utils.py:163] TimeHistory: 2.22 seconds, 920.90 examples/second between steps 391 and 392
I0425 19:36:22.241026 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 913.50 examples/second between steps 392 and 393
I0425 19:36:24.481907 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 914.07 examples/second between steps 393 and 394
I0425 19:36:26.724309 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 913.45 examples/second between steps 394 and 395
I0425 19:36:28.905462 140656272164672 keras_utils.py:163] TimeHistory: 2.18 seconds, 939.13 examples/second between steps 395 and 396
I0425 19:36:31.171195 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 904.08 examples/second between steps 396 and 397
I0425 19:36:33.424650 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 909.02 examples/second between steps 397 and 398
I0425 19:36:35.655387 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 918.22 examples/second between steps 398 and 399
I0425 19:36:37.916712 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 905.84 examples/second between steps 399 and 400
I0425 19:36:37.917376 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 3072
I0425 19:36:37.917577 140656272164672 training.py:1298] Heterogeneous profiling: now profiling batch size 3072
INFO:tensorflow:Running non-virtual train step
I0425 19:36:37.925961 140630038411008 training.py:940] Running non-virtual train step
I0425 19:36:49.265616 140656272164672 keras_utils.py:163] TimeHistory: 11.35 seconds, 270.71 examples/second between steps 400 and 401
I0425 19:36:51.512952 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 1367.17 examples/second between steps 401 and 402
I0425 19:36:53.748672 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 1374.29 examples/second between steps 402 and 403
I0425 19:36:55.964108 140656272164672 keras_utils.py:163] TimeHistory: 2.22 seconds, 1386.84 examples/second between steps 403 and 404
I0425 19:36:58.200911 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 1373.61 examples/second between steps 404 and 405
I0425 19:37:00.442824 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 1370.49 examples/second between steps 405 and 406
I0425 19:37:02.691696 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 1366.26 examples/second between steps 406 and 407
I0425 19:37:04.889083 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 1398.31 examples/second between steps 407 and 408
I0425 19:37:07.087593 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 1397.53 examples/second between steps 408 and 409
I0425 19:37:09.337246 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 1365.75 examples/second between steps 409 and 410
I0425 19:37:11.594085 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 1361.45 examples/second between steps 410 and 411
I0425 19:37:13.861828 140656272164672 keras_utils.py:163] TimeHistory: 2.27 seconds, 1354.91 examples/second between steps 411 and 412
I0425 19:37:16.126794 140656272164672 keras_utils.py:163] TimeHistory: 2.26 seconds, 1356.56 examples/second between steps 412 and 413
I0425 19:37:18.324120 140656272164672 keras_utils.py:163] TimeHistory: 2.20 seconds, 1398.29 examples/second between steps 413 and 414
I0425 19:37:20.555651 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 1376.91 examples/second between steps 414 and 415
I0425 19:37:22.782399 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 1379.79 examples/second between steps 415 and 416
I0425 19:37:25.026913 140656272164672 keras_utils.py:163] TimeHistory: 2.24 seconds, 1368.89 examples/second between steps 416 and 417
I0425 19:37:27.281385 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 1362.85 examples/second between steps 417 and 418
I0425 19:37:29.527546 140656272164672 keras_utils.py:163] TimeHistory: 2.25 seconds, 1367.89 examples/second between steps 418 and 419
I0425 19:37:31.762094 140656272164672 keras_utils.py:163] TimeHistory: 2.23 seconds, 1375.05 examples/second between steps 419 and 420
I0425 19:37:31.762837 140656272164672 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_25_21_1619378609039/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling complete
I0425 19:37:31.763061 140656272164672 training.py:1295] Heterogeneous profiling complete
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
inputs (InputLayer)             [(None, None)]       0                                            
__________________________________________________________________________________________________
targets (InputLayer)            [(None, None)]       0                                            
__________________________________________________________________________________________________
transformer_v2 (Transformer)    (None, None, 33945)  211047424   inputs[0][0]                     
                                                                 targets[0][0]                    
__________________________________________________________________________________________________
logits (Lambda)                 (None, None, 33945)  0           transformer_v2[0][0]             
__________________________________________________________________________________________________
tf.compat.v1.shape (TFOpLambda) (3,)                 0           logits[0][0]                     
__________________________________________________________________________________________________
tf.compat.v1.shape_1 (TFOpLambd (2,)                 0           targets[0][0]                    
__________________________________________________________________________________________________
tf.__operators__.getitem (Slici ()                   0           tf.compat.v1.shape[0][0]         
__________________________________________________________________________________________________
tf.__operators__.getitem_1 (Sli ()                   0           tf.compat.v1.shape_1[0][0]       
__________________________________________________________________________________________________
tf.math.maximum (TFOpLambda)    ()                   0           tf.__operators__.getitem[0][0]   
                                                                 tf.__operators__.getitem_1[0][0] 
__________________________________________________________________________________________________
tf.math.subtract_1 (TFOpLambda) ()                   0           tf.math.maximum[0][0]            
                                                                 tf.__operators__.getitem_1[0][0] 
__________________________________________________________________________________________________
tf.compat.v1.pad_1 (TFOpLambda) (None, None)         0           targets[0][0]                    
                                                                 tf.math.subtract_1[0][0]         
__________________________________________________________________________________________________
tf.cast (TFOpLambda)            (None, None)         0           tf.compat.v1.pad_1[0][0]         
__________________________________________________________________________________________________
tf.math.subtract (TFOpLambda)   ()                   0           tf.math.maximum[0][0]            
                                                                 tf.__operators__.getitem[0][0]   
__________________________________________________________________________________________________
tf.one_hot (TFOpLambda)         (None, None, 33945)  0           tf.cast[0][0]                    
__________________________________________________________________________________________________
tf.compat.v1.pad (TFOpLambda)   (None, None, 33945)  0           logits[0][0]                     
                                                                 tf.math.subtract[0][0]           
__________________________________________________________________________________________________
tf.compat.v1.nn.softmax_cross_e (None, None)         0           tf.one_hot[0][0]                 
                                                                 tf.compat.v1.pad[0][0]           
__________________________________________________________________________________________________
tf.math.not_equal (TFOpLambda)  (None, None)         0           tf.compat.v1.pad_1[0][0]         
__________________________________________________________________________________________________
tf.math.subtract_2 (TFOpLambda) (None, None)         0           tf.compat.v1.nn.softmax_cross_ent
__________________________________________________________________________________________________
tf.cast_1 (TFOpLambda)          (None, None)         0           tf.math.not_equal[0][0]          
__________________________________________________________________________________________________
tf.math.multiply (TFOpLambda)   (None, None)         0           tf.math.subtract_2[0][0]         
                                                                 tf.cast_1[0][0]                  
__________________________________________________________________________________________________
tf.math.reduce_sum (TFOpLambda) ()                   0           tf.math.multiply[0][0]           
__________________________________________________________________________________________________
tf.math.reduce_sum_1 (TFOpLambd ()                   0           tf.cast_1[0][0]                  
__________________________________________________________________________________________________
tf.math.truediv (TFOpLambda)    ()                   0           tf.math.reduce_sum[0][0]         
                                                                 tf.math.reduce_sum_1[0][0]       
__________________________________________________________________________________________________
add_loss (AddLoss)              ()                   0           tf.math.truediv[0][0]            
==================================================================================================
Total params: 211,047,424
Trainable params: 211,047,424
Non-trainable params: 0
__________________________________________________________________________________________________
100000/100000 - 832s - loss: 7.6727
I0425 19:37:31.763916 140656272164672 transformer_main.py:369] Train history: {'loss': [7.6727190017700195]}
I0425 19:37:31.764022 140656272164672 transformer_main.py:371] End train iteration at global step:100000
