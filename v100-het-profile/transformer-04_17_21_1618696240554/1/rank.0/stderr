My commit is 46f9d67f Simulator: Refactor to compute job allocations once (/root/dev/models/deploy)

==========================================================================
My environment variables:
--------------------------------------------------------------------------
CUDNN_VERSION=7.6.2.24-1+cuda10.1
PMIX_ID=2895183873.0
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:
LD_LIBRARY_PATH=/usr/local/lib:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
OMPI_FIRST_RANKS=0
MPI_HOSTS=f69df1f52c58
OMPI_MCA_orte_top_session_dir=/tmp/ompi.f69df1f52c58.0
LOG_MEMORY_ENABLED=false
PMIX_SYSTEM_TMPDIR=/tmp
OMPI_MCA_orte_num_nodes=1
OMPI_COMMAND=run_transformer.sh
MODEL=transformer
LANG=C.UTF-8
PARAM_SET=big
HFI_NO_BACKTRACE=1
HOSTNAME=f69df1f52c58
DECODE_BATCH_SIZE=32
OMPI_MCA_ess_base_vpid=0
OLDPWD=/root
OMPI_MCA_initial_wdir=/root/dev/models/deploy
VOCAB_FILE=/root/dev/dataset/transformer/vocab.ende.32768
ENVIRONMENT=docker
TF_DIR=/root/dev/tensorflow
STEPS_BETWEEN_EVALS=100000
DATA_DIR=/root/dev/dataset/transformer
HOST_FLAG=--host f69df1f52c58
OMPI_MCA_btl_tcp_if_exclude=lo,docker0,eth1
DTYPE=fp16
NUM_CHECKPOINTS_TO_KEEP=5
OMPI_COMM_WORLD_NODE_RANK=0
NVIDIA_VISIBLE_DEVICES=all
OMPI_MCA_orte_precondition_transports=4eda9615915f72ba-84d2c925beb26c5a
BASE_DIR=/root/dev
OMPI_MCA_orte_ess_node_rank=0
OMPI_MCA_shmem_RUNTIME_QUERY_hint=mmap
OMPI_COMM_WORLD_RANK=0
LOG_STEPS=1
PMIX_RANK=0
OMPI_FILE_LOCATION=/tmp/ompi.f69df1f52c58.0/pid.948/0/0
NCCL_VERSION=2.4.7-1+cuda10.1
OMPI_MCA_orte_local_daemon_uri=2895183872.0;tcp://10.0.1.2,172.18.0.3:53113
HOROVOD_GPU_OPERATIONS=NCCL
PWD=/root/dev/models/deploy
NUM_GPUS_PER_NODE=8
HOME=/root
ENABLE_XLA=true
PMIX_SERVER_TMPDIR=/tmp/ompi.f69df1f52c58.0/pid.948
RUN_SCRIPT=run_transformer.sh
PMIX_PTL_MODULE=tcp,usock
IPATH_NO_BACKTRACE=1
JOB_NAME=transformer-04_17_21_1618696240554
OMPI_MCA_rmaps_base_oversubscribe=1
OMPI_MCA_orte_launch=1
CODE_DIR=/root/dev/models/official/nlp/transformer
OMPI_MCA_orte_tmpdir_base=/tmp
LOG_DIR=/root/dev/logs
TIMESTAMP=04_17_21_1618696240597
MPI_HOST_FILE=/root/container_hosts/hosts.txt
BLEU_SOURCE=
NUM_VIRTUAL_NODES_PER_DEVICE=1
OMPI_APP_CTX_NUM_PROCS=1
OMPI_MCA_orte_output_filename=/root/dev/logs/transformer-04_17_21_1618696240554
LOG_FILE=/dev/stderr
MODELS_DIR=/root/dev/models
OMPI_MCA_orte_app_num=0
DISABLE_VIRTUAL_NODES=true
PMIX_MCA_mca_base_component_show_load_errors=1
NUM_NODES=1
MAX_LENGTH=64
OMPI_MCA_pml=ob1
PYTHON_COMMAND=/usr/bin/python3
IN_DOCKER_CONTAINER=true
NUM_EPOCHS=100000
PMIX_BFROP_BUFFER_TYPE=PMIX_BFROP_BUFFER_NON_DESC
MPI_HOME=/usr/local
TERM=xterm
CUDA_PKG_VERSION=10-1=10.1.243-1
CUDA_VERSION=10.1.243
SKIP_EVAL=true
PMIX_DSTORE_ESH_BASE_PATH=/tmp/ompi.f69df1f52c58.0/pid.948/pmix_dstor_ds12_948
OMPI_MCA_hwloc_base_binding_policy=none
BLEU_REF=
OMPI_MCA_rmaps_base_mapping_policy=node
PMIX_SERVER_URI3=2895183872.0;tcp4://127.0.0.1:51983
PMIX_SERVER_URI2=2895183872.0;tcp4://127.0.0.1:51983
NUM_STEPS=100000
OMPI_MCA_orte_hnp_uri=2895183872.0;tcp://10.0.1.2,172.18.0.3:53113
TRAIN_DIR=/root/dev/logs/transformer-04_17_21_1618696240554
OMPI_MCA_mpi_yield_when_idle=0
NVIDIA_DRIVER_CAPABILITIES=compute,utility
DEFAULT_NUM_GPUS_PER_NODE=8
ENABLE_CHECKPOINTS=false
DISTRIBUTION_STRATEGY=mirrored
OMPI_COMM_WORLD_LOCAL_SIZE=1
CUDA_VISIBLE_DEVICES=0
OMPI_COMM_WORLD_SIZE=1
SHLVL=3
PYTHONPATH=:/root/dev/models:/root/dev/models
OMPI_NUM_APP_CTX=1
NVIDIA_REQUIRE_CUDA=cuda>=10.1 brand=tesla,driver>=396,driver<397 brand=tesla,driver>=410,driver<411 brand=tesla,driver>=418,driver<419
OMPI_MCA_pmix=^s1,s2,cray,isolated
DEFAULT_DISTRIBUTION_STRATEGY=mirrored
PMIX_SERVER_URI21=2895183872.0;tcp4://127.0.0.1:51983
SAVED_CHECKPOINT_PATH=
PMIX_DSTORE_21_BASE_PATH=/tmp/ompi.f69df1f52c58.0/pid.948/pmix_dstor_ds21_948
ENABLE_MONITOR_MEMORY=false
ENABLE_HETEROGENEOUS_PROFILE=true
CUBLAS_VERSION=10.1.0.105-1
BATCH_SIZE=4096
PATH=/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
PMIX_SECURITY_MODE=native
OMPI_MCA_ess=^singleton
NCCL_DEBUG=INFO
PMIX_NAMESPACE=2895183873
OMPI_MCA_orte_ess_num_procs=1
NCCL_SOCKET_IFNAME=^lo,docker0,eth1
OMPI_MCA_ess_base_jobid=2895183873
OMPI_COMM_WORLD_LOCAL_RANK=0
OMPI_UNIVERSE_SIZE=1
OMPI_MCA_orte_jobfam_session_dir=/tmp/ompi.f69df1f52c58.0/pid.948
PMIX_GDS_MODULE=ds21,ds12,hash
ENABLE_ELASTICITY=false
NUM_GPUS=1
OMPI_MCA_btl=^openib
_=/usr/bin/printenv
==========================================================================

2021-04-17 21:50:40.811102: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
I0417 21:50:45.046439 139907979052864 virtual_helper.py:221] Setting TF_CONFIG to {"cluster": {"worker": ["f69df1f52c58:2222"]}, "task": {"type": "worker", "index": 0}}
INFO:tensorflow:Initializing local devices since in-graph multi-worker training with `MirroredStrategy` is not supported in eager mode. TF_CONFIG will be ignored when when initializing `MirroredStrategy`.
I0417 21:50:45.047032 139907979052864 mirrored_strategy.py:306] Initializing local devices since in-graph multi-worker training with `MirroredStrategy` is not supported in eager mode. TF_CONFIG will be ignored when when initializing `MirroredStrategy`.
2021-04-17 21:50:45.047282: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-17 21:50:45.047387: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-17 21:50:45.085724: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:50:45.086192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.75GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-17 21:50:45.086220: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-17 21:50:45.088208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-04-17 21:50:45.088282: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-04-17 21:50:45.090237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-17 21:50:45.090590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-17 21:50:45.092485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-17 21:50:45.093596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-04-17 21:50:45.097618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-04-17 21:50:45.097759: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:50:45.098150: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:50:45.098465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-17 21:50:45.098841: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-17 21:50:45.099532: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-17 21:50:45.099685: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:50:45.100031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.75GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-17 21:50:45.100053: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-17 21:50:45.100079: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-04-17 21:50:45.100097: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-04-17 21:50:45.100109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-17 21:50:45.100127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-17 21:50:45.100141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-17 21:50:45.100153: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-04-17 21:50:45.100169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-04-17 21:50:45.100240: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:50:45.100624: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:50:45.100946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-17 21:50:45.100980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-17 21:50:45.842183: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-17 21:50:45.842224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-17 21:50:45.842232: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-17 21:50:45.842471: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:50:45.842900: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:50:45.843263: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:50:45.843602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14677 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:04.0, compute capability: 7.0)
INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
I0417 21:50:45.846635 139907979052864 mirrored_strategy.py:350] Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
I0417 21:50:45.847717 139907979052864 transformer_main.py:180] Running transformer with num_gpus = 1
I0417 21:50:45.848250 139907979052864 transformer_main.py:184] For training, using distribution strategy: <tensorflow.python.distribute.mirrored_strategy.MirroredStrategy object at 0x7f3e4bed4ef0>
WARNING:tensorflow:From /root/dev/models/official/nlp/transformer/attention_layer.py:63: DenseEinsum.__init__ (from official.nlp.modeling.layers.dense_einsum) is deprecated and will be removed in a future version.
Instructions for updating:
DenseEinsum is deprecated. Please use tf.keras.experimental.EinsumDense layer instead.
W0417 21:50:47.343703 139907979052864 deprecation.py:339] From /root/dev/models/official/nlp/transformer/attention_layer.py:63: DenseEinsum.__init__ (from official.nlp.modeling.layers.dense_einsum) is deprecated and will be removed in a future version.
Instructions for updating:
DenseEinsum is deprecated. Please use tf.keras.experimental.EinsumDense layer instead.
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:50:49.995696 139907979052864 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:50:49.997603 139907979052864 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:50:50.000941 139907979052864 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:50:50.001749 139907979052864 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:50:50.464010 139907979052864 transformer_main.py:314] Start train iteration at global step:0
2021-04-17 21:50:50.499108: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-17 21:50:50.499650: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2000155000 Hz
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 1
I0417 21:50:50.562473 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 1
INFO:tensorflow:Running non-virtual train step
I0417 21:50:50.612294 139883519665920 training.py:940] Running non-virtual train step
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:50:54.531401 139907979052864 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:50:54.533232 139907979052864 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Running non-virtual train step
I0417 21:50:56.069271 139883519665920 training.py:940] Running non-virtual train step
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:50:59.795030 139907979052864 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:50:59.796863 139907979052864 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2021-04-17 21:51:04.366465: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
I0417 21:51:05.446215 139907979052864 keras_utils.py:163] TimeHistory: 14.88 seconds, 0.07 examples/second between steps 0 and 1
I0417 21:51:05.496135 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 20.15 examples/second between steps 1 and 2
I0417 21:51:05.546889 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 19.80 examples/second between steps 2 and 3
I0417 21:51:05.606901 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 16.74 examples/second between steps 3 and 4
I0417 21:51:05.665679 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 17.09 examples/second between steps 4 and 5
I0417 21:51:05.718804 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 18.94 examples/second between steps 5 and 6
I0417 21:51:05.767594 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 20.61 examples/second between steps 6 and 7
I0417 21:51:05.819051 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 19.54 examples/second between steps 7 and 8
I0417 21:51:05.867907 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 20.57 examples/second between steps 8 and 9
I0417 21:51:05.914490 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 21.59 examples/second between steps 9 and 10
I0417 21:51:05.962627 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 20.89 examples/second between steps 10 and 11
I0417 21:51:06.010344 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 21.07 examples/second between steps 11 and 12
I0417 21:51:06.056774 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 21.66 examples/second between steps 12 and 13
I0417 21:51:06.105358 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 20.69 examples/second between steps 13 and 14
I0417 21:51:06.151670 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 21.71 examples/second between steps 14 and 15
I0417 21:51:06.201313 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 20.24 examples/second between steps 15 and 16
I0417 21:51:06.253572 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 19.23 examples/second between steps 16 and 17
I0417 21:51:06.312649 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 17.01 examples/second between steps 17 and 18
I0417 21:51:06.364947 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 19.23 examples/second between steps 18 and 19
I0417 21:51:06.410713 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 21.97 examples/second between steps 19 and 20
I0417 21:51:06.411368 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 2
I0417 21:51:06.411581 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 2
INFO:tensorflow:Running non-virtual train step
I0417 21:51:06.418016 139882588534528 training.py:940] Running non-virtual train step
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:51:10.321619 139907979052864 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:51:10.323475 139907979052864 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:51:14.986752 139907979052864 keras_utils.py:163] TimeHistory: 8.58 seconds, 0.23 examples/second between steps 20 and 21
I0417 21:51:15.043278 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 35.63 examples/second between steps 21 and 22
I0417 21:51:15.100827 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 34.91 examples/second between steps 22 and 23
I0417 21:51:15.155224 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 36.95 examples/second between steps 23 and 24
I0417 21:51:15.210504 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 36.36 examples/second between steps 24 and 25
I0417 21:51:15.262097 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 38.96 examples/second between steps 25 and 26
I0417 21:51:15.320382 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 34.47 examples/second between steps 26 and 27
I0417 21:51:15.379122 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 34.22 examples/second between steps 27 and 28
I0417 21:51:15.428236 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 40.94 examples/second between steps 28 and 29
I0417 21:51:15.481447 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 37.76 examples/second between steps 29 and 30
I0417 21:51:15.530587 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 40.92 examples/second between steps 30 and 31
I0417 21:51:15.587411 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 35.36 examples/second between steps 31 and 32
I0417 21:51:15.646605 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 33.94 examples/second between steps 32 and 33
I0417 21:51:15.702375 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 36.03 examples/second between steps 33 and 34
I0417 21:51:15.755697 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 37.68 examples/second between steps 34 and 35
I0417 21:51:15.808823 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 37.84 examples/second between steps 35 and 36
I0417 21:51:15.855458 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 43.14 examples/second between steps 36 and 37
I0417 21:51:15.908916 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 37.59 examples/second between steps 37 and 38
I0417 21:51:15.966382 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 34.99 examples/second between steps 38 and 39
I0417 21:51:16.023218 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 35.34 examples/second between steps 39 and 40
I0417 21:51:16.023729 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 4
I0417 21:51:16.023904 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 4
INFO:tensorflow:Running non-virtual train step
I0417 21:51:16.030419 139882580141824 training.py:940] Running non-virtual train step
I0417 21:51:24.071702 139907979052864 keras_utils.py:163] TimeHistory: 8.05 seconds, 0.50 examples/second between steps 40 and 41
I0417 21:51:24.128215 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 71.13 examples/second between steps 41 and 42
I0417 21:51:24.187239 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 68.10 examples/second between steps 42 and 43
I0417 21:51:24.253871 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 60.30 examples/second between steps 43 and 44
I0417 21:51:24.317842 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 62.77 examples/second between steps 44 and 45
I0417 21:51:24.389071 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 56.35 examples/second between steps 45 and 46
I0417 21:51:24.442585 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 75.11 examples/second between steps 46 and 47
I0417 21:51:24.495073 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 76.55 examples/second between steps 47 and 48
I0417 21:51:24.560786 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 61.12 examples/second between steps 48 and 49
I0417 21:51:24.613394 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 76.40 examples/second between steps 49 and 50
I0417 21:51:24.677145 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 62.99 examples/second between steps 50 and 51
I0417 21:51:24.734916 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 69.56 examples/second between steps 51 and 52
I0417 21:51:24.792179 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 70.20 examples/second between steps 52 and 53
I0417 21:51:24.858590 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 60.45 examples/second between steps 53 and 54
I0417 21:51:24.911133 139907979052864 keras_utils.py:163] TimeHistory: 0.05 seconds, 76.54 examples/second between steps 54 and 55
I0417 21:51:24.974890 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 62.98 examples/second between steps 55 and 56
I0417 21:51:25.036204 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 65.51 examples/second between steps 56 and 57
I0417 21:51:25.098168 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 64.87 examples/second between steps 57 and 58
I0417 21:51:25.156007 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 69.46 examples/second between steps 58 and 59
I0417 21:51:25.223184 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 59.78 examples/second between steps 59 and 60
I0417 21:51:25.223746 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 8
I0417 21:51:25.223943 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 8
INFO:tensorflow:Running non-virtual train step
I0417 21:51:25.230358 139882571749120 training.py:940] Running non-virtual train step
I0417 21:51:34.137307 139907979052864 keras_utils.py:163] TimeHistory: 8.91 seconds, 0.90 examples/second between steps 60 and 61
I0417 21:51:34.232541 139907979052864 keras_utils.py:163] TimeHistory: 0.09 seconds, 84.30 examples/second between steps 61 and 62
I0417 21:51:34.292980 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 133.00 examples/second between steps 62 and 63
I0417 21:51:34.348425 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 145.06 examples/second between steps 63 and 64
I0417 21:51:34.428099 139907979052864 keras_utils.py:163] TimeHistory: 0.08 seconds, 100.74 examples/second between steps 64 and 65
I0417 21:51:34.505811 139907979052864 keras_utils.py:163] TimeHistory: 0.08 seconds, 103.31 examples/second between steps 65 and 66
I0417 21:51:34.577972 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 111.28 examples/second between steps 66 and 67
I0417 21:51:34.646295 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 117.57 examples/second between steps 67 and 68
I0417 21:51:34.737210 139907979052864 keras_utils.py:163] TimeHistory: 0.09 seconds, 88.26 examples/second between steps 68 and 69
I0417 21:51:34.812209 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 107.11 examples/second between steps 69 and 70
I0417 21:51:34.883594 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 112.54 examples/second between steps 70 and 71
I0417 21:51:34.952517 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 116.68 examples/second between steps 71 and 72
I0417 21:51:35.014587 139907979052864 keras_utils.py:163] TimeHistory: 0.06 seconds, 129.51 examples/second between steps 72 and 73
I0417 21:51:35.081487 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 120.08 examples/second between steps 73 and 74
I0417 21:51:35.177231 139907979052864 keras_utils.py:163] TimeHistory: 0.10 seconds, 83.80 examples/second between steps 74 and 75
I0417 21:51:35.273782 139907979052864 keras_utils.py:163] TimeHistory: 0.10 seconds, 83.14 examples/second between steps 75 and 76
I0417 21:51:35.369504 139907979052864 keras_utils.py:163] TimeHistory: 0.10 seconds, 83.85 examples/second between steps 76 and 77
I0417 21:51:35.434930 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 122.87 examples/second between steps 77 and 78
I0417 21:51:35.517448 139907979052864 keras_utils.py:163] TimeHistory: 0.08 seconds, 97.29 examples/second between steps 78 and 79
I0417 21:51:35.584162 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 120.47 examples/second between steps 79 and 80
I0417 21:51:35.584783 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 12
I0417 21:51:35.584992 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 12
INFO:tensorflow:Running non-virtual train step
I0417 21:51:35.591840 139882563356416 training.py:940] Running non-virtual train step
I0417 21:51:44.342256 139907979052864 keras_utils.py:163] TimeHistory: 8.76 seconds, 1.37 examples/second between steps 80 and 81
I0417 21:51:44.438020 139907979052864 keras_utils.py:163] TimeHistory: 0.10 seconds, 125.72 examples/second between steps 81 and 82
I0417 21:51:44.534847 139907979052864 keras_utils.py:163] TimeHistory: 0.10 seconds, 124.32 examples/second between steps 82 and 83
I0417 21:51:44.611871 139907979052864 keras_utils.py:163] TimeHistory: 0.08 seconds, 156.38 examples/second between steps 83 and 84
I0417 21:51:44.707766 139907979052864 keras_utils.py:163] TimeHistory: 0.10 seconds, 125.49 examples/second between steps 84 and 85
I0417 21:51:44.823559 139907979052864 keras_utils.py:163] TimeHistory: 0.12 seconds, 103.89 examples/second between steps 85 and 86
I0417 21:51:44.903810 139907979052864 keras_utils.py:163] TimeHistory: 0.08 seconds, 150.10 examples/second between steps 86 and 87
I0417 21:51:45.024782 139907979052864 keras_utils.py:163] TimeHistory: 0.12 seconds, 99.47 examples/second between steps 87 and 88
I0417 21:51:45.106949 139907979052864 keras_utils.py:163] TimeHistory: 0.08 seconds, 146.55 examples/second between steps 88 and 89
I0417 21:51:45.213092 139907979052864 keras_utils.py:163] TimeHistory: 0.11 seconds, 113.35 examples/second between steps 89 and 90
I0417 21:51:45.296257 139907979052864 keras_utils.py:163] TimeHistory: 0.08 seconds, 144.79 examples/second between steps 90 and 91
I0417 21:51:45.405907 139907979052864 keras_utils.py:163] TimeHistory: 0.11 seconds, 109.73 examples/second between steps 91 and 92
I0417 21:51:45.530462 139907979052864 keras_utils.py:163] TimeHistory: 0.12 seconds, 96.59 examples/second between steps 92 and 93
I0417 21:51:45.623788 139907979052864 keras_utils.py:163] TimeHistory: 0.09 seconds, 129.01 examples/second between steps 93 and 94
I0417 21:51:45.721413 139907979052864 keras_utils.py:163] TimeHistory: 0.10 seconds, 123.29 examples/second between steps 94 and 95
I0417 21:51:45.835946 139907979052864 keras_utils.py:163] TimeHistory: 0.11 seconds, 105.05 examples/second between steps 95 and 96
I0417 21:51:45.933114 139907979052864 keras_utils.py:163] TimeHistory: 0.10 seconds, 123.92 examples/second between steps 96 and 97
I0417 21:51:46.001265 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 176.87 examples/second between steps 97 and 98
I0417 21:51:46.078111 139907979052864 keras_utils.py:163] TimeHistory: 0.08 seconds, 156.80 examples/second between steps 98 and 99
I0417 21:51:46.183641 139907979052864 keras_utils.py:163] TimeHistory: 0.11 seconds, 114.03 examples/second between steps 99 and 100
I0417 21:51:46.184237 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 16
I0417 21:51:46.184457 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 16
INFO:tensorflow:Running non-virtual train step
I0417 21:51:46.191226 139882554963712 training.py:940] Running non-virtual train step
I0417 21:51:55.072941 139907979052864 keras_utils.py:163] TimeHistory: 8.89 seconds, 1.80 examples/second between steps 100 and 101
I0417 21:51:55.207811 139907979052864 keras_utils.py:163] TimeHistory: 0.13 seconds, 118.92 examples/second between steps 101 and 102
I0417 21:51:55.293095 139907979052864 keras_utils.py:163] TimeHistory: 0.08 seconds, 188.24 examples/second between steps 102 and 103
I0417 21:51:55.389629 139907979052864 keras_utils.py:163] TimeHistory: 0.10 seconds, 166.26 examples/second between steps 103 and 104
I0417 21:51:55.505866 139907979052864 keras_utils.py:163] TimeHistory: 0.12 seconds, 138.02 examples/second between steps 104 and 105
I0417 21:51:55.578151 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 222.48 examples/second between steps 105 and 106
I0417 21:51:55.671881 139907979052864 keras_utils.py:163] TimeHistory: 0.09 seconds, 171.30 examples/second between steps 106 and 107
I0417 21:51:55.743507 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 224.45 examples/second between steps 107 and 108
I0417 21:51:55.852139 139907979052864 keras_utils.py:163] TimeHistory: 0.11 seconds, 147.70 examples/second between steps 108 and 109
I0417 21:51:55.959843 139907979052864 keras_utils.py:163] TimeHistory: 0.11 seconds, 148.96 examples/second between steps 109 and 110
I0417 21:51:56.094551 139907979052864 keras_utils.py:163] TimeHistory: 0.13 seconds, 119.02 examples/second between steps 110 and 111
I0417 21:51:56.184960 139907979052864 keras_utils.py:163] TimeHistory: 0.09 seconds, 177.55 examples/second between steps 111 and 112
I0417 21:51:56.335592 139907979052864 keras_utils.py:163] TimeHistory: 0.15 seconds, 106.42 examples/second between steps 112 and 113
I0417 21:51:56.456206 139907979052864 keras_utils.py:163] TimeHistory: 0.12 seconds, 132.98 examples/second between steps 113 and 114
I0417 21:51:56.552317 139907979052864 keras_utils.py:163] TimeHistory: 0.10 seconds, 166.99 examples/second between steps 114 and 115
I0417 21:51:56.623443 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 225.88 examples/second between steps 115 and 116
I0417 21:51:56.702924 139907979052864 keras_utils.py:163] TimeHistory: 0.08 seconds, 202.07 examples/second between steps 116 and 117
I0417 21:51:56.775822 139907979052864 keras_utils.py:163] TimeHistory: 0.07 seconds, 220.33 examples/second between steps 117 and 118
I0417 21:51:56.917824 139907979052864 keras_utils.py:163] TimeHistory: 0.14 seconds, 112.89 examples/second between steps 118 and 119
I0417 21:51:57.045644 139907979052864 keras_utils.py:163] TimeHistory: 0.13 seconds, 125.46 examples/second between steps 119 and 120
I0417 21:51:57.046352 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 24
I0417 21:51:57.046571 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 24
INFO:tensorflow:Running non-virtual train step
I0417 21:51:57.053285 139882532677376 training.py:940] Running non-virtual train step
I0417 21:52:05.476640 139907979052864 keras_utils.py:163] TimeHistory: 8.43 seconds, 2.85 examples/second between steps 120 and 121
I0417 21:52:05.609838 139907979052864 keras_utils.py:163] TimeHistory: 0.13 seconds, 180.58 examples/second between steps 121 and 122
I0417 21:52:05.748683 139907979052864 keras_utils.py:163] TimeHistory: 0.14 seconds, 173.20 examples/second between steps 122 and 123
I0417 21:52:05.859454 139907979052864 keras_utils.py:163] TimeHistory: 0.11 seconds, 217.19 examples/second between steps 123 and 124
I0417 21:52:06.047219 139907979052864 keras_utils.py:163] TimeHistory: 0.19 seconds, 128.02 examples/second between steps 124 and 125
I0417 21:52:06.206658 139907979052864 keras_utils.py:163] TimeHistory: 0.16 seconds, 150.87 examples/second between steps 125 and 126
I0417 21:52:06.313495 139907979052864 keras_utils.py:163] TimeHistory: 0.11 seconds, 225.29 examples/second between steps 126 and 127
I0417 21:52:06.437569 139907979052864 keras_utils.py:163] TimeHistory: 0.12 seconds, 193.90 examples/second between steps 127 and 128
I0417 21:52:06.556134 139907979052864 keras_utils.py:163] TimeHistory: 0.12 seconds, 202.94 examples/second between steps 128 and 129
I0417 21:52:06.672037 139907979052864 keras_utils.py:163] TimeHistory: 0.12 seconds, 207.63 examples/second between steps 129 and 130
I0417 21:52:06.845461 139907979052864 keras_utils.py:163] TimeHistory: 0.17 seconds, 138.66 examples/second between steps 130 and 131
I0417 21:52:07.061935 139907979052864 keras_utils.py:163] TimeHistory: 0.22 seconds, 111.04 examples/second between steps 131 and 132
I0417 21:52:07.197078 139907979052864 keras_utils.py:163] TimeHistory: 0.13 seconds, 178.03 examples/second between steps 132 and 133
I0417 21:52:07.400428 139907979052864 keras_utils.py:163] TimeHistory: 0.20 seconds, 118.21 examples/second between steps 133 and 134
I0417 21:52:07.589265 139907979052864 keras_utils.py:163] TimeHistory: 0.19 seconds, 127.32 examples/second between steps 134 and 135
I0417 21:52:07.730311 139907979052864 keras_utils.py:163] TimeHistory: 0.14 seconds, 170.55 examples/second between steps 135 and 136
I0417 21:52:07.879146 139907979052864 keras_utils.py:163] TimeHistory: 0.15 seconds, 161.57 examples/second between steps 136 and 137
I0417 21:52:08.037399 139907979052864 keras_utils.py:163] TimeHistory: 0.16 seconds, 151.95 examples/second between steps 137 and 138
I0417 21:52:08.127008 139907979052864 keras_utils.py:163] TimeHistory: 0.09 seconds, 268.70 examples/second between steps 138 and 139
I0417 21:52:08.240768 139907979052864 keras_utils.py:163] TimeHistory: 0.11 seconds, 211.54 examples/second between steps 139 and 140
I0417 21:52:08.241401 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 32
I0417 21:52:08.241615 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 32
INFO:tensorflow:Running non-virtual train step
I0417 21:52:08.248925 139882507769600 training.py:940] Running non-virtual train step
I0417 21:52:16.966662 139907979052864 keras_utils.py:163] TimeHistory: 8.73 seconds, 3.67 examples/second between steps 140 and 141
I0417 21:52:17.131946 139907979052864 keras_utils.py:163] TimeHistory: 0.16 seconds, 193.97 examples/second between steps 141 and 142
I0417 21:52:17.351726 139907979052864 keras_utils.py:163] TimeHistory: 0.22 seconds, 145.79 examples/second between steps 142 and 143
I0417 21:52:17.502528 139907979052864 keras_utils.py:163] TimeHistory: 0.15 seconds, 212.59 examples/second between steps 143 and 144
I0417 21:52:17.602200 139907979052864 keras_utils.py:163] TimeHistory: 0.10 seconds, 322.01 examples/second between steps 144 and 145
I0417 21:52:17.842628 139907979052864 keras_utils.py:163] TimeHistory: 0.24 seconds, 133.24 examples/second between steps 145 and 146
I0417 21:52:18.018966 139907979052864 keras_utils.py:163] TimeHistory: 0.18 seconds, 181.77 examples/second between steps 146 and 147
I0417 21:52:18.279442 139907979052864 keras_utils.py:163] TimeHistory: 0.26 seconds, 123.04 examples/second between steps 147 and 148
I0417 21:52:18.420859 139907979052864 keras_utils.py:163] TimeHistory: 0.14 seconds, 226.81 examples/second between steps 148 and 149
I0417 21:52:18.696576 139907979052864 keras_utils.py:163] TimeHistory: 0.28 seconds, 116.20 examples/second between steps 149 and 150
I0417 21:52:18.885901 139907979052864 keras_utils.py:163] TimeHistory: 0.19 seconds, 169.31 examples/second between steps 150 and 151
I0417 21:52:19.090198 139907979052864 keras_utils.py:163] TimeHistory: 0.20 seconds, 156.88 examples/second between steps 151 and 152
I0417 21:52:19.213439 139907979052864 keras_utils.py:163] TimeHistory: 0.12 seconds, 260.41 examples/second between steps 152 and 153
I0417 21:52:19.348352 139907979052864 keras_utils.py:163] TimeHistory: 0.13 seconds, 237.74 examples/second between steps 153 and 154
I0417 21:52:19.514410 139907979052864 keras_utils.py:163] TimeHistory: 0.17 seconds, 193.08 examples/second between steps 154 and 155
I0417 21:52:19.601445 139907979052864 keras_utils.py:163] TimeHistory: 0.09 seconds, 368.89 examples/second between steps 155 and 156
I0417 21:52:19.697646 139907979052864 keras_utils.py:163] TimeHistory: 0.10 seconds, 333.62 examples/second between steps 156 and 157
I0417 21:52:19.849452 139907979052864 keras_utils.py:163] TimeHistory: 0.15 seconds, 211.19 examples/second between steps 157 and 158
I0417 21:52:20.069041 139907979052864 keras_utils.py:163] TimeHistory: 0.22 seconds, 145.93 examples/second between steps 158 and 159
I0417 21:52:20.308304 139907979052864 keras_utils.py:163] TimeHistory: 0.24 seconds, 133.91 examples/second between steps 159 and 160
I0417 21:52:20.308877 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 48
I0417 21:52:20.309075 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 48
INFO:tensorflow:Running non-virtual train step
I0417 21:52:20.315763 139882482861824 training.py:940] Running non-virtual train step
I0417 21:52:29.133759 139907979052864 keras_utils.py:163] TimeHistory: 8.82 seconds, 5.44 examples/second between steps 160 and 161
I0417 21:52:29.517452 139907979052864 keras_utils.py:163] TimeHistory: 0.38 seconds, 125.21 examples/second between steps 161 and 162
I0417 21:52:29.812721 139907979052864 keras_utils.py:163] TimeHistory: 0.29 seconds, 162.73 examples/second between steps 162 and 163
I0417 21:52:30.080629 139907979052864 keras_utils.py:163] TimeHistory: 0.27 seconds, 179.38 examples/second between steps 163 and 164
I0417 21:52:30.255415 139907979052864 keras_utils.py:163] TimeHistory: 0.17 seconds, 275.15 examples/second between steps 164 and 165
I0417 21:52:30.396142 139907979052864 keras_utils.py:163] TimeHistory: 0.14 seconds, 341.82 examples/second between steps 165 and 166
I0417 21:52:30.799854 139907979052864 keras_utils.py:163] TimeHistory: 0.40 seconds, 118.99 examples/second between steps 166 and 167
I0417 21:52:31.035502 139907979052864 keras_utils.py:163] TimeHistory: 0.24 seconds, 203.95 examples/second between steps 167 and 168
I0417 21:52:31.251021 139907979052864 keras_utils.py:163] TimeHistory: 0.22 seconds, 223.08 examples/second between steps 168 and 169
I0417 21:52:31.449835 139907979052864 keras_utils.py:163] TimeHistory: 0.20 seconds, 241.79 examples/second between steps 169 and 170
I0417 21:52:31.601597 139907979052864 keras_utils.py:163] TimeHistory: 0.15 seconds, 316.93 examples/second between steps 170 and 171
I0417 21:52:31.917335 139907979052864 keras_utils.py:163] TimeHistory: 0.32 seconds, 152.17 examples/second between steps 171 and 172
I0417 21:52:32.272062 139907979052864 keras_utils.py:163] TimeHistory: 0.35 seconds, 135.46 examples/second between steps 172 and 173
I0417 21:52:32.461179 139907979052864 keras_utils.py:163] TimeHistory: 0.19 seconds, 254.25 examples/second between steps 173 and 174
I0417 21:52:32.755635 139907979052864 keras_utils.py:163] TimeHistory: 0.29 seconds, 163.20 examples/second between steps 174 and 175
I0417 21:52:33.140105 139907979052864 keras_utils.py:163] TimeHistory: 0.38 seconds, 124.95 examples/second between steps 175 and 176
I0417 21:52:33.304398 139907979052864 keras_utils.py:163] TimeHistory: 0.16 seconds, 292.72 examples/second between steps 176 and 177
I0417 21:52:33.554540 139907979052864 keras_utils.py:163] TimeHistory: 0.25 seconds, 192.12 examples/second between steps 177 and 178
I0417 21:52:33.821333 139907979052864 keras_utils.py:163] TimeHistory: 0.27 seconds, 180.13 examples/second between steps 178 and 179
I0417 21:52:34.056809 139907979052864 keras_utils.py:163] TimeHistory: 0.24 seconds, 204.12 examples/second between steps 179 and 180
I0417 21:52:34.057459 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 64
I0417 21:52:34.057706 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 64
INFO:tensorflow:Running non-virtual train step
I0417 21:52:34.064807 139882457954048 training.py:940] Running non-virtual train step
I0417 21:52:43.598948 139907979052864 keras_utils.py:163] TimeHistory: 9.54 seconds, 6.71 examples/second between steps 180 and 181
I0417 21:52:43.872021 139907979052864 keras_utils.py:163] TimeHistory: 0.27 seconds, 234.67 examples/second between steps 181 and 182
I0417 21:52:44.374037 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 127.57 examples/second between steps 182 and 183
I0417 21:52:44.815465 139907979052864 keras_utils.py:163] TimeHistory: 0.44 seconds, 145.09 examples/second between steps 183 and 184
I0417 21:52:45.201410 139907979052864 keras_utils.py:163] TimeHistory: 0.39 seconds, 165.97 examples/second between steps 184 and 185
I0417 21:52:45.371750 139907979052864 keras_utils.py:163] TimeHistory: 0.17 seconds, 376.41 examples/second between steps 185 and 186
I0417 21:52:45.624670 139907979052864 keras_utils.py:163] TimeHistory: 0.25 seconds, 253.37 examples/second between steps 186 and 187
I0417 21:52:46.103896 139907979052864 keras_utils.py:163] TimeHistory: 0.48 seconds, 133.64 examples/second between steps 187 and 188
I0417 21:52:46.424431 139907979052864 keras_utils.py:163] TimeHistory: 0.32 seconds, 199.87 examples/second between steps 188 and 189
I0417 21:52:46.649717 139907979052864 keras_utils.py:163] TimeHistory: 0.22 seconds, 284.48 examples/second between steps 189 and 190
I0417 21:52:47.055659 139907979052864 keras_utils.py:163] TimeHistory: 0.41 seconds, 157.78 examples/second between steps 190 and 191
I0417 21:52:47.295806 139907979052864 keras_utils.py:163] TimeHistory: 0.24 seconds, 266.85 examples/second between steps 191 and 192
I0417 21:52:47.597871 139907979052864 keras_utils.py:163] TimeHistory: 0.30 seconds, 212.09 examples/second between steps 192 and 193
I0417 21:52:47.951870 139907979052864 keras_utils.py:163] TimeHistory: 0.35 seconds, 180.94 examples/second between steps 193 and 194
I0417 21:52:48.225003 139907979052864 keras_utils.py:163] TimeHistory: 0.27 seconds, 234.60 examples/second between steps 194 and 195
I0417 21:52:48.666522 139907979052864 keras_utils.py:163] TimeHistory: 0.44 seconds, 145.06 examples/second between steps 195 and 196
I0417 21:52:49.053162 139907979052864 keras_utils.py:163] TimeHistory: 0.39 seconds, 165.68 examples/second between steps 196 and 197
I0417 21:52:49.248092 139907979052864 keras_utils.py:163] TimeHistory: 0.19 seconds, 328.86 examples/second between steps 197 and 198
I0417 21:52:49.457784 139907979052864 keras_utils.py:163] TimeHistory: 0.21 seconds, 305.72 examples/second between steps 198 and 199
I0417 21:52:49.779337 139907979052864 keras_utils.py:163] TimeHistory: 0.32 seconds, 199.25 examples/second between steps 199 and 200
I0417 21:52:49.779984 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 96
I0417 21:52:49.780223 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 96
INFO:tensorflow:Running non-virtual train step
I0417 21:52:49.787376 139882433046272 training.py:940] Running non-virtual train step
I0417 21:52:59.167128 139907979052864 keras_utils.py:163] TimeHistory: 9.39 seconds, 10.23 examples/second between steps 200 and 201
I0417 21:52:59.670096 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 191.01 examples/second between steps 201 and 202
I0417 21:53:00.171416 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 191.61 examples/second between steps 202 and 203
I0417 21:53:00.674328 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 191.01 examples/second between steps 203 and 204
I0417 21:53:01.051088 139907979052864 keras_utils.py:163] TimeHistory: 0.38 seconds, 255.00 examples/second between steps 204 and 205
I0417 21:53:01.561163 139907979052864 keras_utils.py:163] TimeHistory: 0.51 seconds, 188.32 examples/second between steps 205 and 206
I0417 21:53:01.993857 139907979052864 keras_utils.py:163] TimeHistory: 0.43 seconds, 222.04 examples/second between steps 206 and 207
I0417 21:53:02.494279 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 191.97 examples/second between steps 207 and 208
I0417 21:53:02.897949 139907979052864 keras_utils.py:163] TimeHistory: 0.40 seconds, 238.00 examples/second between steps 208 and 209
I0417 21:53:03.395932 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 192.89 examples/second between steps 209 and 210
I0417 21:53:03.749547 139907979052864 keras_utils.py:163] TimeHistory: 0.35 seconds, 271.71 examples/second between steps 210 and 211
I0417 21:53:04.214705 139907979052864 keras_utils.py:163] TimeHistory: 0.46 seconds, 206.52 examples/second between steps 211 and 212
I0417 21:53:04.444374 139907979052864 keras_utils.py:163] TimeHistory: 0.23 seconds, 418.55 examples/second between steps 212 and 213
I0417 21:53:04.763809 139907979052864 keras_utils.py:163] TimeHistory: 0.32 seconds, 300.81 examples/second between steps 213 and 214
I0417 21:53:05.266326 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 191.15 examples/second between steps 214 and 215
I0417 21:53:05.765627 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 192.38 examples/second between steps 215 and 216
I0417 21:53:05.928138 139907979052864 keras_utils.py:163] TimeHistory: 0.16 seconds, 591.89 examples/second between steps 216 and 217
I0417 21:53:06.425980 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 192.95 examples/second between steps 217 and 218
I0417 21:53:06.856352 139907979052864 keras_utils.py:163] TimeHistory: 0.43 seconds, 223.23 examples/second between steps 218 and 219
I0417 21:53:07.259324 139907979052864 keras_utils.py:163] TimeHistory: 0.40 seconds, 238.41 examples/second between steps 219 and 220
I0417 21:53:07.259892 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 128
I0417 21:53:07.260097 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 128
INFO:tensorflow:Running non-virtual train step
I0417 21:53:07.266696 139882408138496 training.py:940] Running non-virtual train step
I0417 21:53:16.067318 139907979052864 keras_utils.py:163] TimeHistory: 8.81 seconds, 14.53 examples/second between steps 220 and 221
I0417 21:53:16.568762 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 255.44 examples/second between steps 221 and 222
I0417 21:53:16.845664 139907979052864 keras_utils.py:163] TimeHistory: 0.28 seconds, 462.77 examples/second between steps 222 and 223
I0417 21:53:17.344773 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 256.63 examples/second between steps 223 and 224
I0417 21:53:17.842360 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 257.40 examples/second between steps 224 and 225
I0417 21:53:18.314417 139907979052864 keras_utils.py:163] TimeHistory: 0.47 seconds, 271.32 examples/second between steps 225 and 226
I0417 21:53:18.816276 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 255.21 examples/second between steps 226 and 227
I0417 21:53:19.141727 139907979052864 keras_utils.py:163] TimeHistory: 0.33 seconds, 393.68 examples/second between steps 227 and 228
I0417 21:53:19.512118 139907979052864 keras_utils.py:163] TimeHistory: 0.37 seconds, 345.88 examples/second between steps 228 and 229
I0417 21:53:20.014566 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 254.91 examples/second between steps 229 and 230
I0417 21:53:20.513806 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 256.56 examples/second between steps 230 and 231
I0417 21:53:20.953133 139907979052864 keras_utils.py:163] TimeHistory: 0.44 seconds, 291.55 examples/second between steps 231 and 232
I0417 21:53:21.451081 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 257.27 examples/second between steps 232 and 233
I0417 21:53:21.952604 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 255.40 examples/second between steps 233 and 234
I0417 21:53:22.452370 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 256.28 examples/second between steps 234 and 235
I0417 21:53:22.957690 139907979052864 keras_utils.py:163] TimeHistory: 0.51 seconds, 253.45 examples/second between steps 235 and 236
I0417 21:53:23.458453 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 255.79 examples/second between steps 236 and 237
I0417 21:53:23.865685 139907979052864 keras_utils.py:163] TimeHistory: 0.41 seconds, 314.56 examples/second between steps 237 and 238
I0417 21:53:24.363427 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 257.34 examples/second between steps 238 and 239
I0417 21:53:24.864857 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 255.44 examples/second between steps 239 and 240
I0417 21:53:24.865579 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 192
I0417 21:53:24.865837 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 192
INFO:tensorflow:Running non-virtual train step
I0417 21:53:24.873123 139882383230720 training.py:940] Running non-virtual train step
I0417 21:53:33.786895 139907979052864 keras_utils.py:163] TimeHistory: 8.92 seconds, 21.52 examples/second between steps 240 and 241
I0417 21:53:34.287332 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 383.91 examples/second between steps 241 and 242
I0417 21:53:34.786268 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 385.05 examples/second between steps 242 and 243
I0417 21:53:35.285894 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 384.51 examples/second between steps 243 and 244
I0417 21:53:35.781414 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 387.71 examples/second between steps 244 and 245
I0417 21:53:36.276938 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 387.69 examples/second between steps 245 and 246
I0417 21:53:36.774537 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 386.07 examples/second between steps 246 and 247
I0417 21:53:37.274104 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 384.56 examples/second between steps 247 and 248
I0417 21:53:37.774723 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 383.77 examples/second between steps 248 and 249
I0417 21:53:38.277863 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 381.84 examples/second between steps 249 and 250
I0417 21:53:38.778844 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 383.49 examples/second between steps 250 and 251
I0417 21:53:39.276214 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 386.30 examples/second between steps 251 and 252
I0417 21:53:39.721044 139907979052864 keras_utils.py:163] TimeHistory: 0.44 seconds, 431.96 examples/second between steps 252 and 253
I0417 21:53:40.113206 139907979052864 keras_utils.py:163] TimeHistory: 0.39 seconds, 490.30 examples/second between steps 253 and 254
I0417 21:53:40.611536 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 385.53 examples/second between steps 254 and 255
I0417 21:53:41.109943 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 385.48 examples/second between steps 255 and 256
I0417 21:53:41.610609 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 383.74 examples/second between steps 256 and 257
I0417 21:53:42.106807 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 387.18 examples/second between steps 257 and 258
I0417 21:53:42.603764 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 386.60 examples/second between steps 258 and 259
I0417 21:53:43.103373 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 384.54 examples/second between steps 259 and 260
I0417 21:53:43.104024 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 256
I0417 21:53:43.104253 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 256
INFO:tensorflow:Running non-virtual train step
I0417 21:53:43.111399 139882358322944 training.py:940] Running non-virtual train step
I0417 21:53:52.586284 139907979052864 keras_utils.py:163] TimeHistory: 9.48 seconds, 27.00 examples/second between steps 260 and 261
I0417 21:53:53.089170 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 509.40 examples/second between steps 261 and 262
I0417 21:53:53.591469 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 509.99 examples/second between steps 262 and 263
I0417 21:53:54.093384 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 510.38 examples/second between steps 263 and 264
I0417 21:53:54.593440 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 512.27 examples/second between steps 264 and 265
I0417 21:53:55.099032 139907979052864 keras_utils.py:163] TimeHistory: 0.51 seconds, 506.64 examples/second between steps 265 and 266
I0417 21:53:55.602137 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 509.13 examples/second between steps 266 and 267
I0417 21:53:56.100241 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 514.25 examples/second between steps 267 and 268
I0417 21:53:56.596434 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 516.32 examples/second between steps 268 and 269
I0417 21:53:57.096585 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 512.15 examples/second between steps 269 and 270
I0417 21:53:57.597192 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 511.69 examples/second between steps 270 and 271
I0417 21:53:58.098226 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 511.28 examples/second between steps 271 and 272
I0417 21:53:58.603550 139907979052864 keras_utils.py:163] TimeHistory: 0.51 seconds, 506.90 examples/second between steps 272 and 273
I0417 21:53:59.105600 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 510.21 examples/second between steps 273 and 274
I0417 21:53:59.604269 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 513.69 examples/second between steps 274 and 275
I0417 21:54:00.108819 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 507.72 examples/second between steps 275 and 276
I0417 21:54:00.613611 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 507.49 examples/second between steps 276 and 277
I0417 21:54:01.116506 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 509.36 examples/second between steps 277 and 278
I0417 21:54:01.614254 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 514.62 examples/second between steps 278 and 279
I0417 21:54:02.118186 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 508.31 examples/second between steps 279 and 280
I0417 21:54:02.118852 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 384
I0417 21:54:02.119103 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 384
INFO:tensorflow:Running non-virtual train step
I0417 21:54:02.126152 139882333677312 training.py:940] Running non-virtual train step
I0417 21:54:11.183721 139907979052864 keras_utils.py:163] TimeHistory: 9.06 seconds, 42.36 examples/second between steps 280 and 281
I0417 21:54:11.674838 139907979052864 keras_utils.py:163] TimeHistory: 0.49 seconds, 782.39 examples/second between steps 281 and 282
I0417 21:54:12.173505 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 770.52 examples/second between steps 282 and 283
I0417 21:54:12.670799 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 772.63 examples/second between steps 283 and 284
I0417 21:54:13.166357 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 775.35 examples/second between steps 284 and 285
I0417 21:54:13.669529 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 763.60 examples/second between steps 285 and 286
I0417 21:54:14.167266 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 772.00 examples/second between steps 286 and 287
I0417 21:54:14.536860 139907979052864 keras_utils.py:163] TimeHistory: 0.37 seconds, 1039.89 examples/second between steps 287 and 288
I0417 21:54:15.025660 139907979052864 keras_utils.py:163] TimeHistory: 0.49 seconds, 786.11 examples/second between steps 288 and 289
I0417 21:54:15.522495 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 773.40 examples/second between steps 289 and 290
I0417 21:54:16.025915 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 763.26 examples/second between steps 290 and 291
I0417 21:54:16.509950 139907979052864 keras_utils.py:163] TimeHistory: 0.48 seconds, 793.87 examples/second between steps 291 and 292
I0417 21:54:17.010781 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 767.16 examples/second between steps 292 and 293
I0417 21:54:17.510481 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 768.93 examples/second between steps 293 and 294
I0417 21:54:18.015448 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 760.87 examples/second between steps 294 and 295
I0417 21:54:18.512293 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 773.34 examples/second between steps 295 and 296
I0417 21:54:19.013140 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 767.14 examples/second between steps 296 and 297
I0417 21:54:19.504270 139907979052864 keras_utils.py:163] TimeHistory: 0.49 seconds, 782.38 examples/second between steps 297 and 298
I0417 21:54:20.007085 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 764.18 examples/second between steps 298 and 299
I0417 21:54:20.508212 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 766.73 examples/second between steps 299 and 300
I0417 21:54:20.508767 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 512
I0417 21:54:20.508999 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 512
INFO:tensorflow:Running non-virtual train step
I0417 21:54:20.515829 139882308507392 training.py:940] Running non-virtual train step
I0417 21:54:29.597036 139907979052864 keras_utils.py:163] TimeHistory: 9.09 seconds, 56.34 examples/second between steps 300 and 301
I0417 21:54:30.091095 139907979052864 keras_utils.py:163] TimeHistory: 0.49 seconds, 1037.01 examples/second between steps 301 and 302
I0417 21:54:30.591011 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1024.82 examples/second between steps 302 and 303
I0417 21:54:31.088758 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1029.24 examples/second between steps 303 and 304
I0417 21:54:31.588958 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1024.18 examples/second between steps 304 and 305
I0417 21:54:32.085078 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1032.63 examples/second between steps 305 and 306
I0417 21:54:32.587752 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1019.25 examples/second between steps 306 and 307
I0417 21:54:33.074645 139907979052864 keras_utils.py:163] TimeHistory: 0.49 seconds, 1052.23 examples/second between steps 307 and 308
I0417 21:54:33.573246 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1027.70 examples/second between steps 308 and 309
I0417 21:54:34.077270 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1016.51 examples/second between steps 309 and 310
I0417 21:54:34.575624 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1028.06 examples/second between steps 310 and 311
I0417 21:54:35.073316 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1029.42 examples/second between steps 311 and 312
I0417 21:54:35.575841 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1019.50 examples/second between steps 312 and 313
I0417 21:54:36.075393 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1025.58 examples/second between steps 313 and 314
I0417 21:54:36.579726 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1015.83 examples/second between steps 314 and 315
I0417 21:54:37.078551 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1027.06 examples/second between steps 315 and 316
I0417 21:54:37.578475 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1024.79 examples/second between steps 316 and 317
I0417 21:54:38.069224 139907979052864 keras_utils.py:163] TimeHistory: 0.49 seconds, 1043.92 examples/second between steps 317 and 318
I0417 21:54:38.563513 139907979052864 keras_utils.py:163] TimeHistory: 0.49 seconds, 1036.51 examples/second between steps 318 and 319
I0417 21:54:39.068105 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1015.29 examples/second between steps 319 and 320
I0417 21:54:39.068682 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 768
I0417 21:54:39.068913 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 768
INFO:tensorflow:Running non-virtual train step
I0417 21:54:39.075828 139882283599616 training.py:940] Running non-virtual train step
I0417 21:54:48.272761 139907979052864 keras_utils.py:163] TimeHistory: 9.20 seconds, 83.44 examples/second between steps 320 and 321
I0417 21:54:48.774979 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1530.16 examples/second between steps 321 and 322
I0417 21:54:49.271474 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1547.75 examples/second between steps 322 and 323
I0417 21:54:49.769592 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1542.70 examples/second between steps 323 and 324
I0417 21:54:50.273281 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1525.61 examples/second between steps 324 and 325
I0417 21:54:50.770184 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1546.58 examples/second between steps 325 and 326
I0417 21:54:51.265447 139907979052864 keras_utils.py:163] TimeHistory: 0.49 seconds, 1551.67 examples/second between steps 326 and 327
I0417 21:54:51.763014 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1544.53 examples/second between steps 327 and 328
I0417 21:54:52.263558 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1535.20 examples/second between steps 328 and 329
I0417 21:54:52.766463 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1528.03 examples/second between steps 329 and 330
I0417 21:54:53.268068 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1531.97 examples/second between steps 330 and 331
I0417 21:54:53.769209 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1533.36 examples/second between steps 331 and 332
I0417 21:54:54.267339 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1542.77 examples/second between steps 332 and 333
I0417 21:54:54.770056 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1528.63 examples/second between steps 333 and 334
I0417 21:54:55.271725 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1531.98 examples/second between steps 334 and 335
I0417 21:54:55.770754 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1539.97 examples/second between steps 335 and 336
I0417 21:54:56.269691 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1540.20 examples/second between steps 336 and 337
I0417 21:54:56.774650 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1521.87 examples/second between steps 337 and 338
I0417 21:54:57.274426 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1537.62 examples/second between steps 338 and 339
I0417 21:54:57.774609 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 1536.31 examples/second between steps 339 and 340
I0417 21:54:57.775192 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 1024
I0417 21:54:57.775415 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 1024
INFO:tensorflow:Running non-virtual train step
I0417 21:54:57.782162 139882258953984 training.py:940] Running non-virtual train step
I0417 21:55:07.364325 139907979052864 keras_utils.py:163] TimeHistory: 9.59 seconds, 106.79 examples/second between steps 340 and 341
I0417 21:55:07.864646 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 2048.01 examples/second between steps 341 and 342
I0417 21:55:08.364517 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 2049.88 examples/second between steps 342 and 343
I0417 21:55:08.863286 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 2054.47 examples/second between steps 343 and 344
I0417 21:55:09.354041 139907979052864 keras_utils.py:163] TimeHistory: 0.49 seconds, 2087.91 examples/second between steps 344 and 345
I0417 21:55:09.855723 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 2042.50 examples/second between steps 345 and 346
I0417 21:55:10.357058 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 2043.98 examples/second between steps 346 and 347
I0417 21:55:10.852523 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 2068.42 examples/second between steps 347 and 348
I0417 21:55:11.349948 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 2060.13 examples/second between steps 348 and 349
I0417 21:55:11.847670 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 2058.75 examples/second between steps 349 and 350
I0417 21:55:12.352619 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 2029.12 examples/second between steps 350 and 351
I0417 21:55:12.852523 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 2049.58 examples/second between steps 351 and 352
I0417 21:55:13.358171 139907979052864 keras_utils.py:163] TimeHistory: 0.51 seconds, 2026.28 examples/second between steps 352 and 353
I0417 21:55:13.848625 139907979052864 keras_utils.py:163] TimeHistory: 0.49 seconds, 2089.49 examples/second between steps 353 and 354
I0417 21:55:14.351139 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 2039.16 examples/second between steps 354 and 355
I0417 21:55:14.848743 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 2059.20 examples/second between steps 355 and 356
I0417 21:55:15.351450 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 2038.24 examples/second between steps 356 and 357
I0417 21:55:15.852880 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 2043.36 examples/second between steps 357 and 358
I0417 21:55:16.356413 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 2034.88 examples/second between steps 358 and 359
I0417 21:55:16.849952 139907979052864 keras_utils.py:163] TimeHistory: 0.49 seconds, 2076.21 examples/second between steps 359 and 360
I0417 21:55:16.850566 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 1536
I0417 21:55:16.850780 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 1536
INFO:tensorflow:Running non-virtual train step
I0417 21:55:16.858026 139882234046208 training.py:940] Running non-virtual train step
I0417 21:55:25.672418 139907979052864 keras_utils.py:163] TimeHistory: 8.82 seconds, 174.12 examples/second between steps 360 and 361
I0417 21:55:26.170596 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 3085.61 examples/second between steps 361 and 362
I0417 21:55:26.672097 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 3064.86 examples/second between steps 362 and 363
I0417 21:55:27.170559 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 3083.52 examples/second between steps 363 and 364
I0417 21:55:27.675122 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 3046.20 examples/second between steps 364 and 365
I0417 21:55:28.177033 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 3062.44 examples/second between steps 365 and 366
I0417 21:55:28.673930 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 3093.30 examples/second between steps 366 and 367
I0417 21:55:29.174137 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 3072.78 examples/second between steps 367 and 368
I0417 21:55:29.672438 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 3084.39 examples/second between steps 368 and 369
I0417 21:55:30.174045 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 3064.02 examples/second between steps 369 and 370
I0417 21:55:30.674432 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 3071.34 examples/second between steps 370 and 371
I0417 21:55:31.165773 139907979052864 keras_utils.py:163] TimeHistory: 0.49 seconds, 3128.05 examples/second between steps 371 and 372
I0417 21:55:31.662283 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 3095.46 examples/second between steps 372 and 373
I0417 21:55:32.154122 139907979052864 keras_utils.py:163] TimeHistory: 0.49 seconds, 3124.92 examples/second between steps 373 and 374
I0417 21:55:32.657433 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 3053.64 examples/second between steps 374 and 375
I0417 21:55:33.155099 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 3088.28 examples/second between steps 375 and 376
I0417 21:55:33.653417 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 3084.27 examples/second between steps 376 and 377
I0417 21:55:34.137320 139907979052864 keras_utils.py:163] TimeHistory: 0.48 seconds, 3176.40 examples/second between steps 377 and 378
I0417 21:55:34.640156 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 3057.14 examples/second between steps 378 and 379
I0417 21:55:35.145220 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 3043.14 examples/second between steps 379 and 380
I0417 21:55:35.145949 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 2048
I0417 21:55:35.146214 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 2048
INFO:tensorflow:Running non-virtual train step
I0417 21:55:35.153464 139882209138432 training.py:940] Running non-virtual train step
I0417 21:55:43.841126 139907979052864 keras_utils.py:163] TimeHistory: 8.69 seconds, 235.54 examples/second between steps 380 and 381
I0417 21:55:44.340893 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 4100.78 examples/second between steps 381 and 382
I0417 21:55:44.836739 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 4133.04 examples/second between steps 382 and 383
I0417 21:55:45.339140 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 4078.76 examples/second between steps 383 and 384
I0417 21:55:45.837427 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 4112.69 examples/second between steps 384 and 385
I0417 21:55:46.342235 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 4059.41 examples/second between steps 385 and 386
I0417 21:55:46.843918 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 4084.62 examples/second between steps 386 and 387
I0417 21:55:47.348868 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 4058.38 examples/second between steps 387 and 388
I0417 21:55:47.846166 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 4120.77 examples/second between steps 388 and 389
I0417 21:55:48.350560 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 4062.77 examples/second between steps 389 and 390
I0417 21:55:48.857229 139907979052864 keras_utils.py:163] TimeHistory: 0.51 seconds, 4044.47 examples/second between steps 390 and 391
I0417 21:55:49.356543 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 4104.22 examples/second between steps 391 and 392
I0417 21:55:49.857231 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 4092.79 examples/second between steps 392 and 393
I0417 21:55:50.360707 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 4070.32 examples/second between steps 393 and 394
I0417 21:55:50.862071 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 4087.47 examples/second between steps 394 and 395
I0417 21:55:51.364374 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 4079.53 examples/second between steps 395 and 396
I0417 21:55:51.868368 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 4066.18 examples/second between steps 396 and 397
I0417 21:55:52.373684 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 4055.60 examples/second between steps 397 and 398
I0417 21:55:52.866577 139907979052864 keras_utils.py:163] TimeHistory: 0.49 seconds, 4157.86 examples/second between steps 398 and 399
I0417 21:55:53.368177 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 4085.57 examples/second between steps 399 and 400
I0417 21:55:53.368884 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 3072
I0417 21:55:53.369156 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 3072
INFO:tensorflow:Running non-virtual train step
I0417 21:55:53.375897 139882184230656 training.py:940] Running non-virtual train step
I0417 21:56:01.970428 139907979052864 keras_utils.py:163] TimeHistory: 8.60 seconds, 357.16 examples/second between steps 400 and 401
I0417 21:56:02.473198 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 6114.95 examples/second between steps 401 and 402
I0417 21:56:02.973748 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 6141.49 examples/second between steps 402 and 403
I0417 21:56:03.457983 139907979052864 keras_utils.py:163] TimeHistory: 0.48 seconds, 6348.16 examples/second between steps 403 and 404
I0417 21:56:03.957261 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 6157.99 examples/second between steps 404 and 405
I0417 21:56:04.459404 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 6122.41 examples/second between steps 405 and 406
I0417 21:56:04.933364 139907979052864 keras_utils.py:163] TimeHistory: 0.47 seconds, 6485.67 examples/second between steps 406 and 407
I0417 21:56:05.433233 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 6149.25 examples/second between steps 407 and 408
I0417 21:56:05.931146 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 6173.31 examples/second between steps 408 and 409
I0417 21:56:06.418045 139907979052864 keras_utils.py:163] TimeHistory: 0.49 seconds, 6313.34 examples/second between steps 409 and 410
I0417 21:56:06.915136 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 6184.26 examples/second between steps 410 and 411
I0417 21:56:07.414385 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 6156.90 examples/second between steps 411 and 412
I0417 21:56:07.915461 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 6134.55 examples/second between steps 412 and 413
I0417 21:56:08.415714 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 6144.64 examples/second between steps 413 and 414
I0417 21:56:08.918838 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 6109.56 examples/second between steps 414 and 415
I0417 21:56:09.424941 139907979052864 keras_utils.py:163] TimeHistory: 0.51 seconds, 6073.59 examples/second between steps 415 and 416
I0417 21:56:09.927950 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 6110.81 examples/second between steps 416 and 417
I0417 21:56:10.430328 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 6118.56 examples/second between steps 417 and 418
I0417 21:56:10.928814 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 6166.46 examples/second between steps 418 and 419
I0417 21:56:11.433412 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 6091.83 examples/second between steps 419 and 420
I0417 21:56:11.434085 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 4096
I0417 21:56:11.434283 139907979052864 training.py:1298] Heterogeneous profiling: now profiling batch size 4096
INFO:tensorflow:Running non-virtual train step
I0417 21:56:11.440643 139882159322880 training.py:940] Running non-virtual train step
I0417 21:56:19.793154 139907979052864 keras_utils.py:163] TimeHistory: 8.36 seconds, 490.02 examples/second between steps 420 and 421
I0417 21:56:20.289141 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8263.68 examples/second between steps 421 and 422
I0417 21:56:20.787365 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8226.65 examples/second between steps 422 and 423
I0417 21:56:21.288068 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8185.73 examples/second between steps 423 and 424
I0417 21:56:21.787327 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8209.74 examples/second between steps 424 and 425
I0417 21:56:22.284342 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8245.94 examples/second between steps 425 and 426
I0417 21:56:22.787024 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8153.18 examples/second between steps 426 and 427
I0417 21:56:23.290868 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8133.90 examples/second between steps 427 and 428
I0417 21:56:23.789136 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8225.24 examples/second between steps 428 and 429
I0417 21:56:24.287614 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8221.71 examples/second between steps 429 and 430
I0417 21:56:24.778313 139907979052864 keras_utils.py:163] TimeHistory: 0.49 seconds, 8351.94 examples/second between steps 430 and 431
I0417 21:56:25.276904 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8219.74 examples/second between steps 431 and 432
I0417 21:56:25.774784 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8231.67 examples/second between steps 432 and 433
I0417 21:56:26.274618 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8199.39 examples/second between steps 433 and 434
I0417 21:56:26.773659 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8212.79 examples/second between steps 434 and 435
I0417 21:56:27.269717 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8262.25 examples/second between steps 435 and 436
I0417 21:56:27.768978 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8208.73 examples/second between steps 436 and 437
I0417 21:56:28.270907 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8165.00 examples/second between steps 437 and 438
I0417 21:56:28.770452 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8204.03 examples/second between steps 438 and 439
I0417 21:56:29.274315 139907979052864 keras_utils.py:163] TimeHistory: 0.50 seconds, 8133.85 examples/second between steps 439 and 440
I0417 21:56:29.275774 139907979052864 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696240554/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling complete
I0417 21:56:29.276053 139907979052864 training.py:1295] Heterogeneous profiling complete
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
inputs (InputLayer)             [(None, None)]       0                                            
__________________________________________________________________________________________________
targets (InputLayer)            [(None, None)]       0                                            
__________________________________________________________________________________________________
transformer_v2 (Transformer)    (None, None, 33945)  211047424   inputs[0][0]                     
                                                                 targets[0][0]                    
__________________________________________________________________________________________________
logits (Lambda)                 (None, None, 33945)  0           transformer_v2[0][0]             
__________________________________________________________________________________________________
tf.compat.v1.shape (TFOpLambda) (3,)                 0           logits[0][0]                     
__________________________________________________________________________________________________
tf.compat.v1.shape_1 (TFOpLambd (2,)                 0           targets[0][0]                    
__________________________________________________________________________________________________
tf.__operators__.getitem (Slici ()                   0           tf.compat.v1.shape[0][0]         
__________________________________________________________________________________________________
tf.__operators__.getitem_1 (Sli ()                   0           tf.compat.v1.shape_1[0][0]       
__________________________________________________________________________________________________
tf.math.maximum (TFOpLambda)    ()                   0           tf.__operators__.getitem[0][0]   
                                                                 tf.__operators__.getitem_1[0][0] 
__________________________________________________________________________________________________
tf.math.subtract_1 (TFOpLambda) ()                   0           tf.math.maximum[0][0]            
                                                                 tf.__operators__.getitem_1[0][0] 
__________________________________________________________________________________________________
tf.compat.v1.pad_1 (TFOpLambda) (None, None)         0           targets[0][0]                    
                                                                 tf.math.subtract_1[0][0]         
__________________________________________________________________________________________________
tf.cast (TFOpLambda)            (None, None)         0           tf.compat.v1.pad_1[0][0]         
__________________________________________________________________________________________________
tf.math.subtract (TFOpLambda)   ()                   0           tf.math.maximum[0][0]            
                                                                 tf.__operators__.getitem[0][0]   
__________________________________________________________________________________________________
tf.one_hot (TFOpLambda)         (None, None, 33945)  0           tf.cast[0][0]                    
__________________________________________________________________________________________________
tf.compat.v1.pad (TFOpLambda)   (None, None, 33945)  0           logits[0][0]                     
                                                                 tf.math.subtract[0][0]           
__________________________________________________________________________________________________
tf.compat.v1.nn.softmax_cross_e (None, None)         0           tf.one_hot[0][0]                 
                                                                 tf.compat.v1.pad[0][0]           
__________________________________________________________________________________________________
tf.math.not_equal (TFOpLambda)  (None, None)         0           tf.compat.v1.pad_1[0][0]         
__________________________________________________________________________________________________
tf.math.subtract_2 (TFOpLambda) (None, None)         0           tf.compat.v1.nn.softmax_cross_ent
__________________________________________________________________________________________________
tf.cast_1 (TFOpLambda)          (None, None)         0           tf.math.not_equal[0][0]          
__________________________________________________________________________________________________
tf.math.multiply (TFOpLambda)   (None, None)         0           tf.math.subtract_2[0][0]         
                                                                 tf.cast_1[0][0]                  
__________________________________________________________________________________________________
tf.math.reduce_sum (TFOpLambda) ()                   0           tf.math.multiply[0][0]           
__________________________________________________________________________________________________
tf.math.reduce_sum_1 (TFOpLambd ()                   0           tf.cast_1[0][0]                  
__________________________________________________________________________________________________
tf.math.truediv (TFOpLambda)    ()                   0           tf.math.reduce_sum[0][0]         
                                                                 tf.math.reduce_sum_1[0][0]       
__________________________________________________________________________________________________
add_loss (AddLoss)              ()                   0           tf.math.truediv[0][0]            
==================================================================================================
Total params: 211,047,424
Trainable params: 211,047,424
Non-trainable params: 0
__________________________________________________________________________________________________
100000/100000 - 339s - loss: 7.5938
I0417 21:56:29.276859 139907979052864 transformer_main.py:369] Train history: {'loss': [7.593818187713623]}
I0417 21:56:29.276954 139907979052864 transformer_main.py:371] End train iteration at global step:100000
