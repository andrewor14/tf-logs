My commit is 46f9d67f Simulator: Refactor to compute job allocations once (/root/dev/models/deploy)

==========================================================================
My environment variables:
--------------------------------------------------------------------------
CUDNN_VERSION=7.6.2.24-1+cuda10.1
PMIX_ID=2915368961.0
BERT_CONFIG_FILE=/root/dev/dataset/bert/uncased_L-12_H-768_A-12/bert_config.json
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:
LD_LIBRARY_PATH=/usr/local/lib:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
OMPI_FIRST_RANKS=0
MPI_HOSTS=f69df1f52c58
OMPI_MCA_orte_top_session_dir=/tmp/ompi.f69df1f52c58.0
LOG_MEMORY_ENABLED=false
PMIX_SYSTEM_TMPDIR=/tmp
EVAL_BATCH_SIZE=48
OMPI_MCA_orte_num_nodes=1
OMPI_COMMAND=run_bert_glue.sh
MODEL=bert
LANG=C.UTF-8
HFI_NO_BACKTRACE=1
HOSTNAME=f69df1f52c58
OMPI_MCA_ess_base_vpid=0
OLDPWD=/root
OMPI_MCA_initial_wdir=/root/dev/models/deploy
ENVIRONMENT=docker
TF_DIR=/root/dev/tensorflow
USE_KERAS_COMPILE_FIT=true
DATA_DIR=/root/dev/dataset/bert/finetuning
HOST_FLAG=--host f69df1f52c58
OMPI_MCA_btl_tcp_if_exclude=lo,docker0,eth1
DTYPE=fp32
NUM_CHECKPOINTS_TO_KEEP=5
OMPI_COMM_WORLD_NODE_RANK=0
NVIDIA_VISIBLE_DEVICES=all
OMPI_MCA_orte_precondition_transports=44317931d49d4ab1-2a78de27449ee903
BASE_DIR=/root/dev
OMPI_MCA_orte_ess_node_rank=0
OMPI_MCA_shmem_RUNTIME_QUERY_hint=mmap
OMPI_COMM_WORLD_RANK=0
LOG_STEPS=1
PMIX_RANK=0
OMPI_FILE_LOCATION=/tmp/ompi.f69df1f52c58.0/pid.736/0/0
TRAIN_BATCH_SIZE=48
NCCL_VERSION=2.4.7-1+cuda10.1
OMPI_MCA_orte_local_daemon_uri=2915368960.0;tcp://10.0.1.2,172.18.0.3:51041
GLUE_TASK=SST-2
LEARNING_RATE=2e-5
HOROVOD_GPU_OPERATIONS=NCCL
PWD=/root/dev/models/deploy
NUM_GPUS_PER_NODE=8
HOME=/root
ENABLE_XLA=true
PMIX_SERVER_TMPDIR=/tmp/ompi.f69df1f52c58.0/pid.736
RUN_SCRIPT=run_bert_glue.sh
PMIX_PTL_MODULE=tcp,usock
IPATH_NO_BACKTRACE=1
JOB_NAME=bert-glue-04_17_21_1618695657343
OMPI_MCA_rmaps_base_oversubscribe=1
OMPI_MCA_orte_launch=1
CODE_DIR=/root/dev/models/official/nlp/bert
OMPI_MCA_orte_tmpdir_base=/tmp
LOG_DIR=/root/dev/logs
TIMESTAMP=04_17_21_1618695657384
MPI_HOST_FILE=/root/container_hosts/hosts.txt
NUM_VIRTUAL_NODES_PER_DEVICE=1
BERT_MODEL_NAME=uncased_L-12_H-768_A-12
OMPI_APP_CTX_NUM_PROCS=1
OMPI_MCA_orte_output_filename=/root/dev/logs/bert-glue-04_17_21_1618695657343
LOG_FILE=/dev/stderr
STEPS_PER_LOOP=1
MODELS_DIR=/root/dev/models
OMPI_MCA_orte_app_num=0
DISABLE_VIRTUAL_NODES=true
PMIX_MCA_mca_base_component_show_load_errors=1
NUM_NODES=1
OMPI_MCA_pml=ob1
PYTHON_COMMAND=/usr/bin/python3
IN_DOCKER_CONTAINER=true
BERT_MODEL_DIR=/root/dev/dataset/bert/uncased_L-12_H-768_A-12
NUM_EPOCHS=100000
PMIX_BFROP_BUFFER_TYPE=PMIX_BFROP_BUFFER_NON_DESC
MPI_HOME=/usr/local
CHECKPOINT_NAME=bert_model.ckpt
TERM=xterm
CUDA_PKG_VERSION=10-1=10.1.243-1
CUDA_VERSION=10.1.243
SKIP_EVAL=true
PMIX_DSTORE_ESH_BASE_PATH=/tmp/ompi.f69df1f52c58.0/pid.736/pmix_dstor_ds12_736
OMPI_MCA_hwloc_base_binding_policy=none
OMPI_MCA_rmaps_base_mapping_policy=node
PMIX_SERVER_URI3=2915368960.0;tcp4://127.0.0.1:57901
PMIX_SERVER_URI2=2915368960.0;tcp4://127.0.0.1:57901
NUM_STEPS=100000
OMPI_MCA_orte_hnp_uri=2915368960.0;tcp://10.0.1.2,172.18.0.3:51041
TRAIN_DIR=/root/dev/logs/bert-glue-04_17_21_1618695657343
OMPI_MCA_mpi_yield_when_idle=0
NVIDIA_DRIVER_CAPABILITIES=compute,utility
DEFAULT_NUM_GPUS_PER_NODE=8
ENABLE_CHECKPOINTS=false
DISTRIBUTION_STRATEGY=mirrored
OMPI_COMM_WORLD_LOCAL_SIZE=1
CUDA_VISIBLE_DEVICES=0
OMPI_COMM_WORLD_SIZE=1
SHLVL=3
PYTHONPATH=:/root/dev/models:/root/dev/models
OMPI_NUM_APP_CTX=1
NVIDIA_REQUIRE_CUDA=cuda>=10.1 brand=tesla,driver>=396,driver<397 brand=tesla,driver>=410,driver<411 brand=tesla,driver>=418,driver<419
OMPI_MCA_pmix=^s1,s2,cray,isolated
DEFAULT_DISTRIBUTION_STRATEGY=mirrored
PMIX_SERVER_URI21=2915368960.0;tcp4://127.0.0.1:57901
SAVED_CHECKPOINT_PATH=/root/dev/dataset/bert/uncased_L-12_H-768_A-12/bert_model.ckpt
PMIX_DSTORE_21_BASE_PATH=/tmp/ompi.f69df1f52c58.0/pid.736/pmix_dstor_ds21_736
ENABLE_MONITOR_MEMORY=false
ENABLE_HETEROGENEOUS_PROFILE=true
CUBLAS_VERSION=10.1.0.105-1
BATCH_SIZE=48
PATH=/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
PMIX_SECURITY_MODE=native
OMPI_MCA_ess=^singleton
NCCL_DEBUG=INFO
PMIX_NAMESPACE=2915368961
OMPI_MCA_orte_ess_num_procs=1
NCCL_SOCKET_IFNAME=^lo,docker0,eth1
OMPI_MCA_ess_base_jobid=2915368961
OMPI_COMM_WORLD_LOCAL_RANK=0
OMPI_UNIVERSE_SIZE=1
OMPI_MCA_orte_jobfam_session_dir=/tmp/ompi.f69df1f52c58.0/pid.736
DEFAULT_NUM_EPOCHS=1
PMIX_GDS_MODULE=ds21,ds12,hash
ENABLE_ELASTICITY=false
NUM_GPUS=1
OMPI_MCA_btl=^openib
_=/usr/bin/printenv
==========================================================================

2021-04-17 21:40:57.592775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
/usr/local/lib/python3.6/dist-packages/absl/flags/_validators.py:356: UserWarning: Flag --model_dir has a non-None default value; therefore, mark_flag_as_required will pass even if flag is not specified in the command line!
  'command line!' % flag_name)
I0417 21:40:59.661956 140147223390016 virtual_helper.py:221] Setting TF_CONFIG to {"cluster": {"worker": ["f69df1f52c58:2222"]}, "task": {"type": "worker", "index": 0}}
INFO:tensorflow:Initializing local devices since in-graph multi-worker training with `MirroredStrategy` is not supported in eager mode. TF_CONFIG will be ignored when when initializing `MirroredStrategy`.
I0417 21:40:59.663688 140147223390016 mirrored_strategy.py:306] Initializing local devices since in-graph multi-worker training with `MirroredStrategy` is not supported in eager mode. TF_CONFIG will be ignored when when initializing `MirroredStrategy`.
2021-04-17 21:40:59.663941: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-17 21:40:59.664016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-17 21:40:59.702524: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:40:59.702894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.75GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-17 21:40:59.702916: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-17 21:40:59.704744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-04-17 21:40:59.704807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-04-17 21:40:59.706604: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-17 21:40:59.706934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-17 21:40:59.708870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-17 21:40:59.710045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-04-17 21:40:59.713985: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-04-17 21:40:59.714116: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:40:59.714506: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:40:59.714826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-17 21:40:59.715182: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-17 21:40:59.715754: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-17 21:40:59.715936: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:40:59.716316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.75GiB deviceMemoryBandwidth: 836.37GiB/s
2021-04-17 21:40:59.716338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-17 21:40:59.716366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-04-17 21:40:59.716394: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-04-17 21:40:59.716407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-17 21:40:59.716428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-17 21:40:59.716440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-17 21:40:59.716452: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-04-17 21:40:59.716478: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-04-17 21:40:59.716558: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:40:59.716937: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:40:59.717253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-17 21:40:59.717284: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-17 21:41:00.448877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-17 21:41:00.448943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-17 21:41:00.448952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-17 21:41:00.449209: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:41:00.450312: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:41:00.450692: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:41:00.451042: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14677 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:00:04.0, compute capability: 7.0)
INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
I0417 21:41:00.453795 140147223390016 mirrored_strategy.py:350] Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
2021-04-17 21:41:00.456570: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-17 21:41:00.456596: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-17 21:41:00.456621: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-04-17 21:41:00.457519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so.10.1
2021-04-17 21:41:00.557942: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1415] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI_ERROR_INSUFFICIENT_PRIVILEGES
2021-04-17 21:41:00.558007: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
I0417 21:41:00.558131 140147223390016 run_classifier.py:187] Training using TF 2.x Keras compile/fit API with distribution strategy.
I0417 21:41:03.428213 140147223390016 optimization.py:89] using Adamw optimizer
I0417 21:41:03.428500 140147223390016 optimization.py:142] gradient_clip_norm=1.000000
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:41:04.161129 140147223390016 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:41:04.162159 140147223390016 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:41:04.166073 140147223390016 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:41:04.166773 140147223390016 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
WARNING:tensorflow:The argument `steps_per_execution` is no longer experimental. Pass `steps_per_execution` instead of `experimental_steps_per_execution`.
W0417 21:41:04.167524 140147223390016 training.py:532] The argument `steps_per_execution` is no longer experimental. Pass `steps_per_execution` instead of `experimental_steps_per_execution`.
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:41:04.180306 140147223390016 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:41:04.181085 140147223390016 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:41:04.182398 140147223390016 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:41:04.183158 140147223390016 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2021-04-17 21:41:04.215065: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-17 21:41:04.215430: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2000155000 Hz
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 1
I0417 21:41:04.256559 140147223390016 training.py:1298] Heterogeneous profiling: now profiling batch size 1
INFO:tensorflow:Running non-virtual train step
I0417 21:41:04.304435 140141117024000 training.py:940] Running non-virtual train step
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:41:07.550372 140147223390016 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:41:07.552143 140147223390016 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Running non-virtual train step
I0417 21:41:08.993947 140141117024000 training.py:940] Running non-virtual train step
2021-04-17 21:41:15.296856: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f75100015d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-04-17 21:41:15.296903: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2021-04-17 21:41:15.419431: I tensorflow/compiler/jit/xla_compilation_cache.cc:333] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2021-04-17 21:41:16.886572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
Epoch 1/100000
     1/100000 [..............................] - ETA: 798:28:40 - loss: 0.4902 - accuracy: 1.0000I0417 21:41:33.002621 140147223390016 keras_utils.py:163] TimeHistory: 28.75 seconds, 0.03 examples/second between steps 0 and 1
2021-04-17 21:41:33.284095: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-17 21:41:33.284151: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-17 21:41:33.285106: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1415] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI_ERROR_INSUFFICIENT_PRIVILEGES
     2/100000 [..............................] - ETA: 36:18:40 - loss: 0.6019 - accuracy: 0.7500 I0417 21:41:34.309504 140147223390016 keras_utils.py:163] TimeHistory: 1.03 seconds, 0.98 examples/second between steps 1 and 2
2021-04-17 21:41:34.312206: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-04-17 21:41:34.330203: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 0 callback api events and 0 activity events. 
2021-04-17 21:41:34.337329: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-04-17 21:41:34.344415: I tensorflow/core/profiler/rpc/client/save_profile.cc:137] Creating directory: /root/dev/logs/bert-glue-04_17_21_1618695657343/summaries/train/plugins/profile/2021_04_17_21_41_34
2021-04-17 21:41:34.348028: I tensorflow/core/profiler/rpc/client/save_profile.cc:143] Dumped gzipped tool data for trace.json.gz to /root/dev/logs/bert-glue-04_17_21_1618695657343/summaries/train/plugins/profile/2021_04_17_21_41_34/f69df1f52c58.trace.json.gz
2021-04-17 21:41:34.384783: I tensorflow/core/profiler/rpc/client/save_profile.cc:137] Creating directory: /root/dev/logs/bert-glue-04_17_21_1618695657343/summaries/train/plugins/profile/2021_04_17_21_41_34
2021-04-17 21:41:34.391936: I tensorflow/core/profiler/rpc/client/save_profile.cc:143] Dumped gzipped tool data for memory_profile.json.gz to /root/dev/logs/bert-glue-04_17_21_1618695657343/summaries/train/plugins/profile/2021_04_17_21_41_34/f69df1f52c58.memory_profile.json.gz
2021-04-17 21:41:34.392499: I tensorflow/core/profiler/rpc/client/capture_profile.cc:251] Creating directory: /root/dev/logs/bert-glue-04_17_21_1618695657343/summaries/train/plugins/profile/2021_04_17_21_41_34Dumped tool data for xplane.pb to /root/dev/logs/bert-glue-04_17_21_1618695657343/summaries/train/plugins/profile/2021_04_17_21_41_34/f69df1f52c58.xplane.pb
Dumped tool data for overview_page.pb to /root/dev/logs/bert-glue-04_17_21_1618695657343/summaries/train/plugins/profile/2021_04_17_21_41_34/f69df1f52c58.overview_page.pb
Dumped tool data for input_pipeline.pb to /root/dev/logs/bert-glue-04_17_21_1618695657343/summaries/train/plugins/profile/2021_04_17_21_41_34/f69df1f52c58.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to /root/dev/logs/bert-glue-04_17_21_1618695657343/summaries/train/plugins/profile/2021_04_17_21_41_34/f69df1f52c58.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to /root/dev/logs/bert-glue-04_17_21_1618695657343/summaries/train/plugins/profile/2021_04_17_21_41_34/f69df1f52c58.kernel_stats.pb

     3/100000 [..............................] - ETA: 19:53:25 - loss: 0.6688 - accuracy: 0.6111I0417 21:41:34.434331 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 25.28 examples/second between steps 2 and 3
I0417 21:41:34.465890 140147223390016 keras_utils.py:163] TimeHistory: 0.03 seconds, 33.32 examples/second between steps 3 and 4
     5/100000 [..............................] - ETA: 10:25:41 - loss: 0.6998 - accuracy: 0.4967I0417 21:41:34.503868 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 27.30 examples/second between steps 4 and 5
I0417 21:41:34.540412 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 28.38 examples/second between steps 5 and 6
     7/100000 [..............................] - ETA: 7:17:35 - loss: 0.7155 - accuracy: 0.4636 I0417 21:41:34.577582 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 27.92 examples/second between steps 6 and 7
I0417 21:41:34.613731 140147223390016 keras_utils.py:163] TimeHistory: 0.03 seconds, 28.76 examples/second between steps 7 and 8
     9/100000 [..............................] - ETA: 5:43:21 - loss: 0.7241 - accuracy: 0.4516I0417 21:41:34.650377 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 28.39 examples/second between steps 8 and 9
I0417 21:41:34.686819 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 28.48 examples/second between steps 9 and 10
    11/100000 [..............................] - ETA: 4:46:49 - loss: 0.7288 - accuracy: 0.4389I0417 21:41:34.723295 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 28.43 examples/second between steps 10 and 11
    12/100000 [..............................] - ETA: 47:48:42 - loss: 0.7315 - accuracy: 0.4301I0417 21:41:51.938182 140147223390016 keras_utils.py:163] TimeHistory: 17.21 seconds, 0.06 examples/second between steps 11 and 12
I0417 21:41:51.977569 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 27.10 examples/second between steps 12 and 13
    14/100000 [..............................] - ETA: 40:37:41 - loss: 0.7343 - accuracy: 0.4217I0417 21:41:52.018907 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 25.29 examples/second between steps 13 and 14
I0417 21:41:52.052002 140147223390016 keras_utils.py:163] TimeHistory: 0.03 seconds, 31.94 examples/second between steps 14 and 15
    16/100000 [..............................] - ETA: 66:34:12 - loss: 0.7345 - accuracy: 0.4213I0417 21:42:08.955990 140147223390016 keras_utils.py:163] TimeHistory: 16.90 seconds, 0.06 examples/second between steps 15 and 16
I0417 21:42:09.000239 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 23.89 examples/second between steps 16 and 17
    18/100000 [..............................] - ETA: 58:52:26 - loss: 0.7331 - accuracy: 0.4284I0417 21:42:09.039605 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 26.45 examples/second between steps 17 and 18
    19/100000 [..............................] - ETA: 81:07:38 - loss: 0.7322 - accuracy: 0.4336I0417 21:42:25.582866 140147223390016 keras_utils.py:163] TimeHistory: 16.54 seconds, 0.06 examples/second between steps 18 and 19
I0417 21:42:25.627085 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 23.93 examples/second between steps 19 and 20
I0417 21:42:25.629325 140147223390016 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695657343/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 2
I0417 21:42:25.629575 140147223390016 training.py:1298] Heterogeneous profiling: now profiling batch size 2
INFO:tensorflow:Running non-virtual train step
I0417 21:42:25.641119 140141016377088 training.py:940] Running non-virtual train step
    21/100000 [..............................] - ETA: 107:46:37 - loss: 0.7312 - accuracy: 0.4399I0417 21:42:50.618224 140147223390016 keras_utils.py:163] TimeHistory: 24.99 seconds, 0.08 examples/second between steps 20 and 21
    22/100000 [..............................] - ETA: 104:00:32 - loss: 0.7309 - accuracy: 0.4426I0417 21:42:51.650403 140147223390016 keras_utils.py:163] TimeHistory: 1.03 seconds, 1.94 examples/second between steps 21 and 22
I0417 21:42:51.699548 140147223390016 keras_utils.py:163] TimeHistory: 0.05 seconds, 42.18 examples/second between steps 22 and 23
    24/100000 [..............................] - ETA: 95:04:45 - loss: 0.7297 - accuracy: 0.4474 I0417 21:42:51.746687 140147223390016 keras_utils.py:163] TimeHistory: 0.05 seconds, 43.73 examples/second between steps 23 and 24
I0417 21:42:51.793760 140147223390016 keras_utils.py:163] TimeHistory: 0.05 seconds, 43.75 examples/second between steps 24 and 25
    26/100000 [..............................] - ETA: 87:34:35 - loss: 0.7289 - accuracy: 0.4515I0417 21:42:51.841657 140147223390016 keras_utils.py:163] TimeHistory: 0.05 seconds, 42.92 examples/second between steps 25 and 26
I0417 21:42:51.887711 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 45.06 examples/second between steps 26 and 27
    28/100000 [..............................] - ETA: 81:10:54 - loss: 0.7279 - accuracy: 0.4539I0417 21:42:51.932991 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 45.72 examples/second between steps 27 and 28
I0417 21:42:51.978106 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 45.68 examples/second between steps 28 and 29
    30/100000 [..............................] - ETA: 75:40:03 - loss: 0.7279 - accuracy: 0.4536I0417 21:42:52.022820 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 46.16 examples/second between steps 29 and 30
    31/100000 [..............................] - ETA: 89:54:14 - loss: 0.7276 - accuracy: 0.4543I0417 21:43:10.128932 140147223390016 keras_utils.py:163] TimeHistory: 18.10 seconds, 0.11 examples/second between steps 30 and 31
    32/100000 [..............................] - ETA: 87:02:52 - loss: 0.7270 - accuracy: 0.4557I0417 21:43:10.178715 140147223390016 keras_utils.py:163] TimeHistory: 0.05 seconds, 42.78 examples/second between steps 31 and 32
I0417 21:43:10.224203 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 45.52 examples/second between steps 32 and 33
    34/100000 [..............................] - ETA: 81:50:46 - loss: 0.7257 - accuracy: 0.4596I0417 21:43:10.268627 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 46.56 examples/second between steps 33 and 34
I0417 21:43:10.313506 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 46.13 examples/second between steps 34 and 35
    36/100000 [..............................] - ETA: 77:14:03 - loss: 0.7243 - accuracy: 0.4640I0417 21:43:10.352318 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 53.47 examples/second between steps 35 and 36
I0417 21:43:10.396371 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 46.90 examples/second between steps 36 and 37
    38/100000 [..............................] - ETA: 73:07:26 - loss: 0.7229 - accuracy: 0.4683I0417 21:43:10.440585 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 46.78 examples/second between steps 37 and 38
I0417 21:43:10.485072 140147223390016 keras_utils.py:163] TimeHistory: 0.04 seconds, 46.67 examples/second between steps 38 and 39
    40/100000 [..............................] - ETA: 82:26:43 - loss: 0.7217 - accuracy: 0.4716I0417 21:43:28.802177 140147223390016 keras_utils.py:163] TimeHistory: 18.32 seconds, 0.11 examples/second between steps 39 and 40
I0417 21:43:28.805209 140147223390016 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695657343/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 4
I0417 21:43:28.805497 140147223390016 training.py:1298] Heterogeneous profiling: now profiling batch size 4
INFO:tensorflow:Running non-virtual train step
I0417 21:43:28.814890 140141007984384 training.py:940] Running non-virtual train step
    41/100000 [..............................] - ETA: 98:07:50 - loss: 0.7212 - accuracy: 0.4730I0417 21:43:54.368511 140147223390016 keras_utils.py:163] TimeHistory: 25.56 seconds, 0.16 examples/second between steps 40 and 41
    42/100000 [..............................] - ETA: 96:27:15 - loss: 0.7207 - accuracy: 0.4740I0417 21:43:55.428521 140147223390016 keras_utils.py:163] TimeHistory: 1.06 seconds, 3.78 examples/second between steps 41 and 42
    43/100000 [..............................] - ETA: 94:11:43 - loss: 0.7202 - accuracy: 0.4756I0417 21:43:55.486854 140147223390016 keras_utils.py:163] TimeHistory: 0.06 seconds, 70.55 examples/second between steps 42 and 43
    44/100000 [..............................] - ETA: 92:02:27 - loss: 0.7197 - accuracy: 0.4774I0417 21:43:55.544461 140147223390016 keras_utils.py:163] TimeHistory: 0.06 seconds, 71.14 examples/second between steps 43 and 44
    45/100000 [..............................] - ETA: 89:59:02 - loss: 0.7193 - accuracy: 0.4790I0417 21:43:55.600886 140147223390016 keras_utils.py:163] TimeHistory: 0.05 seconds, 72.77 examples/second between steps 44 and 45
    46/100000 [..............................] - ETA: 99:21:39 - loss: 0.7190 - accuracy: 0.4802I0417 21:44:14.041258 140147223390016 keras_utils.py:163] TimeHistory: 18.44 seconds, 0.22 examples/second between steps 45 and 46
    47/100000 [..............................] - ETA: 97:14:26 - loss: 0.7186 - accuracy: 0.4816I0417 21:44:14.108269 140147223390016 keras_utils.py:163] TimeHistory: 0.06 seconds, 62.32 examples/second between steps 46 and 47
    48/100000 [..............................] - ETA: 95:12:28 - loss: 0.7184 - accuracy: 0.4827I0417 21:44:14.171166 140147223390016 keras_utils.py:163] TimeHistory: 0.06 seconds, 65.15 examples/second between steps 47 and 48
    49/100000 [..............................] - ETA: 93:15:33 - loss: 0.7182 - accuracy: 0.4837I0417 21:44:14.233415 140147223390016 keras_utils.py:163] TimeHistory: 0.06 seconds, 65.72 examples/second between steps 48 and 49
    50/100000 [..............................] - ETA: 91:23:26 - loss: 0.7181 - accuracy: 0.4844I0417 21:44:14.296058 140147223390016 keras_utils.py:163] TimeHistory: 0.06 seconds, 65.26 examples/second between steps 49 and 50
    51/100000 [..............................] - ETA: 99:55:11 - loss: 0.7181 - accuracy: 0.4847I0417 21:44:32.949871 140147223390016 keras_utils.py:163] TimeHistory: 18.65 seconds, 0.21 examples/second between steps 50 and 51
    52/100000 [..............................] - ETA: 97:59:39 - loss: 0.7181 - accuracy: 0.4848I0417 21:44:33.013303 140147223390016 keras_utils.py:163] TimeHistory: 0.06 seconds, 65.92 examples/second between steps 51 and 52
    53/100000 [..............................] - ETA: 96:08:12 - loss: 0.7181 - accuracy: 0.4851I0417 21:44:33.065499 140147223390016 keras_utils.py:163] TimeHistory: 0.05 seconds, 78.92 examples/second between steps 52 and 53
    54/100000 [..............................] - ETA: 94:21:07 - loss: 0.7181 - accuracy: 0.4852I0417 21:44:33.122982 140147223390016 keras_utils.py:163] TimeHistory: 0.06 seconds, 71.46 examples/second between steps 53 and 54
    55/100000 [..............................] - ETA: 92:38:00 - loss: 0.7181 - accuracy: 0.4853I0417 21:44:33.180579 140147223390016 keras_utils.py:163] TimeHistory: 0.06 seconds, 71.24 examples/second between steps 54 and 55
    56/100000 [..............................] - ETA: 90:58:39 - loss: 0.7181 - accuracy: 0.4853I0417 21:44:33.238720 140147223390016 keras_utils.py:163] TimeHistory: 0.06 seconds, 70.87 examples/second between steps 55 and 56
    57/100000 [..............................] - ETA: 89:22:49 - loss: 0.7181 - accuracy: 0.4856I0417 21:44:33.295617 140147223390016 keras_utils.py:163] TimeHistory: 0.06 seconds, 71.97 examples/second between steps 56 and 57
    58/100000 [..............................] - ETA: 87:50:20 - loss: 0.7180 - accuracy: 0.4858I0417 21:44:33.352671 140147223390016 keras_utils.py:163] TimeHistory: 0.06 seconds, 71.98 examples/second between steps 57 and 58
    59/100000 [..............................] - ETA: 86:21:03 - loss: 0.7179 - accuracy: 0.4863I0417 21:44:33.409265 140147223390016 keras_utils.py:163] TimeHistory: 0.06 seconds, 72.44 examples/second between steps 58 and 59
    60/100000 [..............................] - ETA: 93:32:59 - loss: 0.7177 - accuracy: 0.4868I0417 21:44:51.821801 140147223390016 keras_utils.py:163] TimeHistory: 18.41 seconds, 0.22 examples/second between steps 59 and 60
I0417 21:44:51.824837 140147223390016 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695657343/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 8
I0417 21:44:51.825116 140147223390016 training.py:1298] Heterogeneous profiling: now profiling batch size 8
INFO:tensorflow:Running non-virtual train step
I0417 21:44:51.834320 140140986746624 training.py:940] Running non-virtual train step
    61/100000 [..............................] - ETA: 104:10:07 - loss: 0.7176 - accuracy: 0.4873I0417 21:45:18.144415 140147223390016 keras_utils.py:163] TimeHistory: 26.32 seconds, 0.30 examples/second between steps 60 and 61
    62/100000 [..............................] - ETA: 103:00:56 - loss: 0.7174 - accuracy: 0.4879I0417 21:45:19.364826 140147223390016 keras_utils.py:163] TimeHistory: 1.22 seconds, 6.57 examples/second between steps 61 and 62
    63/100000 [..............................] - ETA: 101:23:30 - loss: 0.7171 - accuracy: 0.4888I0417 21:45:19.451055 140147223390016 keras_utils.py:163] TimeHistory: 0.08 seconds, 94.67 examples/second between steps 62 and 63
    64/100000 [..............................] - ETA: 99:49:12 - loss: 0.7168 - accuracy: 0.4898 I0417 21:45:19.538978 140147223390016 keras_utils.py:163] TimeHistory: 0.09 seconds, 92.50 examples/second between steps 63 and 64
    65/100000 [..............................] - ETA: 98:17:49 - loss: 0.7165 - accuracy: 0.4909I0417 21:45:19.625669 140147223390016 keras_utils.py:163] TimeHistory: 0.08 seconds, 94.13 examples/second between steps 64 and 65
    66/100000 [..............................] - ETA: 104:56:25 - loss: 0.7161 - accuracy: 0.4920I0417 21:45:38.725205 140147223390016 keras_utils.py:163] TimeHistory: 19.10 seconds, 0.42 examples/second between steps 65 and 66
    67/100000 [..............................] - ETA: 103:23:21 - loss: 0.7158 - accuracy: 0.4930I0417 21:45:38.819584 140147223390016 keras_utils.py:163] TimeHistory: 0.09 seconds, 87.37 examples/second between steps 66 and 67
    68/100000 [..............................] - ETA: 101:52:56 - loss: 0.7155 - accuracy: 0.4941I0417 21:45:38.909450 140147223390016 keras_utils.py:163] TimeHistory: 0.09 seconds, 90.64 examples/second between steps 67 and 68
    69/100000 [..............................] - ETA: 100:25:06 - loss: 0.7152 - accuracy: 0.4950I0417 21:45:38.996449 140147223390016 keras_utils.py:163] TimeHistory: 0.09 seconds, 93.60 examples/second between steps 68 and 69
    70/100000 [..............................] - ETA: 98:59:48 - loss: 0.7149 - accuracy: 0.4960 I0417 21:45:39.082769 140147223390016 keras_utils.py:163] TimeHistory: 0.08 seconds, 94.43 examples/second between steps 69 and 70
    71/100000 [..............................] - ETA: 97:36:35 - loss: 0.7146 - accuracy: 0.4969I0417 21:45:39.153718 140147223390016 keras_utils.py:163] TimeHistory: 0.07 seconds, 115.23 examples/second between steps 70 and 71
    72/100000 [..............................] - ETA: 96:16:03 - loss: 0.7143 - accuracy: 0.4977I0417 21:45:39.239524 140147223390016 keras_utils.py:163] TimeHistory: 0.08 seconds, 94.79 examples/second between steps 71 and 72
    73/100000 [..............................] - ETA: 94:57:46 - loss: 0.7141 - accuracy: 0.4985I0417 21:45:39.325917 140147223390016 keras_utils.py:163] TimeHistory: 0.08 seconds, 94.19 examples/second between steps 72 and 73
    74/100000 [..............................] - ETA: 100:59:17 - loss: 0.7139 - accuracy: 0.4992I0417 21:45:58.595771 140147223390016 keras_utils.py:163] TimeHistory: 19.27 seconds, 0.42 examples/second between steps 73 and 74
    75/100000 [..............................] - ETA: 99:39:23 - loss: 0.7136 - accuracy: 0.5000 I0417 21:45:58.686464 140147223390016 keras_utils.py:163] TimeHistory: 0.09 seconds, 90.88 examples/second between steps 74 and 75
    76/100000 [..............................] - ETA: 98:21:32 - loss: 0.7134 - accuracy: 0.5007I0417 21:45:58.773748 140147223390016 keras_utils.py:163] TimeHistory: 0.09 seconds, 93.26 examples/second between steps 75 and 76
    77/100000 [..............................] - ETA: 97:05:44 - loss: 0.7131 - accuracy: 0.5015I0417 21:45:58.860660 140147223390016 keras_utils.py:163] TimeHistory: 0.09 seconds, 94.03 examples/second between steps 76 and 77
    78/100000 [..............................] - ETA: 95:51:52 - loss: 0.7129 - accuracy: 0.5023I0417 21:45:58.946564 140147223390016 keras_utils.py:163] TimeHistory: 0.08 seconds, 94.78 examples/second between steps 77 and 78
    79/100000 [..............................] - ETA: 94:39:55 - loss: 0.7126 - accuracy: 0.5031I0417 21:45:59.032647 140147223390016 keras_utils.py:163] TimeHistory: 0.08 seconds, 94.62 examples/second between steps 78 and 79
    80/100000 [..............................] - ETA: 93:29:47 - loss: 0.7123 - accuracy: 0.5040I0417 21:45:59.118975 140147223390016 keras_utils.py:163] TimeHistory: 0.08 seconds, 94.37 examples/second between steps 79 and 80
I0417 21:45:59.120924 140147223390016 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695657343/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 12
I0417 21:45:59.121129 140147223390016 training.py:1298] Heterogeneous profiling: now profiling batch size 12
INFO:tensorflow:Running non-virtual train step
I0417 21:45:59.129765 140124337030912 training.py:940] Running non-virtual train step
    81/100000 [..............................] - ETA: 101:49:27 - loss: 0.7120 - accuracy: 0.5048I0417 21:46:26.494194 140147223390016 keras_utils.py:163] TimeHistory: 27.37 seconds, 0.44 examples/second between steps 80 and 81
    82/100000 [..............................] - ETA: 100:59:55 - loss: 0.7117 - accuracy: 0.5057I0417 21:46:27.756406 140147223390016 keras_utils.py:163] TimeHistory: 1.26 seconds, 9.53 examples/second between steps 81 and 82
    83/100000 [..............................] - ETA: 99:48:23 - loss: 0.7114 - accuracy: 0.5065 I0417 21:46:27.876147 140147223390016 keras_utils.py:163] TimeHistory: 0.12 seconds, 101.67 examples/second between steps 82 and 83
    84/100000 [..............................] - ETA: 98:38:31 - loss: 0.7111 - accuracy: 0.5074I0417 21:46:27.992563 140147223390016 keras_utils.py:163] TimeHistory: 0.11 seconds, 104.47 examples/second between steps 83 and 84
    85/100000 [..............................] - ETA: 97:30:19 - loss: 0.7108 - accuracy: 0.5083I0417 21:46:28.109514 140147223390016 keras_utils.py:163] TimeHistory: 0.12 seconds, 104.13 examples/second between steps 84 and 85
    86/100000 [..............................] - ETA: 96:23:41 - loss: 0.7105 - accuracy: 0.5091I0417 21:46:28.224600 140147223390016 keras_utils.py:163] TimeHistory: 0.11 seconds, 105.71 examples/second between steps 85 and 86
    87/100000 [..............................] - ETA: 95:18:36 - loss: 0.7103 - accuracy: 0.5098I0417 21:46:28.339301 140147223390016 keras_utils.py:163] TimeHistory: 0.11 seconds, 105.94 examples/second between steps 86 and 87
    88/100000 [..............................] - ETA: 94:15:00 - loss: 0.7100 - accuracy: 0.5106I0417 21:46:28.453742 140147223390016 keras_utils.py:163] TimeHistory: 0.11 seconds, 106.08 examples/second between steps 87 and 88
    89/100000 [..............................] - ETA: 93:12:51 - loss: 0.7098 - accuracy: 0.5112I0417 21:46:28.568478 140147223390016 keras_utils.py:163] TimeHistory: 0.11 seconds, 105.94 examples/second between steps 88 and 89
    90/100000 [..............................] - ETA: 92:12:05 - loss: 0.7095 - accuracy: 0.5120I0417 21:46:28.682291 140147223390016 keras_utils.py:163] TimeHistory: 0.11 seconds, 106.71 examples/second between steps 89 and 90
    91/100000 [..............................] - ETA: 91:12:41 - loss: 0.7093 - accuracy: 0.5126I0417 21:46:28.797016 140147223390016 keras_utils.py:163] TimeHistory: 0.11 seconds, 106.00 examples/second between steps 90 and 91
    92/100000 [..............................] - ETA: 96:33:38 - loss: 0.7091 - accuracy: 0.5133I0417 21:46:49.626352 140147223390016 keras_utils.py:163] TimeHistory: 20.83 seconds, 0.58 examples/second between steps 91 and 92
    93/100000 [..............................] - ETA: 101:51:03 - loss: 0.7089 - accuracy: 0.5139I0417 21:47:10.647253 140147223390016 keras_utils.py:163] TimeHistory: 21.02 seconds, 0.57 examples/second between steps 92 and 93
    94/100000 [..............................] - ETA: 100:47:25 - loss: 0.7087 - accuracy: 0.5144I0417 21:47:10.766413 140147223390016 keras_utils.py:163] TimeHistory: 0.12 seconds, 103.11 examples/second between steps 93 and 94
    95/100000 [..............................] - ETA: 99:45:07 - loss: 0.7085 - accuracy: 0.5149 I0417 21:47:10.884588 140147223390016 keras_utils.py:163] TimeHistory: 0.12 seconds, 103.08 examples/second between steps 94 and 95
    96/100000 [..............................] - ETA: 98:44:08 - loss: 0.7083 - accuracy: 0.5154I0417 21:47:11.003215 140147223390016 keras_utils.py:163] TimeHistory: 0.12 seconds, 102.73 examples/second between steps 95 and 96
    97/100000 [..............................] - ETA: 97:44:25 - loss: 0.7081 - accuracy: 0.5160I0417 21:47:11.120670 140147223390016 keras_utils.py:163] TimeHistory: 0.12 seconds, 103.77 examples/second between steps 96 and 97
    98/100000 [..............................] - ETA: 96:45:54 - loss: 0.7079 - accuracy: 0.5164I0417 21:47:11.237866 140147223390016 keras_utils.py:163] TimeHistory: 0.12 seconds, 104.30 examples/second between steps 97 and 98
    99/100000 [..............................] - ETA: 101:30:59 - loss: 0.7077 - accuracy: 0.5169I0417 21:47:31.507527 140147223390016 keras_utils.py:163] TimeHistory: 20.27 seconds, 0.59 examples/second between steps 98 and 99
   100/100000 [..............................] - ETA: 100:31:33 - loss: 0.7076 - accuracy: 0.5174I0417 21:47:31.635091 140147223390016 keras_utils.py:163] TimeHistory: 0.13 seconds, 95.98 examples/second between steps 99 and 100
I0417 21:47:31.637282 140147223390016 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695657343/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 16
I0417 21:47:31.637535 140147223390016 training.py:1298] Heterogeneous profiling: now profiling batch size 16
INFO:tensorflow:Running non-virtual train step
I0417 21:47:31.645991 140124323395328 training.py:940] Running non-virtual train step
   101/100000 [..............................] - ETA: 107:36:25 - loss: 0.7074 - accuracy: 0.5178I0417 21:48:00.779587 140147223390016 keras_utils.py:163] TimeHistory: 29.14 seconds, 0.55 examples/second between steps 100 and 101
   102/100000 [..............................] - ETA: 106:54:40 - loss: 0.7072 - accuracy: 0.5183I0417 21:48:02.128028 140147223390016 keras_utils.py:163] TimeHistory: 1.35 seconds, 11.89 examples/second between steps 101 and 102
   103/100000 [..............................] - ETA: 105:54:05 - loss: 0.7071 - accuracy: 0.5188I0417 21:48:02.273344 140147223390016 keras_utils.py:163] TimeHistory: 0.14 seconds, 111.38 examples/second between steps 102 and 103
   104/100000 [..............................] - ETA: 104:54:42 - loss: 0.7069 - accuracy: 0.5193I0417 21:48:02.420126 140147223390016 keras_utils.py:163] TimeHistory: 0.15 seconds, 110.30 examples/second between steps 103 and 104
   105/100000 [..............................] - ETA: 103:56:26 - loss: 0.7067 - accuracy: 0.5199I0417 21:48:02.565199 140147223390016 keras_utils.py:163] TimeHistory: 0.14 seconds, 111.67 examples/second between steps 104 and 105
   106/100000 [..............................] - ETA: 102:59:16 - loss: 0.7065 - accuracy: 0.5203I0417 21:48:02.709924 140147223390016 keras_utils.py:163] TimeHistory: 0.14 seconds, 111.74 examples/second between steps 105 and 106
   107/100000 [..............................] - ETA: 102:03:13 - loss: 0.7064 - accuracy: 0.5208I0417 21:48:02.856500 140147223390016 keras_utils.py:163] TimeHistory: 0.14 seconds, 110.43 examples/second between steps 106 and 107
   108/100000 [..............................] - ETA: 101:08:12 - loss: 0.7062 - accuracy: 0.5212I0417 21:48:03.002454 140147223390016 keras_utils.py:163] TimeHistory: 0.14 seconds, 110.99 examples/second between steps 107 and 108
   109/100000 [..............................] - ETA: 100:14:12 - loss: 0.7060 - accuracy: 0.5216I0417 21:48:03.148497 140147223390016 keras_utils.py:163] TimeHistory: 0.14 seconds, 110.89 examples/second between steps 108 and 109
   110/100000 [..............................] - ETA: 99:21:11 - loss: 0.7059 - accuracy: 0.5220 I0417 21:48:03.293849 140147223390016 keras_utils.py:163] TimeHistory: 0.14 seconds, 111.39 examples/second between steps 109 and 110
   111/100000 [..............................] - ETA: 98:29:09 - loss: 0.7057 - accuracy: 0.5224I0417 21:48:03.439604 140147223390016 keras_utils.py:163] TimeHistory: 0.14 seconds, 111.04 examples/second between steps 110 and 111
   112/100000 [..............................] - ETA: 97:38:02 - loss: 0.7056 - accuracy: 0.5227I0417 21:48:03.585045 140147223390016 keras_utils.py:163] TimeHistory: 0.14 seconds, 111.17 examples/second between steps 111 and 112
   113/100000 [..............................] - ETA: 96:47:50 - loss: 0.7055 - accuracy: 0.5231I0417 21:48:03.730668 140147223390016 keras_utils.py:163] TimeHistory: 0.14 seconds, 111.15 examples/second between steps 112 and 113
   114/100000 [..............................] - ETA: 95:58:31 - loss: 0.7053 - accuracy: 0.5234I0417 21:48:03.875990 140147223390016 keras_utils.py:163] TimeHistory: 0.14 seconds, 111.30 examples/second between steps 113 and 114
   115/100000 [..............................] - ETA: 95:10:05 - loss: 0.7052 - accuracy: 0.5237I0417 21:48:04.021858 140147223390016 keras_utils.py:163] TimeHistory: 0.14 seconds, 110.95 examples/second between steps 114 and 115
   116/100000 [..............................] - ETA: 94:22:28 - loss: 0.7051 - accuracy: 0.5240I0417 21:48:04.167131 140147223390016 keras_utils.py:163] TimeHistory: 0.14 seconds, 111.50 examples/second between steps 115 and 116
   117/100000 [..............................] - ETA: 93:35:42 - loss: 0.7049 - accuracy: 0.5242I0417 21:48:04.313272 140147223390016 keras_utils.py:163] TimeHistory: 0.14 seconds, 110.88 examples/second between steps 116 and 117
   118/100000 [..............................] - ETA: 92:49:44 - loss: 0.7048 - accuracy: 0.5245I0417 21:48:04.460054 140147223390016 keras_utils.py:163] TimeHistory: 0.14 seconds, 110.50 examples/second between steps 117 and 118
   119/100000 [..............................] - ETA: 92:04:33 - loss: 0.7047 - accuracy: 0.5248I0417 21:48:04.606556 140147223390016 keras_utils.py:163] TimeHistory: 0.14 seconds, 110.70 examples/second between steps 118 and 119
   120/100000 [..............................] - ETA: 91:20:06 - loss: 0.7046 - accuracy: 0.5251I0417 21:48:04.752065 140147223390016 keras_utils.py:163] TimeHistory: 0.14 seconds, 111.19 examples/second between steps 119 and 120
I0417 21:48:04.754256 140147223390016 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695657343/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 24
I0417 21:48:04.754483 140147223390016 training.py:1298] Heterogeneous profiling: now profiling batch size 24
INFO:tensorflow:Running non-virtual train step
I0417 21:48:04.762962 140124201678592 training.py:940] Running non-virtual train step
   121/100000 [..............................] - ETA: 98:15:26 - loss: 0.7044 - accuracy: 0.5254I0417 21:48:37.988005 140147223390016 keras_utils.py:163] TimeHistory: 33.23 seconds, 0.72 examples/second between steps 120 and 121
   122/100000 [..............................] - ETA: 97:52:05 - loss: 0.7043 - accuracy: 0.5257I0417 21:48:39.836319 140147223390016 keras_utils.py:163] TimeHistory: 1.84 seconds, 13.01 examples/second between steps 121 and 122
   123/100000 [..............................] - ETA: 97:06:43 - loss: 0.7042 - accuracy: 0.5260I0417 21:48:40.043370 140147223390016 keras_utils.py:163] TimeHistory: 0.21 seconds, 116.97 examples/second between steps 122 and 123
   124/100000 [..............................] - ETA: 96:22:03 - loss: 0.7040 - accuracy: 0.5263I0417 21:48:40.248054 140147223390016 keras_utils.py:163] TimeHistory: 0.20 seconds, 118.34 examples/second between steps 123 and 124
   125/100000 [..............................] - ETA: 95:38:07 - loss: 0.7039 - accuracy: 0.5265I0417 21:48:40.452419 140147223390016 keras_utils.py:163] TimeHistory: 0.20 seconds, 118.50 examples/second between steps 124 and 125
   126/100000 [..............................] - ETA: 94:54:52 - loss: 0.7038 - accuracy: 0.5268I0417 21:48:40.657011 140147223390016 keras_utils.py:163] TimeHistory: 0.20 seconds, 118.34 examples/second between steps 125 and 126
   127/100000 [..............................] - ETA: 94:12:20 - loss: 0.7037 - accuracy: 0.5270I0417 21:48:40.863148 140147223390016 keras_utils.py:163] TimeHistory: 0.20 seconds, 117.47 examples/second between steps 126 and 127
   128/100000 [..............................] - ETA: 93:30:29 - loss: 0.7036 - accuracy: 0.5273I0417 21:48:41.068990 140147223390016 keras_utils.py:163] TimeHistory: 0.20 seconds, 117.69 examples/second between steps 127 and 128
   129/100000 [..............................] - ETA: 92:49:15 - loss: 0.7035 - accuracy: 0.5275I0417 21:48:41.274380 140147223390016 keras_utils.py:163] TimeHistory: 0.20 seconds, 118.09 examples/second between steps 128 and 129
   130/100000 [..............................] - ETA: 92:08:41 - loss: 0.7034 - accuracy: 0.5277I0417 21:48:41.479636 140147223390016 keras_utils.py:163] TimeHistory: 0.20 seconds, 118.12 examples/second between steps 129 and 130
   131/100000 [..............................] - ETA: 91:28:44 - loss: 0.7033 - accuracy: 0.5280I0417 21:48:41.685221 140147223390016 keras_utils.py:163] TimeHistory: 0.20 seconds, 117.81 examples/second between steps 130 and 131
   132/100000 [..............................] - ETA: 90:49:23 - loss: 0.7032 - accuracy: 0.5282I0417 21:48:41.890257 140147223390016 keras_utils.py:163] TimeHistory: 0.20 seconds, 118.20 examples/second between steps 131 and 132
   133/100000 [..............................] - ETA: 90:10:38 - loss: 0.7031 - accuracy: 0.5284I0417 21:48:42.095519 140147223390016 keras_utils.py:163] TimeHistory: 0.20 seconds, 118.03 examples/second between steps 132 and 133
   134/100000 [..............................] - ETA: 89:32:28 - loss: 0.7030 - accuracy: 0.5286I0417 21:48:42.301306 140147223390016 keras_utils.py:163] TimeHistory: 0.20 seconds, 117.67 examples/second between steps 133 and 134
   135/100000 [..............................] - ETA: 88:54:52 - loss: 0.7029 - accuracy: 0.5289I0417 21:48:42.506376 140147223390016 keras_utils.py:163] TimeHistory: 0.20 seconds, 118.20 examples/second between steps 134 and 135
   136/100000 [..............................] - ETA: 88:17:50 - loss: 0.7028 - accuracy: 0.5291I0417 21:48:42.711851 140147223390016 keras_utils.py:163] TimeHistory: 0.20 seconds, 117.95 examples/second between steps 135 and 136
   137/100000 [..............................] - ETA: 87:41:20 - loss: 0.7027 - accuracy: 0.5294I0417 21:48:42.916577 140147223390016 keras_utils.py:163] TimeHistory: 0.20 seconds, 118.31 examples/second between steps 136 and 137
   138/100000 [..............................] - ETA: 87:05:22 - loss: 0.7026 - accuracy: 0.5296I0417 21:48:43.121878 140147223390016 keras_utils.py:163] TimeHistory: 0.20 seconds, 117.94 examples/second between steps 137 and 138
   139/100000 [..............................] - ETA: 86:29:56 - loss: 0.7025 - accuracy: 0.5298I0417 21:48:43.327266 140147223390016 keras_utils.py:163] TimeHistory: 0.20 seconds, 117.88 examples/second between steps 138 and 139
   140/100000 [..............................] - ETA: 85:55:00 - loss: 0.7024 - accuracy: 0.5300I0417 21:48:43.532575 140147223390016 keras_utils.py:163] TimeHistory: 0.20 seconds, 117.97 examples/second between steps 139 and 140
I0417 21:48:43.534882 140147223390016 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695657343/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 32
I0417 21:48:43.535107 140147223390016 training.py:1298] Heterogeneous profiling: now profiling batch size 32
INFO:tensorflow:Running non-virtual train step
I0417 21:48:43.543907 140123542648576 training.py:940] Running non-virtual train step
   141/100000 [..............................] - ETA: 90:58:45 - loss: 0.7023 - accuracy: 0.5303I0417 21:49:12.186205 140147223390016 keras_utils.py:163] TimeHistory: 28.65 seconds, 1.12 examples/second between steps 140 and 141
   142/100000 [..............................] - ETA: 90:37:47 - loss: 0.7021 - accuracy: 0.5305I0417 21:49:13.693061 140147223390016 keras_utils.py:163] TimeHistory: 1.50 seconds, 21.28 examples/second between steps 141 and 142
   143/100000 [..............................] - ETA: 90:02:31 - loss: 0.7020 - accuracy: 0.5308I0417 21:49:13.957151 140147223390016 keras_utils.py:163] TimeHistory: 0.26 seconds, 122.11 examples/second between steps 142 and 143
   144/100000 [..............................] - ETA: 89:27:45 - loss: 0.7019 - accuracy: 0.5310I0417 21:49:14.220336 140147223390016 keras_utils.py:163] TimeHistory: 0.26 seconds, 122.53 examples/second between steps 143 and 144
   145/100000 [..............................] - ETA: 88:53:27 - loss: 0.7018 - accuracy: 0.5312I0417 21:49:14.482700 140147223390016 keras_utils.py:163] TimeHistory: 0.26 seconds, 122.86 examples/second between steps 144 and 145
   146/100000 [..............................] - ETA: 88:19:39 - loss: 0.7017 - accuracy: 0.5315I0417 21:49:14.746080 140147223390016 keras_utils.py:163] TimeHistory: 0.26 seconds, 122.31 examples/second between steps 145 and 146
   147/100000 [..............................] - ETA: 87:46:17 - loss: 0.7016 - accuracy: 0.5317I0417 21:49:15.008043 140147223390016 keras_utils.py:163] TimeHistory: 0.26 seconds, 122.96 examples/second between steps 146 and 147
   148/100000 [..............................] - ETA: 87:13:22 - loss: 0.7015 - accuracy: 0.5319I0417 21:49:15.269685 140147223390016 keras_utils.py:163] TimeHistory: 0.26 seconds, 123.31 examples/second between steps 147 and 148
   149/100000 [..............................] - ETA: 86:40:53 - loss: 0.7014 - accuracy: 0.5322I0417 21:49:15.530624 140147223390016 keras_utils.py:163] TimeHistory: 0.26 seconds, 123.48 examples/second between steps 148 and 149
   150/100000 [..............................] - ETA: 86:08:51 - loss: 0.7013 - accuracy: 0.5324I0417 21:49:15.792681 140147223390016 keras_utils.py:163] TimeHistory: 0.26 seconds, 122.94 examples/second between steps 149 and 150
   151/100000 [..............................] - ETA: 85:37:15 - loss: 0.7012 - accuracy: 0.5326I0417 21:49:16.054213 140147223390016 keras_utils.py:163] TimeHistory: 0.26 seconds, 123.19 examples/second between steps 150 and 151
   152/100000 [..............................] - ETA: 85:06:04 - loss: 0.7011 - accuracy: 0.5328I0417 21:49:16.316675 140147223390016 keras_utils.py:163] TimeHistory: 0.26 seconds, 122.82 examples/second between steps 151 and 152
   153/100000 [..............................] - ETA: 84:35:18 - loss: 0.7011 - accuracy: 0.5330I0417 21:49:16.579553 140147223390016 keras_utils.py:163] TimeHistory: 0.26 seconds, 122.57 examples/second between steps 152 and 153
   154/100000 [..............................] - ETA: 84:04:56 - loss: 0.7010 - accuracy: 0.5332I0417 21:49:16.842702 140147223390016 keras_utils.py:163] TimeHistory: 0.26 seconds, 122.58 examples/second between steps 153 and 154
   155/100000 [..............................] - ETA: 83:34:58 - loss: 0.7009 - accuracy: 0.5333I0417 21:49:17.104871 140147223390016 keras_utils.py:163] TimeHistory: 0.26 seconds, 122.93 examples/second between steps 154 and 155
   156/100000 [..............................] - ETA: 83:05:22 - loss: 0.7008 - accuracy: 0.5335I0417 21:49:17.365910 140147223390016 keras_utils.py:163] TimeHistory: 0.26 seconds, 123.48 examples/second between steps 155 and 156
   157/100000 [..............................] - ETA: 82:36:08 - loss: 0.7007 - accuracy: 0.5337I0417 21:49:17.627115 140147223390016 keras_utils.py:163] TimeHistory: 0.26 seconds, 123.38 examples/second between steps 156 and 157
   158/100000 [..............................] - ETA: 82:07:17 - loss: 0.7006 - accuracy: 0.5339I0417 21:49:17.888151 140147223390016 keras_utils.py:163] TimeHistory: 0.26 seconds, 123.42 examples/second between steps 157 and 158
   159/100000 [..............................] - ETA: 85:05:08 - loss: 0.7006 - accuracy: 0.5341I0417 21:49:37.739985 140147223390016 keras_utils.py:163] TimeHistory: 19.85 seconds, 1.61 examples/second between steps 158 and 159
   160/100000 [..............................] - ETA: 84:35:46 - loss: 0.7005 - accuracy: 0.5342I0417 21:49:38.006392 140147223390016 keras_utils.py:163] TimeHistory: 0.26 seconds, 121.33 examples/second between steps 159 and 160
I0417 21:49:38.008865 140147223390016 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695657343/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 48
I0417 21:49:38.009093 140147223390016 training.py:1298] Heterogeneous profiling: now profiling batch size 48
INFO:tensorflow:Running non-virtual train step
I0417 21:49:38.018434 140123521410816 training.py:940] Running non-virtual train step
   161/100000 [..............................] - ETA: 89:02:52 - loss: 0.7004 - accuracy: 0.5344I0417 21:50:06.745868 140147223390016 keras_utils.py:163] TimeHistory: 28.74 seconds, 1.67 examples/second between steps 160 and 161
   162/100000 [..............................] - ETA: 88:48:08 - loss: 0.7003 - accuracy: 0.5346I0417 21:50:08.535500 140147223390016 keras_utils.py:163] TimeHistory: 1.79 seconds, 26.87 examples/second between steps 161 and 162
   163/100000 [..............................] - ETA: 88:19:03 - loss: 0.7002 - accuracy: 0.5348I0417 21:50:08.910967 140147223390016 keras_utils.py:163] TimeHistory: 0.37 seconds, 128.48 examples/second between steps 162 and 163
   164/100000 [..............................] - ETA: 87:50:18 - loss: 0.7001 - accuracy: 0.5350I0417 21:50:09.285238 140147223390016 keras_utils.py:163] TimeHistory: 0.37 seconds, 128.91 examples/second between steps 163 and 164
   165/100000 [..............................] - ETA: 87:21:56 - loss: 0.7001 - accuracy: 0.5352I0417 21:50:09.661367 140147223390016 keras_utils.py:163] TimeHistory: 0.37 seconds, 128.31 examples/second between steps 164 and 165
   166/100000 [..............................] - ETA: 86:53:53 - loss: 0.7000 - accuracy: 0.5354I0417 21:50:10.035122 140147223390016 keras_utils.py:163] TimeHistory: 0.37 seconds, 129.12 examples/second between steps 165 and 166
   167/100000 [..............................] - ETA: 86:26:10 - loss: 0.6999 - accuracy: 0.5356I0417 21:50:10.409464 140147223390016 keras_utils.py:163] TimeHistory: 0.37 seconds, 128.90 examples/second between steps 166 and 167
   168/100000 [..............................] - ETA: 85:58:48 - loss: 0.6998 - accuracy: 0.5358I0417 21:50:10.784564 140147223390016 keras_utils.py:163] TimeHistory: 0.37 seconds, 128.65 examples/second between steps 167 and 168
   169/100000 [..............................] - ETA: 85:31:45 - loss: 0.6997 - accuracy: 0.5360I0417 21:50:11.159637 140147223390016 keras_utils.py:163] TimeHistory: 0.37 seconds, 128.65 examples/second between steps 168 and 169
   170/100000 [..............................] - ETA: 85:05:01 - loss: 0.6996 - accuracy: 0.5362I0417 21:50:11.533153 140147223390016 keras_utils.py:163] TimeHistory: 0.37 seconds, 129.32 examples/second between steps 169 and 170
   171/100000 [..............................] - ETA: 84:38:36 - loss: 0.6996 - accuracy: 0.5363I0417 21:50:11.908185 140147223390016 keras_utils.py:163] TimeHistory: 0.37 seconds, 128.64 examples/second between steps 170 and 171
   172/100000 [..............................] - ETA: 84:12:30 - loss: 0.6995 - accuracy: 0.5365I0417 21:50:12.283154 140147223390016 keras_utils.py:163] TimeHistory: 0.37 seconds, 128.71 examples/second between steps 171 and 172
   173/100000 [..............................] - ETA: 83:46:41 - loss: 0.6994 - accuracy: 0.5367I0417 21:50:12.656385 140147223390016 keras_utils.py:163] TimeHistory: 0.37 seconds, 129.25 examples/second between steps 172 and 173
   174/100000 [..............................] - ETA: 83:21:11 - loss: 0.6993 - accuracy: 0.5368I0417 21:50:13.030553 140147223390016 keras_utils.py:163] TimeHistory: 0.37 seconds, 128.97 examples/second between steps 173 and 174
   175/100000 [..............................] - ETA: 82:55:58 - loss: 0.6993 - accuracy: 0.5370I0417 21:50:13.405198 140147223390016 keras_utils.py:163] TimeHistory: 0.37 seconds, 128.75 examples/second between steps 174 and 175
   176/100000 [..............................] - ETA: 82:31:02 - loss: 0.6992 - accuracy: 0.5371I0417 21:50:13.779052 140147223390016 keras_utils.py:163] TimeHistory: 0.37 seconds, 129.02 examples/second between steps 175 and 176
   177/100000 [..............................] - ETA: 82:06:24 - loss: 0.6992 - accuracy: 0.5373I0417 21:50:14.153707 140147223390016 keras_utils.py:163] TimeHistory: 0.37 seconds, 128.82 examples/second between steps 176 and 177
   178/100000 [..............................] - ETA: 81:42:02 - loss: 0.6991 - accuracy: 0.5374I0417 21:50:14.528167 140147223390016 keras_utils.py:163] TimeHistory: 0.37 seconds, 128.92 examples/second between steps 177 and 178
   179/100000 [..............................] - ETA: 81:17:57 - loss: 0.6990 - accuracy: 0.5375I0417 21:50:14.901681 140147223390016 keras_utils.py:163] TimeHistory: 0.37 seconds, 129.14 examples/second between steps 178 and 179
   180/100000 [..............................] - ETA: 84:02:08 - loss: 0.6990 - accuracy: 0.5376I0417 21:50:35.505960 140147223390016 keras_utils.py:163] TimeHistory: 20.60 seconds, 2.33 examples/second between steps 179 and 180
I0417 21:50:35.509161 140147223390016 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695657343/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling complete
I0417 21:50:35.509477 140147223390016 training.py:1295] Heterogeneous profiling complete
100000/100000 [==============================] - 571s 5ms/step - loss: 0.6889 - accuracy: 0.5588
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._masked_softmax
W0417 21:50:38.216940 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._dropout
W0417 21:50:38.217170 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._masked_softmax
W0417 21:50:38.217289 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._dropout
W0417 21:50:38.217397 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._masked_softmax
W0417 21:50:38.217523 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._dropout
W0417 21:50:38.217628 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._masked_softmax
W0417 21:50:38.217715 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._dropout
W0417 21:50:38.217797 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._masked_softmax
W0417 21:50:38.217879 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._dropout
W0417 21:50:38.217966 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._masked_softmax
W0417 21:50:38.218043 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._dropout
W0417 21:50:38.218117 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._masked_softmax
W0417 21:50:38.218196 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._dropout
W0417 21:50:38.218272 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._masked_softmax
W0417 21:50:38.218346 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._dropout
W0417 21:50:38.218424 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._masked_softmax
W0417 21:50:38.218507 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._dropout
W0417 21:50:38.218604 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._masked_softmax
W0417 21:50:38.218698 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._dropout
W0417 21:50:38.218788 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._masked_softmax
W0417 21:50:38.218866 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._dropout
W0417 21:50:38.218941 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._masked_softmax
W0417 21:50:38.219019 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._dropout
W0417 21:50:38.219094 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:50:38.219173 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:50:38.219252 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:50:38.219329 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:50:38.219405 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:50:38.219482 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:50:38.219561 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:50:38.219644 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:50:38.219720 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:50:38.219797 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:50:38.219873 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:50:38.219949 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:50:38.220025 140147223390016 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:A checkpoint was restored (e.g. tf.train.Checkpoint.restore or tf.keras.Model.load_weights) but not all checkpointed values were used. See above for specific issues. Use expect_partial() on the load status object, e.g. tf.train.Checkpoint.restore(...).expect_partial(), to silence these warnings, or use assert_consumed() to make the check explicit. See https://www.tensorflow.org/guide/checkpoint#loading_mechanics for details.
W0417 21:50:38.220105 140147223390016 util.py:169] A checkpoint was restored (e.g. tf.train.Checkpoint.restore or tf.keras.Model.load_weights) but not all checkpointed values were used. See above for specific issues. Use expect_partial() on the load status object, e.g. tf.train.Checkpoint.restore(...).expect_partial(), to silence these warnings, or use assert_consumed() to make the check explicit. See https://www.tensorflow.org/guide/checkpoint#loading_mechanics for details.
