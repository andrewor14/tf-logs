My commit is 46f9d67f Simulator: Refactor to compute job allocations once (/root/dev/models/deploy)

==========================================================================
My environment variables:
--------------------------------------------------------------------------
CUDNN_VERSION=7.6.2.24-1+cuda10.1
PMIX_ID=3887661057.0
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:
LD_LIBRARY_PATH=/usr/local/lib:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
OMPI_FIRST_RANKS=0
MPI_HOSTS=ba38ffac2928
OMPI_MCA_orte_top_session_dir=/tmp/ompi.ba38ffac2928.0
LOG_MEMORY_ENABLED=false
PMIX_SYSTEM_TMPDIR=/tmp
OMPI_MCA_orte_num_nodes=1
OMPI_COMMAND=run_transformer.sh
MODEL=transformer
LANG=C.UTF-8
PARAM_SET=big
HFI_NO_BACKTRACE=1
HOSTNAME=ba38ffac2928
DECODE_BATCH_SIZE=32
OMPI_MCA_ess_base_vpid=0
OLDPWD=/root
OMPI_MCA_initial_wdir=/root/dev/models/deploy
VOCAB_FILE=/root/dev/dataset/transformer/vocab.ende.32768
ENVIRONMENT=docker
TF_DIR=/root/dev/tensorflow
STEPS_BETWEEN_EVALS=100000
DATA_DIR=/root/dev/dataset/transformer
HOST_FLAG=--host ba38ffac2928
OMPI_MCA_btl_tcp_if_exclude=lo,docker0,eth1
DTYPE=fp16
NUM_CHECKPOINTS_TO_KEEP=5
OMPI_COMM_WORLD_NODE_RANK=0
NVIDIA_VISIBLE_DEVICES=all
OMPI_MCA_orte_precondition_transports=8d911af395cc6e7a-4059f70399d5ee6d
BASE_DIR=/root/dev
OMPI_MCA_orte_ess_node_rank=0
OMPI_MCA_shmem_RUNTIME_QUERY_hint=mmap
OMPI_COMM_WORLD_RANK=0
LOG_STEPS=1
PMIX_RANK=0
OMPI_FILE_LOCATION=/tmp/ompi.ba38ffac2928.0/pid.1278/0/0
NCCL_VERSION=2.4.7-1+cuda10.1
OMPI_MCA_orte_local_daemon_uri=3887661056.0;tcp://10.0.1.2,172.18.0.3:39859
HOROVOD_GPU_OPERATIONS=NCCL
PWD=/root/dev/models/deploy
NUM_GPUS_PER_NODE=8
HOME=/root
ENABLE_XLA=true
PMIX_SERVER_TMPDIR=/tmp/ompi.ba38ffac2928.0/pid.1278
RUN_SCRIPT=run_transformer.sh
PMIX_PTL_MODULE=tcp,usock
IPATH_NO_BACKTRACE=1
JOB_NAME=transformer-04_17_21_1618696180135
OMPI_MCA_rmaps_base_oversubscribe=1
OMPI_MCA_orte_launch=1
CODE_DIR=/root/dev/models/official/nlp/transformer
OMPI_MCA_orte_tmpdir_base=/tmp
LOG_DIR=/root/dev/logs
TIMESTAMP=04_17_21_1618696180185
MPI_HOST_FILE=/root/container_hosts/hosts.txt
BLEU_SOURCE=
NUM_VIRTUAL_NODES_PER_DEVICE=1
OMPI_APP_CTX_NUM_PROCS=1
OMPI_MCA_orte_output_filename=/root/dev/logs/transformer-04_17_21_1618696180135
LOG_FILE=/dev/stderr
MODELS_DIR=/root/dev/models
OMPI_MCA_orte_app_num=0
DISABLE_VIRTUAL_NODES=true
PMIX_MCA_mca_base_component_show_load_errors=1
NUM_NODES=1
MAX_LENGTH=64
OMPI_MCA_pml=ob1
PYTHON_COMMAND=/usr/bin/python3
IN_DOCKER_CONTAINER=true
NUM_EPOCHS=100000
PMIX_BFROP_BUFFER_TYPE=PMIX_BFROP_BUFFER_NON_DESC
MPI_HOME=/usr/local
TERM=xterm
CUDA_PKG_VERSION=10-1=10.1.243-1
CUDA_VERSION=10.1.243
SKIP_EVAL=true
PMIX_DSTORE_ESH_BASE_PATH=/tmp/ompi.ba38ffac2928.0/pid.1278/pmix_dstor_ds12_1278
OMPI_MCA_hwloc_base_binding_policy=none
BLEU_REF=
OMPI_MCA_rmaps_base_mapping_policy=node
PMIX_SERVER_URI3=3887661056.0;tcp4://127.0.0.1:42693
PMIX_SERVER_URI2=3887661056.0;tcp4://127.0.0.1:42693
NUM_STEPS=100000
OMPI_MCA_orte_hnp_uri=3887661056.0;tcp://10.0.1.2,172.18.0.3:39859
TRAIN_DIR=/root/dev/logs/transformer-04_17_21_1618696180135
OMPI_MCA_mpi_yield_when_idle=0
NVIDIA_DRIVER_CAPABILITIES=compute,utility
DEFAULT_NUM_GPUS_PER_NODE=8
ENABLE_CHECKPOINTS=false
DISTRIBUTION_STRATEGY=mirrored
OMPI_COMM_WORLD_LOCAL_SIZE=1
CUDA_VISIBLE_DEVICES=0
OMPI_COMM_WORLD_SIZE=1
SHLVL=3
PYTHONPATH=:/root/dev/models:/root/dev/models
OMPI_NUM_APP_CTX=1
NVIDIA_REQUIRE_CUDA=cuda>=10.1 brand=tesla,driver>=396,driver<397 brand=tesla,driver>=410,driver<411 brand=tesla,driver>=418,driver<419
OMPI_MCA_pmix=^s1,s2,cray,isolated
DEFAULT_DISTRIBUTION_STRATEGY=mirrored
PMIX_SERVER_URI21=3887661056.0;tcp4://127.0.0.1:42693
SAVED_CHECKPOINT_PATH=
PMIX_DSTORE_21_BASE_PATH=/tmp/ompi.ba38ffac2928.0/pid.1278/pmix_dstor_ds21_1278
ENABLE_MONITOR_MEMORY=false
ENABLE_HETEROGENEOUS_PROFILE=true
CUBLAS_VERSION=10.1.0.105-1
BATCH_SIZE=4096
PATH=/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
PMIX_SECURITY_MODE=native
OMPI_MCA_ess=^singleton
NCCL_DEBUG=INFO
PMIX_NAMESPACE=3887661057
OMPI_MCA_orte_ess_num_procs=1
NCCL_SOCKET_IFNAME=^lo,docker0,eth1
OMPI_MCA_ess_base_jobid=3887661057
OMPI_COMM_WORLD_LOCAL_RANK=0
OMPI_UNIVERSE_SIZE=1
OMPI_MCA_orte_jobfam_session_dir=/tmp/ompi.ba38ffac2928.0/pid.1278
PMIX_GDS_MODULE=ds21,ds12,hash
ENABLE_ELASTICITY=false
NUM_GPUS=1
OMPI_MCA_btl=^openib
_=/usr/bin/printenv
==========================================================================

2021-04-17 21:49:40.394693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
I0417 21:49:44.552193 140198355175232 virtual_helper.py:221] Setting TF_CONFIG to {"cluster": {"worker": ["ba38ffac2928:2222"]}, "task": {"type": "worker", "index": 0}}
INFO:tensorflow:Initializing local devices since in-graph multi-worker training with `MirroredStrategy` is not supported in eager mode. TF_CONFIG will be ignored when when initializing `MirroredStrategy`.
I0417 21:49:44.552759 140198355175232 mirrored_strategy.py:306] Initializing local devices since in-graph multi-worker training with `MirroredStrategy` is not supported in eager mode. TF_CONFIG will be ignored when when initializing `MirroredStrategy`.
2021-04-17 21:49:44.553043: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-17 21:49:44.553128: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-17 21:49:44.590572: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:49:44.591212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P100-PCIE-16GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 15.90GiB deviceMemoryBandwidth: 681.88GiB/s
2021-04-17 21:49:44.591239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-17 21:49:44.593216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-04-17 21:49:44.593294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-04-17 21:49:44.595228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-17 21:49:44.595590: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-17 21:49:44.597634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-17 21:49:44.598895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-04-17 21:49:44.603245: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-04-17 21:49:44.603397: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:49:44.604126: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:49:44.604702: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-17 21:49:44.605068: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-17 21:49:44.607856: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-17 21:49:44.607980: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:49:44.608586: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P100-PCIE-16GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 15.90GiB deviceMemoryBandwidth: 681.88GiB/s
2021-04-17 21:49:44.608610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-17 21:49:44.608634: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-04-17 21:49:44.608686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-04-17 21:49:44.608699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-17 21:49:44.608713: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-17 21:49:44.608725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-17 21:49:44.608739: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-04-17 21:49:44.608751: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-04-17 21:49:44.608818: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:49:44.609586: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:49:44.610184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-17 21:49:44.610225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-17 21:49:45.345123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-17 21:49:45.345167: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-17 21:49:45.345176: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-17 21:49:45.345435: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:49:45.346131: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:49:45.346759: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:49:45.347352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14888 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:00:04.0, compute capability: 6.0)
INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
I0417 21:49:45.352592 140198355175232 mirrored_strategy.py:350] Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
I0417 21:49:45.353744 140198355175232 transformer_main.py:180] Running transformer with num_gpus = 1
I0417 21:49:45.354274 140198355175232 transformer_main.py:184] For training, using distribution strategy: <tensorflow.python.distribute.mirrored_strategy.MirroredStrategy object at 0x7f80eba3cef0>
WARNING:tensorflow:From /root/dev/models/official/nlp/transformer/attention_layer.py:63: DenseEinsum.__init__ (from official.nlp.modeling.layers.dense_einsum) is deprecated and will be removed in a future version.
Instructions for updating:
DenseEinsum is deprecated. Please use tf.keras.experimental.EinsumDense layer instead.
W0417 21:49:46.787102 140198355175232 deprecation.py:339] From /root/dev/models/official/nlp/transformer/attention_layer.py:63: DenseEinsum.__init__ (from official.nlp.modeling.layers.dense_einsum) is deprecated and will be removed in a future version.
Instructions for updating:
DenseEinsum is deprecated. Please use tf.keras.experimental.EinsumDense layer instead.
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:49:49.400572 140198355175232 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:49:49.402288 140198355175232 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:49:49.405726 140198355175232 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:49:49.406590 140198355175232 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:49:49.836461 140198355175232 transformer_main.py:314] Start train iteration at global step:0
2021-04-17 21:49:49.878138: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-17 21:49:49.878543: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2000185000 Hz
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 1
I0417 21:49:49.938928 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 1
INFO:tensorflow:Running non-virtual train step
I0417 21:49:49.985448 140158389180160 training.py:940] Running non-virtual train step
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:49:53.874019 140198355175232 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:49:53.875844 140198355175232 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Running non-virtual train step
I0417 21:49:55.421694 140158389180160 training.py:940] Running non-virtual train step
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:49:59.192953 140198355175232 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:49:59.194773 140198355175232 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2021-04-17 21:50:03.219106: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
I0417 21:50:05.588010 140198355175232 keras_utils.py:163] TimeHistory: 15.65 seconds, 0.06 examples/second between steps 0 and 1
I0417 21:50:05.649048 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 16.46 examples/second between steps 1 and 2
I0417 21:50:05.707996 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 17.03 examples/second between steps 2 and 3
I0417 21:50:05.771191 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 15.88 examples/second between steps 3 and 4
I0417 21:50:05.830106 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 17.04 examples/second between steps 4 and 5
I0417 21:50:05.887712 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 17.42 examples/second between steps 5 and 6
I0417 21:50:05.944737 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 17.60 examples/second between steps 6 and 7
I0417 21:50:06.004344 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 16.84 examples/second between steps 7 and 8
I0417 21:50:06.061743 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 17.48 examples/second between steps 8 and 9
I0417 21:50:06.116437 140198355175232 keras_utils.py:163] TimeHistory: 0.05 seconds, 18.35 examples/second between steps 9 and 10
I0417 21:50:06.170152 140198355175232 keras_utils.py:163] TimeHistory: 0.05 seconds, 18.68 examples/second between steps 10 and 11
I0417 21:50:06.229840 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 16.81 examples/second between steps 11 and 12
I0417 21:50:06.285542 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 18.01 examples/second between steps 12 and 13
I0417 21:50:06.343991 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 17.16 examples/second between steps 13 and 14
I0417 21:50:06.402095 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 17.26 examples/second between steps 14 and 15
I0417 21:50:06.454653 140198355175232 keras_utils.py:163] TimeHistory: 0.05 seconds, 19.08 examples/second between steps 15 and 16
I0417 21:50:06.511649 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 17.59 examples/second between steps 16 and 17
I0417 21:50:06.569915 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 17.21 examples/second between steps 17 and 18
I0417 21:50:06.627223 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 17.51 examples/second between steps 18 and 19
I0417 21:50:06.683785 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 17.73 examples/second between steps 19 and 20
I0417 21:50:06.684246 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 2
I0417 21:50:06.684394 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 2
INFO:tensorflow:Running non-virtual train step
I0417 21:50:06.690514 140157835523840 training.py:940] Running non-virtual train step
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:50:10.464945 140198355175232 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:50:10.466890 140198355175232 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:50:14.690459 140198355175232 keras_utils.py:163] TimeHistory: 8.01 seconds, 0.25 examples/second between steps 20 and 21
I0417 21:50:14.761835 140198355175232 keras_utils.py:163] TimeHistory: 0.07 seconds, 28.13 examples/second between steps 21 and 22
I0417 21:50:14.825781 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 31.38 examples/second between steps 22 and 23
I0417 21:50:14.894045 140198355175232 keras_utils.py:163] TimeHistory: 0.07 seconds, 29.37 examples/second between steps 23 and 24
I0417 21:50:14.957727 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 31.48 examples/second between steps 24 and 25
I0417 21:50:15.015446 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 34.74 examples/second between steps 25 and 26
I0417 21:50:15.075181 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 33.57 examples/second between steps 26 and 27
I0417 21:50:15.138693 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 31.56 examples/second between steps 27 and 28
I0417 21:50:15.208657 140198355175232 keras_utils.py:163] TimeHistory: 0.07 seconds, 28.65 examples/second between steps 28 and 29
I0417 21:50:15.267769 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 33.92 examples/second between steps 29 and 30
I0417 21:50:15.325943 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 34.47 examples/second between steps 30 and 31
I0417 21:50:15.395555 140198355175232 keras_utils.py:163] TimeHistory: 0.07 seconds, 28.80 examples/second between steps 31 and 32
I0417 21:50:15.455979 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 33.19 examples/second between steps 32 and 33
I0417 21:50:15.524604 140198355175232 keras_utils.py:163] TimeHistory: 0.07 seconds, 29.21 examples/second between steps 33 and 34
I0417 21:50:15.590546 140198355175232 keras_utils.py:163] TimeHistory: 0.07 seconds, 30.40 examples/second between steps 34 and 35
I0417 21:50:15.655081 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 31.07 examples/second between steps 35 and 36
I0417 21:50:15.721875 140198355175232 keras_utils.py:163] TimeHistory: 0.07 seconds, 30.01 examples/second between steps 36 and 37
I0417 21:50:15.782485 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 33.09 examples/second between steps 37 and 38
I0417 21:50:15.840838 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 34.38 examples/second between steps 38 and 39
I0417 21:50:15.899973 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 33.91 examples/second between steps 39 and 40
I0417 21:50:15.900359 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 4
I0417 21:50:15.900501 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 4
INFO:tensorflow:Running non-virtual train step
I0417 21:50:15.907031 140157827131136 training.py:940] Running non-virtual train step
I0417 21:50:23.645792 140198355175232 keras_utils.py:163] TimeHistory: 7.75 seconds, 0.52 examples/second between steps 40 and 41
I0417 21:50:23.709340 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 63.21 examples/second between steps 41 and 42
I0417 21:50:23.786570 140198355175232 keras_utils.py:163] TimeHistory: 0.08 seconds, 51.93 examples/second between steps 42 and 43
I0417 21:50:23.875642 140198355175232 keras_utils.py:163] TimeHistory: 0.09 seconds, 44.99 examples/second between steps 43 and 44
I0417 21:50:23.943721 140198355175232 keras_utils.py:163] TimeHistory: 0.07 seconds, 58.89 examples/second between steps 44 and 45
I0417 21:50:24.030697 140198355175232 keras_utils.py:163] TimeHistory: 0.09 seconds, 46.07 examples/second between steps 45 and 46
I0417 21:50:24.128499 140198355175232 keras_utils.py:163] TimeHistory: 0.10 seconds, 40.96 examples/second between steps 46 and 47
I0417 21:50:24.220168 140198355175232 keras_utils.py:163] TimeHistory: 0.09 seconds, 43.71 examples/second between steps 47 and 48
I0417 21:50:24.289743 140198355175232 keras_utils.py:163] TimeHistory: 0.07 seconds, 57.63 examples/second between steps 48 and 49
I0417 21:50:24.374501 140198355175232 keras_utils.py:163] TimeHistory: 0.08 seconds, 47.28 examples/second between steps 49 and 50
I0417 21:50:24.438077 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 63.08 examples/second between steps 50 and 51
I0417 21:50:24.501744 140198355175232 keras_utils.py:163] TimeHistory: 0.06 seconds, 62.98 examples/second between steps 51 and 52
I0417 21:50:24.577594 140198355175232 keras_utils.py:163] TimeHistory: 0.08 seconds, 52.85 examples/second between steps 52 and 53
I0417 21:50:24.649991 140198355175232 keras_utils.py:163] TimeHistory: 0.07 seconds, 55.40 examples/second between steps 53 and 54
I0417 21:50:24.717346 140198355175232 keras_utils.py:163] TimeHistory: 0.07 seconds, 59.53 examples/second between steps 54 and 55
I0417 21:50:24.795237 140198355175232 keras_utils.py:163] TimeHistory: 0.08 seconds, 51.47 examples/second between steps 55 and 56
I0417 21:50:24.892472 140198355175232 keras_utils.py:163] TimeHistory: 0.10 seconds, 41.20 examples/second between steps 56 and 57
I0417 21:50:24.982363 140198355175232 keras_utils.py:163] TimeHistory: 0.09 seconds, 44.58 examples/second between steps 57 and 58
I0417 21:50:25.073187 140198355175232 keras_utils.py:163] TimeHistory: 0.09 seconds, 44.12 examples/second between steps 58 and 59
I0417 21:50:25.160103 140198355175232 keras_utils.py:163] TimeHistory: 0.09 seconds, 46.11 examples/second between steps 59 and 60
I0417 21:50:25.160503 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 8
I0417 21:50:25.160660 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 8
INFO:tensorflow:Running non-virtual train step
I0417 21:50:25.167031 140157818738432 training.py:940] Running non-virtual train step
I0417 21:50:33.067376 140198355175232 keras_utils.py:163] TimeHistory: 7.91 seconds, 1.01 examples/second between steps 60 and 61
I0417 21:50:33.158574 140198355175232 keras_utils.py:163] TimeHistory: 0.09 seconds, 88.04 examples/second between steps 61 and 62
I0417 21:50:33.279495 140198355175232 keras_utils.py:163] TimeHistory: 0.12 seconds, 66.27 examples/second between steps 62 and 63
I0417 21:50:33.385652 140198355175232 keras_utils.py:163] TimeHistory: 0.11 seconds, 75.49 examples/second between steps 63 and 64
I0417 21:50:33.540766 140198355175232 keras_utils.py:163] TimeHistory: 0.15 seconds, 51.63 examples/second between steps 64 and 65
I0417 21:50:33.631660 140198355175232 keras_utils.py:163] TimeHistory: 0.09 seconds, 88.21 examples/second between steps 65 and 66
I0417 21:50:33.729827 140198355175232 keras_utils.py:163] TimeHistory: 0.10 seconds, 81.62 examples/second between steps 66 and 67
I0417 21:50:33.805735 140198355175232 keras_utils.py:163] TimeHistory: 0.08 seconds, 105.61 examples/second between steps 67 and 68
I0417 21:50:33.915282 140198355175232 keras_utils.py:163] TimeHistory: 0.11 seconds, 73.13 examples/second between steps 68 and 69
I0417 21:50:34.011901 140198355175232 keras_utils.py:163] TimeHistory: 0.10 seconds, 82.94 examples/second between steps 69 and 70
I0417 21:50:34.162632 140198355175232 keras_utils.py:163] TimeHistory: 0.15 seconds, 53.13 examples/second between steps 70 and 71
I0417 21:50:34.292645 140198355175232 keras_utils.py:163] TimeHistory: 0.13 seconds, 61.61 examples/second between steps 71 and 72
I0417 21:50:34.426176 140198355175232 keras_utils.py:163] TimeHistory: 0.13 seconds, 59.98 examples/second between steps 72 and 73
I0417 21:50:34.495698 140198355175232 keras_utils.py:163] TimeHistory: 0.07 seconds, 115.32 examples/second between steps 73 and 74
I0417 21:50:34.620285 140198355175232 keras_utils.py:163] TimeHistory: 0.12 seconds, 64.29 examples/second between steps 74 and 75
I0417 21:50:34.711287 140198355175232 keras_utils.py:163] TimeHistory: 0.09 seconds, 88.06 examples/second between steps 75 and 76
I0417 21:50:34.798115 140198355175232 keras_utils.py:163] TimeHistory: 0.09 seconds, 92.31 examples/second between steps 76 and 77
I0417 21:50:34.904441 140198355175232 keras_utils.py:163] TimeHistory: 0.11 seconds, 75.36 examples/second between steps 77 and 78
I0417 21:50:35.022246 140198355175232 keras_utils.py:163] TimeHistory: 0.12 seconds, 68.01 examples/second between steps 78 and 79
I0417 21:50:35.120931 140198355175232 keras_utils.py:163] TimeHistory: 0.10 seconds, 81.20 examples/second between steps 79 and 80
I0417 21:50:35.121334 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 12
I0417 21:50:35.121476 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 12
INFO:tensorflow:Running non-virtual train step
I0417 21:50:35.127590 140157265114880 training.py:940] Running non-virtual train step
I0417 21:50:42.852268 140198355175232 keras_utils.py:163] TimeHistory: 7.73 seconds, 1.55 examples/second between steps 80 and 81
I0417 21:50:43.042839 140198355175232 keras_utils.py:163] TimeHistory: 0.19 seconds, 63.06 examples/second between steps 81 and 82
I0417 21:50:43.161755 140198355175232 keras_utils.py:163] TimeHistory: 0.12 seconds, 101.11 examples/second between steps 82 and 83
I0417 21:50:43.323865 140198355175232 keras_utils.py:163] TimeHistory: 0.16 seconds, 74.12 examples/second between steps 83 and 84
I0417 21:50:43.493370 140198355175232 keras_utils.py:163] TimeHistory: 0.17 seconds, 70.87 examples/second between steps 84 and 85
I0417 21:50:43.692399 140198355175232 keras_utils.py:163] TimeHistory: 0.20 seconds, 60.35 examples/second between steps 85 and 86
I0417 21:50:43.897225 140198355175232 keras_utils.py:163] TimeHistory: 0.20 seconds, 58.64 examples/second between steps 86 and 87
I0417 21:50:44.031569 140198355175232 keras_utils.py:163] TimeHistory: 0.13 seconds, 89.45 examples/second between steps 87 and 88
I0417 21:50:44.153019 140198355175232 keras_utils.py:163] TimeHistory: 0.12 seconds, 98.95 examples/second between steps 88 and 89
I0417 21:50:44.250875 140198355175232 keras_utils.py:163] TimeHistory: 0.10 seconds, 122.83 examples/second between steps 89 and 90
I0417 21:50:44.403737 140198355175232 keras_utils.py:163] TimeHistory: 0.15 seconds, 78.58 examples/second between steps 90 and 91
I0417 21:50:44.529290 140198355175232 keras_utils.py:163] TimeHistory: 0.13 seconds, 95.70 examples/second between steps 91 and 92
I0417 21:50:44.614840 140198355175232 keras_utils.py:163] TimeHistory: 0.09 seconds, 140.54 examples/second between steps 92 and 93
I0417 21:50:44.762331 140198355175232 keras_utils.py:163] TimeHistory: 0.15 seconds, 81.45 examples/second between steps 93 and 94
I0417 21:50:44.930359 140198355175232 keras_utils.py:163] TimeHistory: 0.17 seconds, 71.48 examples/second between steps 94 and 95
I0417 21:50:45.040054 140198355175232 keras_utils.py:163] TimeHistory: 0.11 seconds, 109.55 examples/second between steps 95 and 96
I0417 21:50:45.229406 140198355175232 keras_utils.py:163] TimeHistory: 0.19 seconds, 63.43 examples/second between steps 96 and 97
I0417 21:50:45.391499 140198355175232 keras_utils.py:163] TimeHistory: 0.16 seconds, 74.12 examples/second between steps 97 and 98
I0417 21:50:45.498129 140198355175232 keras_utils.py:163] TimeHistory: 0.11 seconds, 112.73 examples/second between steps 98 and 99
I0417 21:50:45.697495 140198355175232 keras_utils.py:163] TimeHistory: 0.20 seconds, 60.24 examples/second between steps 99 and 100
I0417 21:50:45.697909 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 16
I0417 21:50:45.698060 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 16
INFO:tensorflow:Running non-virtual train step
I0417 21:50:45.704335 140157256722176 training.py:940] Running non-virtual train step
I0417 21:50:53.610143 140198355175232 keras_utils.py:163] TimeHistory: 7.91 seconds, 2.02 examples/second between steps 100 and 101
I0417 21:50:53.775475 140198355175232 keras_utils.py:163] TimeHistory: 0.17 seconds, 96.94 examples/second between steps 101 and 102
I0417 21:50:54.046634 140198355175232 keras_utils.py:163] TimeHistory: 0.27 seconds, 59.05 examples/second between steps 102 and 103
I0417 21:50:54.200971 140198355175232 keras_utils.py:163] TimeHistory: 0.15 seconds, 103.79 examples/second between steps 103 and 104
I0417 21:50:54.335925 140198355175232 keras_utils.py:163] TimeHistory: 0.13 seconds, 118.71 examples/second between steps 104 and 105
I0417 21:50:54.427569 140198355175232 keras_utils.py:163] TimeHistory: 0.09 seconds, 174.95 examples/second between steps 105 and 106
I0417 21:50:54.637598 140198355175232 keras_utils.py:163] TimeHistory: 0.21 seconds, 76.24 examples/second between steps 106 and 107
I0417 21:50:54.828531 140198355175232 keras_utils.py:163] TimeHistory: 0.19 seconds, 83.88 examples/second between steps 107 and 108
I0417 21:50:54.978662 140198355175232 keras_utils.py:163] TimeHistory: 0.15 seconds, 106.70 examples/second between steps 108 and 109
I0417 21:50:55.179451 140198355175232 keras_utils.py:163] TimeHistory: 0.20 seconds, 79.75 examples/second between steps 109 and 110
I0417 21:50:55.349768 140198355175232 keras_utils.py:163] TimeHistory: 0.17 seconds, 94.06 examples/second between steps 110 and 111
I0417 21:50:55.571355 140198355175232 keras_utils.py:163] TimeHistory: 0.22 seconds, 72.27 examples/second between steps 111 and 112
I0417 21:50:55.680663 140198355175232 keras_utils.py:163] TimeHistory: 0.11 seconds, 146.62 examples/second between steps 112 and 113
I0417 21:50:55.844626 140198355175232 keras_utils.py:163] TimeHistory: 0.16 seconds, 97.68 examples/second between steps 113 and 114
I0417 21:50:56.102360 140198355175232 keras_utils.py:163] TimeHistory: 0.26 seconds, 62.12 examples/second between steps 114 and 115
I0417 21:50:56.234213 140198355175232 keras_utils.py:163] TimeHistory: 0.13 seconds, 121.51 examples/second between steps 115 and 116
I0417 21:50:56.425891 140198355175232 keras_utils.py:163] TimeHistory: 0.19 seconds, 83.55 examples/second between steps 116 and 117
I0417 21:50:56.579900 140198355175232 keras_utils.py:163] TimeHistory: 0.15 seconds, 104.00 examples/second between steps 117 and 118
I0417 21:50:56.705677 140198355175232 keras_utils.py:163] TimeHistory: 0.13 seconds, 127.39 examples/second between steps 118 and 119
I0417 21:50:56.905170 140198355175232 keras_utils.py:163] TimeHistory: 0.20 seconds, 80.27 examples/second between steps 119 and 120
I0417 21:50:56.905595 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 24
I0417 21:50:56.905759 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 24
INFO:tensorflow:Running non-virtual train step
I0417 21:50:56.911970 140157248329472 training.py:940] Running non-virtual train step
I0417 21:51:04.913628 140198355175232 keras_utils.py:163] TimeHistory: 8.01 seconds, 3.00 examples/second between steps 120 and 121
I0417 21:51:05.068207 140198355175232 keras_utils.py:163] TimeHistory: 0.15 seconds, 155.54 examples/second between steps 121 and 122
I0417 21:51:05.374496 140198355175232 keras_utils.py:163] TimeHistory: 0.31 seconds, 78.42 examples/second between steps 122 and 123
I0417 21:51:05.626707 140198355175232 keras_utils.py:163] TimeHistory: 0.25 seconds, 95.24 examples/second between steps 123 and 124
I0417 21:51:05.845920 140198355175232 keras_utils.py:163] TimeHistory: 0.22 seconds, 109.58 examples/second between steps 124 and 125
I0417 21:51:06.041097 140198355175232 keras_utils.py:163] TimeHistory: 0.19 seconds, 123.09 examples/second between steps 125 and 126
I0417 21:51:06.412953 140198355175232 keras_utils.py:163] TimeHistory: 0.37 seconds, 64.57 examples/second between steps 126 and 127
I0417 21:51:06.603792 140198355175232 keras_utils.py:163] TimeHistory: 0.19 seconds, 125.88 examples/second between steps 127 and 128
I0417 21:51:06.956595 140198355175232 keras_utils.py:163] TimeHistory: 0.35 seconds, 68.06 examples/second between steps 128 and 129
I0417 21:51:07.261224 140198355175232 keras_utils.py:163] TimeHistory: 0.30 seconds, 78.83 examples/second between steps 129 and 130
I0417 21:51:07.526950 140198355175232 keras_utils.py:163] TimeHistory: 0.27 seconds, 90.39 examples/second between steps 130 and 131
I0417 21:51:07.810506 140198355175232 keras_utils.py:163] TimeHistory: 0.28 seconds, 84.70 examples/second between steps 131 and 132
I0417 21:51:08.015692 140198355175232 keras_utils.py:163] TimeHistory: 0.20 seconds, 117.09 examples/second between steps 132 and 133
I0417 21:51:08.345342 140198355175232 keras_utils.py:163] TimeHistory: 0.33 seconds, 72.84 examples/second between steps 133 and 134
I0417 21:51:08.598428 140198355175232 keras_utils.py:163] TimeHistory: 0.25 seconds, 94.90 examples/second between steps 134 and 135
I0417 21:51:08.817145 140198355175232 keras_utils.py:163] TimeHistory: 0.22 seconds, 109.83 examples/second between steps 135 and 136
I0417 21:51:08.945173 140198355175232 keras_utils.py:163] TimeHistory: 0.13 seconds, 187.72 examples/second between steps 136 and 137
I0417 21:51:09.114822 140198355175232 keras_utils.py:163] TimeHistory: 0.17 seconds, 141.63 examples/second between steps 137 and 138
I0417 21:51:09.399591 140198355175232 keras_utils.py:163] TimeHistory: 0.28 seconds, 84.33 examples/second between steps 138 and 139
I0417 21:51:09.533569 140198355175232 keras_utils.py:163] TimeHistory: 0.13 seconds, 179.37 examples/second between steps 139 and 140
I0417 21:51:09.533993 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 32
I0417 21:51:09.534144 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 32
INFO:tensorflow:Running non-virtual train step
I0417 21:51:09.540377 140157239936768 training.py:940] Running non-virtual train step
I0417 21:51:17.911329 140198355175232 keras_utils.py:163] TimeHistory: 8.38 seconds, 3.82 examples/second between steps 140 and 141
I0417 21:51:18.308960 140198355175232 keras_utils.py:163] TimeHistory: 0.40 seconds, 80.54 examples/second between steps 141 and 142
I0417 21:51:18.690207 140198355175232 keras_utils.py:163] TimeHistory: 0.38 seconds, 83.98 examples/second between steps 142 and 143
I0417 21:51:18.819339 140198355175232 keras_utils.py:163] TimeHistory: 0.13 seconds, 248.22 examples/second between steps 143 and 144
I0417 21:51:19.152245 140198355175232 keras_utils.py:163] TimeHistory: 0.33 seconds, 96.18 examples/second between steps 144 and 145
I0417 21:51:19.345543 140198355175232 keras_utils.py:163] TimeHistory: 0.19 seconds, 165.70 examples/second between steps 145 and 146
I0417 21:51:19.549204 140198355175232 keras_utils.py:163] TimeHistory: 0.20 seconds, 157.26 examples/second between steps 146 and 147
I0417 21:51:20.069485 140198355175232 keras_utils.py:163] TimeHistory: 0.52 seconds, 61.53 examples/second between steps 147 and 148
I0417 21:51:20.339829 140198355175232 keras_utils.py:163] TimeHistory: 0.27 seconds, 118.45 examples/second between steps 148 and 149
I0417 21:51:20.561719 140198355175232 keras_utils.py:163] TimeHistory: 0.22 seconds, 144.33 examples/second between steps 149 and 150
I0417 21:51:20.816640 140198355175232 keras_utils.py:163] TimeHistory: 0.25 seconds, 125.63 examples/second between steps 150 and 151
I0417 21:51:21.125656 140198355175232 keras_utils.py:163] TimeHistory: 0.31 seconds, 103.62 examples/second between steps 151 and 152
I0417 21:51:21.419656 140198355175232 keras_utils.py:163] TimeHistory: 0.29 seconds, 108.91 examples/second between steps 152 and 153
I0417 21:51:21.775582 140198355175232 keras_utils.py:163] TimeHistory: 0.36 seconds, 89.95 examples/second between steps 153 and 154
I0417 21:51:22.173669 140198355175232 keras_utils.py:163] TimeHistory: 0.40 seconds, 80.43 examples/second between steps 154 and 155
I0417 21:51:22.555975 140198355175232 keras_utils.py:163] TimeHistory: 0.38 seconds, 83.74 examples/second between steps 155 and 156
I0417 21:51:22.889250 140198355175232 keras_utils.py:163] TimeHistory: 0.33 seconds, 96.07 examples/second between steps 156 and 157
I0417 21:51:23.385869 140198355175232 keras_utils.py:163] TimeHistory: 0.50 seconds, 64.46 examples/second between steps 157 and 158
I0417 21:51:23.541306 140198355175232 keras_utils.py:163] TimeHistory: 0.16 seconds, 206.11 examples/second between steps 158 and 159
I0417 21:51:23.712166 140198355175232 keras_utils.py:163] TimeHistory: 0.17 seconds, 187.49 examples/second between steps 159 and 160
I0417 21:51:23.712641 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 48
I0417 21:51:23.712815 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 48
INFO:tensorflow:Running non-virtual train step
I0417 21:51:23.719041 140157231544064 training.py:940] Running non-virtual train step
I0417 21:51:31.764829 140198355175232 keras_utils.py:163] TimeHistory: 8.05 seconds, 5.96 examples/second between steps 160 and 161
I0417 21:51:32.298632 140198355175232 keras_utils.py:163] TimeHistory: 0.53 seconds, 89.97 examples/second between steps 161 and 162
I0417 21:51:32.692575 140198355175232 keras_utils.py:163] TimeHistory: 0.39 seconds, 121.93 examples/second between steps 162 and 163
I0417 21:51:33.184454 140198355175232 keras_utils.py:163] TimeHistory: 0.49 seconds, 97.63 examples/second between steps 163 and 164
I0417 21:51:33.880870 140198355175232 keras_utils.py:163] TimeHistory: 0.70 seconds, 68.95 examples/second between steps 164 and 165
I0417 21:51:34.190022 140198355175232 keras_utils.py:163] TimeHistory: 0.31 seconds, 155.37 examples/second between steps 165 and 166
I0417 21:51:34.812596 140198355175232 keras_utils.py:163] TimeHistory: 0.62 seconds, 77.12 examples/second between steps 166 and 167
I0417 21:51:35.106202 140198355175232 keras_utils.py:163] TimeHistory: 0.29 seconds, 163.60 examples/second between steps 167 and 168
I0417 21:51:35.436486 140198355175232 keras_utils.py:163] TimeHistory: 0.33 seconds, 145.41 examples/second between steps 168 and 169
I0417 21:51:36.000078 140198355175232 keras_utils.py:163] TimeHistory: 0.56 seconds, 85.20 examples/second between steps 169 and 170
I0417 21:51:36.672614 140198355175232 keras_utils.py:163] TimeHistory: 0.67 seconds, 71.40 examples/second between steps 170 and 171
I0417 21:51:36.942454 140198355175232 keras_utils.py:163] TimeHistory: 0.27 seconds, 178.05 examples/second between steps 171 and 172
I0417 21:51:37.284578 140198355175232 keras_utils.py:163] TimeHistory: 0.34 seconds, 140.41 examples/second between steps 172 and 173
I0417 21:51:37.797742 140198355175232 keras_utils.py:163] TimeHistory: 0.51 seconds, 93.58 examples/second between steps 173 and 174
I0417 21:51:38.023001 140198355175232 keras_utils.py:163] TimeHistory: 0.23 seconds, 213.31 examples/second between steps 174 and 175
I0417 21:51:38.559810 140198355175232 keras_utils.py:163] TimeHistory: 0.54 seconds, 89.45 examples/second between steps 175 and 176
I0417 21:51:38.929660 140198355175232 keras_utils.py:163] TimeHistory: 0.37 seconds, 129.86 examples/second between steps 176 and 177
I0417 21:51:39.321902 140198355175232 keras_utils.py:163] TimeHistory: 0.39 seconds, 122.45 examples/second between steps 177 and 178
I0417 21:51:39.812060 140198355175232 keras_utils.py:163] TimeHistory: 0.49 seconds, 97.97 examples/second between steps 178 and 179
I0417 21:51:40.433730 140198355175232 keras_utils.py:163] TimeHistory: 0.62 seconds, 77.24 examples/second between steps 179 and 180
I0417 21:51:40.434218 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 64
I0417 21:51:40.434388 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 64
INFO:tensorflow:Running non-virtual train step
I0417 21:51:40.440609 140157223151360 training.py:940] Running non-virtual train step
I0417 21:51:48.876808 140198355175232 keras_utils.py:163] TimeHistory: 8.44 seconds, 7.58 examples/second between steps 180 and 181
I0417 21:51:49.503795 140198355175232 keras_utils.py:163] TimeHistory: 0.63 seconds, 102.12 examples/second between steps 181 and 182
I0417 21:51:50.408104 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 70.79 examples/second between steps 182 and 183
I0417 21:51:51.281749 140198355175232 keras_utils.py:163] TimeHistory: 0.87 seconds, 73.28 examples/second between steps 183 and 184
I0417 21:51:51.963529 140198355175232 keras_utils.py:163] TimeHistory: 0.68 seconds, 93.91 examples/second between steps 184 and 185
I0417 21:51:52.360809 140198355175232 keras_utils.py:163] TimeHistory: 0.40 seconds, 161.20 examples/second between steps 185 and 186
I0417 21:51:52.722461 140198355175232 keras_utils.py:163] TimeHistory: 0.36 seconds, 177.08 examples/second between steps 186 and 187
I0417 21:51:53.242527 140198355175232 keras_utils.py:163] TimeHistory: 0.52 seconds, 123.12 examples/second between steps 187 and 188
I0417 21:51:53.627471 140198355175232 keras_utils.py:163] TimeHistory: 0.38 seconds, 166.35 examples/second between steps 188 and 189
I0417 21:51:54.200824 140198355175232 keras_utils.py:163] TimeHistory: 0.57 seconds, 111.66 examples/second between steps 189 and 190
I0417 21:51:54.693996 140198355175232 keras_utils.py:163] TimeHistory: 0.49 seconds, 129.83 examples/second between steps 190 and 191
I0417 21:51:55.447243 140198355175232 keras_utils.py:163] TimeHistory: 0.75 seconds, 84.99 examples/second between steps 191 and 192
I0417 21:51:56.001133 140198355175232 keras_utils.py:163] TimeHistory: 0.55 seconds, 115.60 examples/second between steps 192 and 193
I0417 21:51:56.714072 140198355175232 keras_utils.py:163] TimeHistory: 0.71 seconds, 89.80 examples/second between steps 193 and 194
I0417 21:51:57.051720 140198355175232 keras_utils.py:163] TimeHistory: 0.34 seconds, 189.69 examples/second between steps 194 and 195
I0417 21:51:57.670004 140198355175232 keras_utils.py:163] TimeHistory: 0.62 seconds, 103.55 examples/second between steps 195 and 196
I0417 21:51:58.348604 140198355175232 keras_utils.py:163] TimeHistory: 0.68 seconds, 94.34 examples/second between steps 196 and 197
I0417 21:51:58.552448 140198355175232 keras_utils.py:163] TimeHistory: 0.20 seconds, 314.32 examples/second between steps 197 and 198
I0417 21:51:59.070013 140198355175232 keras_utils.py:163] TimeHistory: 0.52 seconds, 123.71 examples/second between steps 198 and 199
I0417 21:51:59.823454 140198355175232 keras_utils.py:163] TimeHistory: 0.75 seconds, 84.97 examples/second between steps 199 and 200
I0417 21:51:59.824024 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 96
I0417 21:51:59.824221 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 96
INFO:tensorflow:Running non-virtual train step
I0417 21:51:59.830939 140157214758656 training.py:940] Running non-virtual train step
I0417 21:52:08.670442 140198355175232 keras_utils.py:163] TimeHistory: 8.85 seconds, 10.85 examples/second between steps 200 and 201
I0417 21:52:09.016076 140198355175232 keras_utils.py:163] TimeHistory: 0.35 seconds, 278.00 examples/second between steps 201 and 202
I0417 21:52:09.919611 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 106.28 examples/second between steps 202 and 203
I0417 21:52:10.780135 140198355175232 keras_utils.py:163] TimeHistory: 0.86 seconds, 111.59 examples/second between steps 203 and 204
I0417 21:52:11.524791 140198355175232 keras_utils.py:163] TimeHistory: 0.74 seconds, 128.96 examples/second between steps 204 and 205
I0417 21:52:12.432523 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 105.79 examples/second between steps 205 and 206
I0417 21:52:13.050097 140198355175232 keras_utils.py:163] TimeHistory: 0.62 seconds, 155.51 examples/second between steps 206 and 207
I0417 21:52:13.958588 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 105.70 examples/second between steps 207 and 208
I0417 21:52:14.353083 140198355175232 keras_utils.py:163] TimeHistory: 0.39 seconds, 243.50 examples/second between steps 208 and 209
I0417 21:52:14.905662 140198355175232 keras_utils.py:163] TimeHistory: 0.55 seconds, 173.81 examples/second between steps 209 and 210
I0417 21:52:15.568622 140198355175232 keras_utils.py:163] TimeHistory: 0.66 seconds, 144.86 examples/second between steps 210 and 211
I0417 21:52:16.470221 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 106.51 examples/second between steps 211 and 212
I0417 21:52:17.039632 140198355175232 keras_utils.py:163] TimeHistory: 0.57 seconds, 168.67 examples/second between steps 212 and 213
I0417 21:52:17.736303 140198355175232 keras_utils.py:163] TimeHistory: 0.70 seconds, 137.87 examples/second between steps 213 and 214
I0417 21:52:18.639492 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 106.32 examples/second between steps 214 and 215
I0417 21:52:19.547786 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 105.72 examples/second between steps 215 and 216
I0417 21:52:20.451693 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 106.24 examples/second between steps 216 and 217
I0417 21:52:20.832041 140198355175232 keras_utils.py:163] TimeHistory: 0.38 seconds, 252.58 examples/second between steps 217 and 218
I0417 21:52:21.690123 140198355175232 keras_utils.py:163] TimeHistory: 0.86 seconds, 111.91 examples/second between steps 218 and 219
I0417 21:52:22.598326 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 105.73 examples/second between steps 219 and 220
I0417 21:52:22.598903 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 128
I0417 21:52:22.599119 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 128
INFO:tensorflow:Running non-virtual train step
I0417 21:52:22.605524 140156661135104 training.py:940] Running non-virtual train step
I0417 21:52:31.104817 140198355175232 keras_utils.py:163] TimeHistory: 8.51 seconds, 15.05 examples/second between steps 220 and 221
I0417 21:52:32.008114 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 141.75 examples/second between steps 221 and 222
I0417 21:52:32.642723 140198355175232 keras_utils.py:163] TimeHistory: 0.63 seconds, 201.79 examples/second between steps 222 and 223
I0417 21:52:33.222849 140198355175232 keras_utils.py:163] TimeHistory: 0.58 seconds, 220.75 examples/second between steps 223 and 224
I0417 21:52:33.628558 140198355175232 keras_utils.py:163] TimeHistory: 0.41 seconds, 315.71 examples/second between steps 224 and 225
I0417 21:52:34.518985 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 143.79 examples/second between steps 225 and 226
I0417 21:52:35.429098 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 140.68 examples/second between steps 226 and 227
I0417 21:52:36.339442 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 140.65 examples/second between steps 227 and 228
I0417 21:52:37.202236 140198355175232 keras_utils.py:163] TimeHistory: 0.86 seconds, 148.40 examples/second between steps 228 and 229
I0417 21:52:38.105369 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 141.77 examples/second between steps 229 and 230
I0417 21:52:38.860298 140198355175232 keras_utils.py:163] TimeHistory: 0.75 seconds, 169.61 examples/second between steps 230 and 231
I0417 21:52:39.583761 140198355175232 keras_utils.py:163] TimeHistory: 0.72 seconds, 177.00 examples/second between steps 231 and 232
I0417 21:52:40.487401 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 141.70 examples/second between steps 232 and 233
I0417 21:52:41.176861 140198355175232 keras_utils.py:163] TimeHistory: 0.69 seconds, 185.72 examples/second between steps 233 and 234
I0417 21:52:41.741746 140198355175232 keras_utils.py:163] TimeHistory: 0.56 seconds, 226.69 examples/second between steps 234 and 235
I0417 21:52:42.645462 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 141.68 examples/second between steps 235 and 236
I0417 21:52:43.554904 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 140.79 examples/second between steps 236 and 237
I0417 21:52:44.453720 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 142.45 examples/second between steps 237 and 238
I0417 21:52:45.358375 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 141.53 examples/second between steps 238 and 239
I0417 21:52:46.249300 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 143.71 examples/second between steps 239 and 240
I0417 21:52:46.249800 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 192
I0417 21:52:46.249987 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 192
INFO:tensorflow:Running non-virtual train step
I0417 21:52:46.256653 140156652742400 training.py:940] Running non-virtual train step
I0417 21:52:54.772246 140198355175232 keras_utils.py:163] TimeHistory: 8.52 seconds, 22.53 examples/second between steps 240 and 241
I0417 21:52:55.677532 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 212.16 examples/second between steps 241 and 242
I0417 21:52:56.581643 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 212.42 examples/second between steps 242 and 243
I0417 21:52:57.486325 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 212.30 examples/second between steps 243 and 244
I0417 21:52:58.392866 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 211.86 examples/second between steps 244 and 245
I0417 21:52:59.290197 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 214.03 examples/second between steps 245 and 246
I0417 21:53:00.187005 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 214.16 examples/second between steps 246 and 247
I0417 21:53:01.081381 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 214.74 examples/second between steps 247 and 248
I0417 21:53:01.992257 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 210.85 examples/second between steps 248 and 249
I0417 21:53:02.897271 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 212.21 examples/second between steps 249 and 250
I0417 21:53:03.787776 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 215.67 examples/second between steps 250 and 251
I0417 21:53:04.679107 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 215.47 examples/second between steps 251 and 252
I0417 21:53:05.574514 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 214.49 examples/second between steps 252 and 253
I0417 21:53:06.273910 140198355175232 keras_utils.py:163] TimeHistory: 0.70 seconds, 274.62 examples/second between steps 253 and 254
I0417 21:53:07.177292 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 212.59 examples/second between steps 254 and 255
I0417 21:53:08.081718 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 212.35 examples/second between steps 255 and 256
I0417 21:53:08.988690 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 211.75 examples/second between steps 256 and 257
I0417 21:53:09.883741 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 214.57 examples/second between steps 257 and 258
I0417 21:53:10.787797 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 212.43 examples/second between steps 258 and 259
I0417 21:53:11.685370 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 213.97 examples/second between steps 259 and 260
I0417 21:53:11.685931 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 256
I0417 21:53:11.686136 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 256
INFO:tensorflow:Running non-virtual train step
I0417 21:53:11.692848 140156644349696 training.py:940] Running non-virtual train step
I0417 21:53:20.645314 140198355175232 keras_utils.py:163] TimeHistory: 8.96 seconds, 28.57 examples/second between steps 260 and 261
I0417 21:53:21.552820 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 282.19 examples/second between steps 261 and 262
I0417 21:53:22.442917 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 287.70 examples/second between steps 262 and 263
I0417 21:53:23.346503 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 283.39 examples/second between steps 263 and 264
I0417 21:53:24.249625 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 283.54 examples/second between steps 264 and 265
I0417 21:53:25.152703 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 283.55 examples/second between steps 265 and 266
I0417 21:53:26.045799 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 286.72 examples/second between steps 266 and 267
I0417 21:53:26.948486 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 283.68 examples/second between steps 267 and 268
I0417 21:53:27.855996 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 282.19 examples/second between steps 268 and 269
I0417 21:53:28.759800 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 283.33 examples/second between steps 269 and 270
I0417 21:53:29.652472 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 286.86 examples/second between steps 270 and 271
I0417 21:53:30.547700 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 286.03 examples/second between steps 271 and 272
I0417 21:53:31.439046 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 287.29 examples/second between steps 272 and 273
I0417 21:53:32.334468 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 285.97 examples/second between steps 273 and 274
I0417 21:53:33.238414 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 283.28 examples/second between steps 274 and 275
I0417 21:53:34.141367 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 283.59 examples/second between steps 275 and 276
I0417 21:53:35.052289 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 281.10 examples/second between steps 276 and 277
I0417 21:53:35.944988 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 286.85 examples/second between steps 277 and 278
I0417 21:53:36.852487 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 282.17 examples/second between steps 278 and 279
I0417 21:53:37.750309 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 285.21 examples/second between steps 279 and 280
I0417 21:53:37.750891 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 384
I0417 21:53:37.751106 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 384
INFO:tensorflow:Running non-virtual train step
I0417 21:53:37.757859 140156635956992 training.py:940] Running non-virtual train step
I0417 21:53:46.279545 140198355175232 keras_utils.py:163] TimeHistory: 8.53 seconds, 45.03 examples/second between steps 280 and 281
I0417 21:53:47.187914 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 422.87 examples/second between steps 281 and 282
I0417 21:53:48.095034 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 423.44 examples/second between steps 282 and 283
I0417 21:53:48.985054 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 431.58 examples/second between steps 283 and 284
I0417 21:53:49.886562 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 426.07 examples/second between steps 284 and 285
I0417 21:53:50.797852 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 421.50 examples/second between steps 285 and 286
I0417 21:53:51.705955 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 422.97 examples/second between steps 286 and 287
I0417 21:53:52.610039 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 424.86 examples/second between steps 287 and 288
I0417 21:53:53.512050 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 425.83 examples/second between steps 288 and 289
I0417 21:53:54.405784 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 429.78 examples/second between steps 289 and 290
I0417 21:53:55.316544 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 421.74 examples/second between steps 290 and 291
I0417 21:53:56.220143 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 425.08 examples/second between steps 291 and 292
I0417 21:53:57.120762 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 426.48 examples/second between steps 292 and 293
I0417 21:53:58.024726 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 424.91 examples/second between steps 293 and 294
I0417 21:53:58.913927 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 431.96 examples/second between steps 294 and 295
I0417 21:53:59.809062 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 429.10 examples/second between steps 295 and 296
I0417 21:54:00.701547 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 430.37 examples/second between steps 296 and 297
I0417 21:54:01.597286 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 428.81 examples/second between steps 297 and 298
I0417 21:54:02.505710 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 422.82 examples/second between steps 298 and 299
I0417 21:54:03.401862 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 428.61 examples/second between steps 299 and 300
I0417 21:54:03.402373 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 512
I0417 21:54:03.402547 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 512
INFO:tensorflow:Running non-virtual train step
I0417 21:54:03.408957 140156611573504 training.py:940] Running non-virtual train step
I0417 21:54:11.916267 140198355175232 keras_utils.py:163] TimeHistory: 8.51 seconds, 60.14 examples/second between steps 300 and 301
I0417 21:54:12.813788 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 570.63 examples/second between steps 301 and 302
I0417 21:54:13.711713 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 570.36 examples/second between steps 302 and 303
I0417 21:54:14.621223 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 563.09 examples/second between steps 303 and 304
I0417 21:54:15.525923 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 566.08 examples/second between steps 304 and 305
I0417 21:54:16.425674 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 569.20 examples/second between steps 305 and 306
I0417 21:54:17.330499 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 566.01 examples/second between steps 306 and 307
I0417 21:54:18.234233 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 566.69 examples/second between steps 307 and 308
I0417 21:54:19.135692 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 568.14 examples/second between steps 308 and 309
I0417 21:54:20.044535 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 563.51 examples/second between steps 309 and 310
I0417 21:54:20.934097 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 575.73 examples/second between steps 310 and 311
I0417 21:54:21.837011 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 567.21 examples/second between steps 311 and 312
I0417 21:54:22.727355 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 575.21 examples/second between steps 312 and 313
I0417 21:54:23.626601 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 569.53 examples/second between steps 313 and 314
I0417 21:54:24.534939 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 563.81 examples/second between steps 314 and 315
I0417 21:54:25.444253 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 563.20 examples/second between steps 315 and 316
I0417 21:54:26.336306 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 574.10 examples/second between steps 316 and 317
I0417 21:54:27.233299 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 570.94 examples/second between steps 317 and 318
I0417 21:54:28.127122 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 572.97 examples/second between steps 318 and 319
I0417 21:54:29.031088 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 566.56 examples/second between steps 319 and 320
I0417 21:54:29.031671 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 768
I0417 21:54:29.031867 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 768
INFO:tensorflow:Running non-virtual train step
I0417 21:54:29.038293 140156250879744 training.py:940] Running non-virtual train step
I0417 21:54:37.547561 140198355175232 keras_utils.py:163] TimeHistory: 8.52 seconds, 90.19 examples/second between steps 320 and 321
I0417 21:54:38.455588 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 846.04 examples/second between steps 321 and 322
I0417 21:54:39.344781 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 863.95 examples/second between steps 322 and 323
I0417 21:54:40.239783 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 858.32 examples/second between steps 323 and 324
I0417 21:54:41.037960 140198355175232 keras_utils.py:163] TimeHistory: 0.80 seconds, 962.47 examples/second between steps 324 and 325
I0417 21:54:41.948272 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 843.89 examples/second between steps 325 and 326
I0417 21:54:42.849656 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 852.24 examples/second between steps 326 and 327
I0417 21:54:43.758072 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 845.65 examples/second between steps 327 and 328
I0417 21:54:44.652813 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 858.59 examples/second between steps 328 and 329
I0417 21:54:45.547732 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 858.41 examples/second between steps 329 and 330
I0417 21:54:46.457974 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 843.94 examples/second between steps 330 and 331
I0417 21:54:47.359408 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 852.21 examples/second between steps 331 and 332
I0417 21:54:48.250933 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 861.67 examples/second between steps 332 and 333
I0417 21:54:49.147999 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 856.39 examples/second between steps 333 and 334
I0417 21:54:50.043200 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 858.14 examples/second between steps 334 and 335
I0417 21:54:50.934696 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 861.71 examples/second between steps 335 and 336
I0417 21:54:51.838994 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 849.50 examples/second between steps 336 and 337
I0417 21:54:52.743693 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 849.12 examples/second between steps 337 and 338
I0417 21:54:53.639782 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 857.28 examples/second between steps 338 and 339
I0417 21:54:54.547731 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 846.08 examples/second between steps 339 and 340
I0417 21:54:54.548214 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 1024
I0417 21:54:54.548396 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 1024
INFO:tensorflow:Running non-virtual train step
I0417 21:54:54.554760 140156226234112 training.py:940] Running non-virtual train step
I0417 21:55:03.581337 140198355175232 keras_utils.py:163] TimeHistory: 9.03 seconds, 113.36 examples/second between steps 340 and 341
I0417 21:55:04.489969 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 1127.31 examples/second between steps 341 and 342
I0417 21:55:05.389955 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 1138.10 examples/second between steps 342 and 343
I0417 21:55:06.297316 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 1128.85 examples/second between steps 343 and 344
I0417 21:55:07.204996 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 1128.42 examples/second between steps 344 and 345
I0417 21:55:08.113558 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 1127.35 examples/second between steps 345 and 346
I0417 21:55:09.014628 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 1136.73 examples/second between steps 346 and 347
I0417 21:55:09.905205 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 1150.14 examples/second between steps 347 and 348
I0417 21:55:10.812021 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 1129.52 examples/second between steps 348 and 349
I0417 21:55:11.715271 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 1134.02 examples/second between steps 349 and 350
I0417 21:55:12.606013 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 1149.94 examples/second between steps 350 and 351
I0417 21:55:13.496924 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 1149.71 examples/second between steps 351 and 352
I0417 21:55:14.404732 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 1128.31 examples/second between steps 352 and 353
I0417 21:55:15.313860 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 1126.68 examples/second between steps 353 and 354
I0417 21:55:16.216391 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 1134.88 examples/second between steps 354 and 355
I0417 21:55:17.113697 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 1141.50 examples/second between steps 355 and 356
I0417 21:55:18.015389 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 1135.96 examples/second between steps 356 and 357
I0417 21:55:18.910335 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 1144.56 examples/second between steps 357 and 358
I0417 21:55:19.807052 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 1142.24 examples/second between steps 358 and 359
I0417 21:55:20.713177 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 1130.41 examples/second between steps 359 and 360
I0417 21:55:20.713691 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 1536
I0417 21:55:20.713884 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 1536
INFO:tensorflow:Running non-virtual train step
I0417 21:55:20.720525 140156201326336 training.py:940] Running non-virtual train step
I0417 21:55:29.229364 140198355175232 keras_utils.py:163] TimeHistory: 8.52 seconds, 180.38 examples/second between steps 360 and 361
I0417 21:55:30.135260 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 1696.08 examples/second between steps 361 and 362
I0417 21:55:31.027546 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 1721.91 examples/second between steps 362 and 363
I0417 21:55:31.929972 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 1702.54 examples/second between steps 363 and 364
I0417 21:55:32.833631 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 1700.20 examples/second between steps 364 and 365
I0417 21:55:33.742679 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 1690.11 examples/second between steps 365 and 366
I0417 21:55:34.650367 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 1692.67 examples/second between steps 366 and 367
I0417 21:55:35.548488 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 1710.67 examples/second between steps 367 and 368
I0417 21:55:36.444648 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 1714.41 examples/second between steps 368 and 369
I0417 21:55:37.350890 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 1695.34 examples/second between steps 369 and 370
I0417 21:55:38.255855 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 1697.74 examples/second between steps 370 and 371
I0417 21:55:39.152359 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 1713.77 examples/second between steps 371 and 372
I0417 21:55:40.060402 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 1691.98 examples/second between steps 372 and 373
I0417 21:55:40.960978 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 1706.00 examples/second between steps 373 and 374
I0417 21:55:41.866236 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 1697.19 examples/second between steps 374 and 375
I0417 21:55:42.754902 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 1728.86 examples/second between steps 375 and 376
I0417 21:55:43.647687 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 1720.89 examples/second between steps 376 and 377
I0417 21:55:44.545291 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 1711.70 examples/second between steps 377 and 378
I0417 21:55:45.439071 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 1718.98 examples/second between steps 378 and 379
I0417 21:55:46.335910 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 1713.16 examples/second between steps 379 and 380
I0417 21:55:46.336481 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 2048
I0417 21:55:46.336696 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 2048
INFO:tensorflow:Running non-virtual train step
I0417 21:55:46.343477 140155974842112 training.py:940] Running non-virtual train step
I0417 21:55:54.932660 140198355175232 keras_utils.py:163] TimeHistory: 8.60 seconds, 238.25 examples/second between steps 380 and 381
I0417 21:55:55.836533 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 2266.51 examples/second between steps 381 and 382
I0417 21:55:56.742837 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 2260.32 examples/second between steps 382 and 383
I0417 21:55:57.638515 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 2287.14 examples/second between steps 383 and 384
I0417 21:55:58.537019 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 2280.00 examples/second between steps 384 and 385
I0417 21:55:59.444101 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 2258.38 examples/second between steps 385 and 386
I0417 21:56:00.348138 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 2265.99 examples/second between steps 386 and 387
I0417 21:56:01.256058 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 2256.38 examples/second between steps 387 and 388
I0417 21:56:02.156554 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 2274.86 examples/second between steps 388 and 389
I0417 21:56:03.044994 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 2305.75 examples/second between steps 389 and 390
I0417 21:56:03.933830 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 2304.75 examples/second between steps 390 and 391
I0417 21:56:04.827450 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 2292.37 examples/second between steps 391 and 392
I0417 21:56:05.733524 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 2260.85 examples/second between steps 392 and 393
I0417 21:56:06.639436 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 2261.26 examples/second between steps 393 and 394
I0417 21:56:07.530310 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 2299.48 examples/second between steps 394 and 395
I0417 21:56:08.438845 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 2254.73 examples/second between steps 395 and 396
I0417 21:56:09.342235 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 2267.62 examples/second between steps 396 and 397
I0417 21:56:10.235622 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 2292.98 examples/second between steps 397 and 398
I0417 21:56:11.145025 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 2252.56 examples/second between steps 398 and 399
I0417 21:56:12.039956 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 2289.06 examples/second between steps 399 and 400
I0417 21:56:12.040441 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 3072
I0417 21:56:12.040612 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 3072
INFO:tensorflow:Running non-virtual train step
I0417 21:56:12.046982 140155949934336 training.py:940] Running non-virtual train step
I0417 21:56:20.509399 140198355175232 keras_utils.py:163] TimeHistory: 8.47 seconds, 362.74 examples/second between steps 400 and 401
I0417 21:56:21.401623 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 3444.12 examples/second between steps 401 and 402
I0417 21:56:22.302110 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 3412.34 examples/second between steps 402 and 403
I0417 21:56:23.197548 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 3431.59 examples/second between steps 403 and 404
I0417 21:56:24.093531 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 3429.56 examples/second between steps 404 and 405
I0417 21:56:24.996042 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 3404.70 examples/second between steps 405 and 406
I0417 21:56:25.894377 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 3420.47 examples/second between steps 406 and 407
I0417 21:56:26.797389 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 3402.74 examples/second between steps 407 and 408
I0417 21:56:27.704937 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 3385.73 examples/second between steps 408 and 409
I0417 21:56:28.615030 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 3376.27 examples/second between steps 409 and 410
I0417 21:56:29.522482 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 3386.19 examples/second between steps 410 and 411
I0417 21:56:30.425678 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 3402.09 examples/second between steps 411 and 412
I0417 21:56:31.332968 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 3386.73 examples/second between steps 412 and 413
I0417 21:56:32.222351 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 3454.95 examples/second between steps 413 and 414
I0417 21:56:33.116169 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 3437.85 examples/second between steps 414 and 415
I0417 21:56:34.013883 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 3422.93 examples/second between steps 415 and 416
I0417 21:56:34.908408 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 3435.06 examples/second between steps 416 and 417
I0417 21:56:35.809378 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 3410.45 examples/second between steps 417 and 418
I0417 21:56:36.712852 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 3401.03 examples/second between steps 418 and 419
I0417 21:56:37.611400 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 3419.77 examples/second between steps 419 and 420
I0417 21:56:37.611874 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 4096
I0417 21:56:37.612080 140198355175232 training.py:1298] Heterogeneous profiling: now profiling batch size 4096
INFO:tensorflow:Running non-virtual train step
I0417 21:56:37.618463 140155855828736 training.py:940] Running non-virtual train step
I0417 21:56:46.127641 140198355175232 keras_utils.py:163] TimeHistory: 8.52 seconds, 481.00 examples/second between steps 420 and 421
I0417 21:56:47.034894 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 4516.11 examples/second between steps 421 and 422
I0417 21:56:47.929947 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 4577.54 examples/second between steps 422 and 423
I0417 21:56:48.839701 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 4503.52 examples/second between steps 423 and 424
I0417 21:56:49.733039 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 4586.28 examples/second between steps 424 and 425
I0417 21:56:50.638270 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 4526.07 examples/second between steps 425 and 426
I0417 21:56:51.527651 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 4606.59 examples/second between steps 426 and 427
I0417 21:56:52.429659 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 4542.04 examples/second between steps 427 and 428
I0417 21:56:53.333351 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 4533.61 examples/second between steps 428 and 429
I0417 21:56:54.240408 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 4516.92 examples/second between steps 429 and 430
I0417 21:56:55.146766 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 4520.25 examples/second between steps 430 and 431
I0417 21:56:56.040094 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 4586.18 examples/second between steps 431 and 432
I0417 21:56:56.937679 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 4564.47 examples/second between steps 432 and 433
I0417 21:56:57.846542 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 4507.91 examples/second between steps 433 and 434
I0417 21:56:58.743535 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 4567.62 examples/second between steps 434 and 435
I0417 21:56:59.646782 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 4536.04 examples/second between steps 435 and 436
I0417 21:57:00.551121 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 4530.43 examples/second between steps 436 and 437
I0417 21:57:01.440733 140198355175232 keras_utils.py:163] TimeHistory: 0.89 seconds, 4605.44 examples/second between steps 437 and 438
I0417 21:57:02.349768 140198355175232 keras_utils.py:163] TimeHistory: 0.91 seconds, 4507.04 examples/second between steps 438 and 439
I0417 21:57:03.254591 140198355175232 keras_utils.py:163] TimeHistory: 0.90 seconds, 4528.06 examples/second between steps 439 and 440
I0417 21:57:03.255090 140198355175232 keras_utils.py:179] Wrote to /root/dev/logs/transformer-04_17_21_1618696180135/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling complete
I0417 21:57:03.255265 140198355175232 training.py:1295] Heterogeneous profiling complete
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
inputs (InputLayer)             [(None, None)]       0                                            
__________________________________________________________________________________________________
targets (InputLayer)            [(None, None)]       0                                            
__________________________________________________________________________________________________
transformer_v2 (Transformer)    (None, None, 33945)  211047424   inputs[0][0]                     
                                                                 targets[0][0]                    
__________________________________________________________________________________________________
logits (Lambda)                 (None, None, 33945)  0           transformer_v2[0][0]             
__________________________________________________________________________________________________
tf.compat.v1.shape (TFOpLambda) (3,)                 0           logits[0][0]                     
__________________________________________________________________________________________________
tf.compat.v1.shape_1 (TFOpLambd (2,)                 0           targets[0][0]                    
__________________________________________________________________________________________________
tf.__operators__.getitem (Slici ()                   0           tf.compat.v1.shape[0][0]         
__________________________________________________________________________________________________
tf.__operators__.getitem_1 (Sli ()                   0           tf.compat.v1.shape_1[0][0]       
__________________________________________________________________________________________________
tf.math.maximum (TFOpLambda)    ()                   0           tf.__operators__.getitem[0][0]   
                                                                 tf.__operators__.getitem_1[0][0] 
__________________________________________________________________________________________________
tf.math.subtract_1 (TFOpLambda) ()                   0           tf.math.maximum[0][0]            
                                                                 tf.__operators__.getitem_1[0][0] 
__________________________________________________________________________________________________
tf.compat.v1.pad_1 (TFOpLambda) (None, None)         0           targets[0][0]                    
                                                                 tf.math.subtract_1[0][0]         
__________________________________________________________________________________________________
tf.cast (TFOpLambda)            (None, None)         0           tf.compat.v1.pad_1[0][0]         
__________________________________________________________________________________________________
tf.math.subtract (TFOpLambda)   ()                   0           tf.math.maximum[0][0]            
                                                                 tf.__operators__.getitem[0][0]   
__________________________________________________________________________________________________
tf.one_hot (TFOpLambda)         (None, None, 33945)  0           tf.cast[0][0]                    
__________________________________________________________________________________________________
tf.compat.v1.pad (TFOpLambda)   (None, None, 33945)  0           logits[0][0]                     
                                                                 tf.math.subtract[0][0]           
__________________________________________________________________________________________________
tf.compat.v1.nn.softmax_cross_e (None, None)         0           tf.one_hot[0][0]                 
                                                                 tf.compat.v1.pad[0][0]           
__________________________________________________________________________________________________
tf.math.not_equal (TFOpLambda)  (None, None)         0           tf.compat.v1.pad_1[0][0]         
__________________________________________________________________________________________________
tf.math.subtract_2 (TFOpLambda) (None, None)         0           tf.compat.v1.nn.softmax_cross_ent
__________________________________________________________________________________________________
tf.cast_1 (TFOpLambda)          (None, None)         0           tf.math.not_equal[0][0]          
__________________________________________________________________________________________________
tf.math.multiply (TFOpLambda)   (None, None)         0           tf.math.subtract_2[0][0]         
                                                                 tf.cast_1[0][0]                  
__________________________________________________________________________________________________
tf.math.reduce_sum (TFOpLambda) ()                   0           tf.math.multiply[0][0]           
__________________________________________________________________________________________________
tf.math.reduce_sum_1 (TFOpLambd ()                   0           tf.cast_1[0][0]                  
__________________________________________________________________________________________________
tf.math.truediv (TFOpLambda)    ()                   0           tf.math.reduce_sum[0][0]         
                                                                 tf.math.reduce_sum_1[0][0]       
__________________________________________________________________________________________________
add_loss (AddLoss)              ()                   0           tf.math.truediv[0][0]            
==================================================================================================
Total params: 211,047,424
Trainable params: 211,047,424
Non-trainable params: 0
__________________________________________________________________________________________________
100000/100000 - 433s - loss: 7.6218
I0417 21:57:03.255925 140198355175232 transformer_main.py:369] Train history: {'loss': [7.621794700622559]}
I0417 21:57:03.256015 140198355175232 transformer_main.py:371] End train iteration at global step:100000
