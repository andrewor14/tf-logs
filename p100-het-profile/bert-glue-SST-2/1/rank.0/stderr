My commit is 46f9d67f Simulator: Refactor to compute job allocations once (/root/dev/models/deploy)

==========================================================================
My environment variables:
--------------------------------------------------------------------------
CUDNN_VERSION=7.6.2.24-1+cuda10.1
PMIX_ID=3766616065.0
BERT_CONFIG_FILE=/root/dev/dataset/bert/uncased_L-12_H-768_A-12/bert_config.json
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:
LD_LIBRARY_PATH=/usr/local/lib:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64
OMPI_FIRST_RANKS=0
MPI_HOSTS=ba38ffac2928
OMPI_MCA_orte_top_session_dir=/tmp/ompi.ba38ffac2928.0
LOG_MEMORY_ENABLED=false
PMIX_SYSTEM_TMPDIR=/tmp
EVAL_BATCH_SIZE=48
OMPI_MCA_orte_num_nodes=1
OMPI_COMMAND=run_bert_glue.sh
MODEL=bert
LANG=C.UTF-8
HFI_NO_BACKTRACE=1
HOSTNAME=ba38ffac2928
OMPI_MCA_ess_base_vpid=0
OLDPWD=/root
OMPI_MCA_initial_wdir=/root/dev/models/deploy
ENVIRONMENT=docker
TF_DIR=/root/dev/tensorflow
USE_KERAS_COMPILE_FIT=true
DATA_DIR=/root/dev/dataset/bert/finetuning
HOST_FLAG=--host ba38ffac2928
OMPI_MCA_btl_tcp_if_exclude=lo,docker0,eth1
DTYPE=fp32
NUM_CHECKPOINTS_TO_KEEP=5
OMPI_COMM_WORLD_NODE_RANK=0
NVIDIA_VISIBLE_DEVICES=all
OMPI_MCA_orte_precondition_transports=81eb00e8ee8ff918-73a76205982cd096
BASE_DIR=/root/dev
OMPI_MCA_orte_ess_node_rank=0
OMPI_MCA_shmem_RUNTIME_QUERY_hint=mmap
OMPI_COMM_WORLD_RANK=0
LOG_STEPS=1
PMIX_RANK=0
OMPI_FILE_LOCATION=/tmp/ompi.ba38ffac2928.0/pid.965/0/0
TRAIN_BATCH_SIZE=48
NCCL_VERSION=2.4.7-1+cuda10.1
OMPI_MCA_orte_local_daemon_uri=3766616064.0;tcp://10.0.1.2,172.18.0.3:33631
GLUE_TASK=SST-2
LEARNING_RATE=2e-5
HOROVOD_GPU_OPERATIONS=NCCL
PWD=/root/dev/models/deploy
NUM_GPUS_PER_NODE=8
HOME=/root
ENABLE_XLA=true
PMIX_SERVER_TMPDIR=/tmp/ompi.ba38ffac2928.0/pid.965
RUN_SCRIPT=run_bert_glue.sh
PMIX_PTL_MODULE=tcp,usock
IPATH_NO_BACKTRACE=1
JOB_NAME=bert-glue-04_17_21_1618695570972
OMPI_MCA_rmaps_base_oversubscribe=1
OMPI_MCA_orte_launch=1
CODE_DIR=/root/dev/models/official/nlp/bert
OMPI_MCA_orte_tmpdir_base=/tmp
LOG_DIR=/root/dev/logs
TIMESTAMP=04_17_21_1618695571022
MPI_HOST_FILE=/root/container_hosts/hosts.txt
NUM_VIRTUAL_NODES_PER_DEVICE=1
BERT_MODEL_NAME=uncased_L-12_H-768_A-12
OMPI_APP_CTX_NUM_PROCS=1
OMPI_MCA_orte_output_filename=/root/dev/logs/bert-glue-04_17_21_1618695570972
LOG_FILE=/dev/stderr
STEPS_PER_LOOP=1
MODELS_DIR=/root/dev/models
OMPI_MCA_orte_app_num=0
DISABLE_VIRTUAL_NODES=true
PMIX_MCA_mca_base_component_show_load_errors=1
NUM_NODES=1
OMPI_MCA_pml=ob1
PYTHON_COMMAND=/usr/bin/python3
IN_DOCKER_CONTAINER=true
BERT_MODEL_DIR=/root/dev/dataset/bert/uncased_L-12_H-768_A-12
NUM_EPOCHS=100000
PMIX_BFROP_BUFFER_TYPE=PMIX_BFROP_BUFFER_NON_DESC
MPI_HOME=/usr/local
CHECKPOINT_NAME=bert_model.ckpt
TERM=xterm
CUDA_PKG_VERSION=10-1=10.1.243-1
CUDA_VERSION=10.1.243
SKIP_EVAL=true
PMIX_DSTORE_ESH_BASE_PATH=/tmp/ompi.ba38ffac2928.0/pid.965/pmix_dstor_ds12_965
OMPI_MCA_hwloc_base_binding_policy=none
OMPI_MCA_rmaps_base_mapping_policy=node
PMIX_SERVER_URI3=3766616064.0;tcp4://127.0.0.1:53575
PMIX_SERVER_URI2=3766616064.0;tcp4://127.0.0.1:53575
NUM_STEPS=100000
OMPI_MCA_orte_hnp_uri=3766616064.0;tcp://10.0.1.2,172.18.0.3:33631
TRAIN_DIR=/root/dev/logs/bert-glue-04_17_21_1618695570972
OMPI_MCA_mpi_yield_when_idle=0
NVIDIA_DRIVER_CAPABILITIES=compute,utility
DEFAULT_NUM_GPUS_PER_NODE=8
ENABLE_CHECKPOINTS=false
DISTRIBUTION_STRATEGY=mirrored
OMPI_COMM_WORLD_LOCAL_SIZE=1
CUDA_VISIBLE_DEVICES=0
OMPI_COMM_WORLD_SIZE=1
SHLVL=3
PYTHONPATH=:/root/dev/models:/root/dev/models
OMPI_NUM_APP_CTX=1
NVIDIA_REQUIRE_CUDA=cuda>=10.1 brand=tesla,driver>=396,driver<397 brand=tesla,driver>=410,driver<411 brand=tesla,driver>=418,driver<419
OMPI_MCA_pmix=^s1,s2,cray,isolated
DEFAULT_DISTRIBUTION_STRATEGY=mirrored
PMIX_SERVER_URI21=3766616064.0;tcp4://127.0.0.1:53575
SAVED_CHECKPOINT_PATH=/root/dev/dataset/bert/uncased_L-12_H-768_A-12/bert_model.ckpt
PMIX_DSTORE_21_BASE_PATH=/tmp/ompi.ba38ffac2928.0/pid.965/pmix_dstor_ds21_965
ENABLE_MONITOR_MEMORY=false
ENABLE_HETEROGENEOUS_PROFILE=true
CUBLAS_VERSION=10.1.0.105-1
BATCH_SIZE=48
PATH=/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
PMIX_SECURITY_MODE=native
OMPI_MCA_ess=^singleton
NCCL_DEBUG=INFO
PMIX_NAMESPACE=3766616065
OMPI_MCA_orte_ess_num_procs=1
NCCL_SOCKET_IFNAME=^lo,docker0,eth1
OMPI_MCA_ess_base_jobid=3766616065
OMPI_COMM_WORLD_LOCAL_RANK=0
OMPI_UNIVERSE_SIZE=1
OMPI_MCA_orte_jobfam_session_dir=/tmp/ompi.ba38ffac2928.0/pid.965
DEFAULT_NUM_EPOCHS=1
PMIX_GDS_MODULE=ds21,ds12,hash
ENABLE_ELASTICITY=false
NUM_GPUS=1
OMPI_MCA_btl=^openib
_=/usr/bin/printenv
==========================================================================

2021-04-17 21:39:31.235516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
/usr/local/lib/python3.6/dist-packages/absl/flags/_validators.py:356: UserWarning: Flag --model_dir has a non-None default value; therefore, mark_flag_as_required will pass even if flag is not specified in the command line!
  'command line!' % flag_name)
I0417 21:39:33.343907 140366129284928 virtual_helper.py:221] Setting TF_CONFIG to {"cluster": {"worker": ["ba38ffac2928:2222"]}, "task": {"type": "worker", "index": 0}}
INFO:tensorflow:Initializing local devices since in-graph multi-worker training with `MirroredStrategy` is not supported in eager mode. TF_CONFIG will be ignored when when initializing `MirroredStrategy`.
I0417 21:39:33.345669 140366129284928 mirrored_strategy.py:306] Initializing local devices since in-graph multi-worker training with `MirroredStrategy` is not supported in eager mode. TF_CONFIG will be ignored when when initializing `MirroredStrategy`.
2021-04-17 21:39:33.345942: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-17 21:39:33.346012: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-17 21:39:33.383156: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:39:33.383846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P100-PCIE-16GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 15.90GiB deviceMemoryBandwidth: 681.88GiB/s
2021-04-17 21:39:33.383869: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-17 21:39:33.385759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-04-17 21:39:33.385817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-04-17 21:39:33.387776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-17 21:39:33.388129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-17 21:39:33.390223: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-17 21:39:33.391457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-04-17 21:39:33.395758: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-04-17 21:39:33.395876: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:39:33.396528: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:39:33.397149: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-17 21:39:33.397478: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-17 21:39:33.399861: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-17 21:39:33.400015: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:39:33.400602: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:00:04.0 name: Tesla P100-PCIE-16GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 15.90GiB deviceMemoryBandwidth: 681.88GiB/s
2021-04-17 21:39:33.400624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-17 21:39:33.400646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2021-04-17 21:39:33.400658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2021-04-17 21:39:33.400669: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-17 21:39:33.400682: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-17 21:39:33.400693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-17 21:39:33.400704: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2021-04-17 21:39:33.400731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2021-04-17 21:39:33.400794: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:39:33.401409: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:39:33.401979: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-17 21:39:33.402016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2021-04-17 21:39:34.140202: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-17 21:39:34.140244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-17 21:39:34.140252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-17 21:39:34.140505: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:39:34.141188: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:39:34.141814: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-04-17 21:39:34.142418: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14888 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:00:04.0, compute capability: 6.0)
INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
I0417 21:39:34.147396 140366129284928 mirrored_strategy.py:350] Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0',)
2021-04-17 21:39:34.150279: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-17 21:39:34.150309: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-17 21:39:34.150337: I tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1365] Profiler found 1 GPUs
2021-04-17 21:39:34.151156: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcupti.so.10.1
2021-04-17 21:39:34.251886: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1415] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI_ERROR_INSUFFICIENT_PRIVILEGES
2021-04-17 21:39:34.251938: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
I0417 21:39:34.252046 140366129284928 run_classifier.py:187] Training using TF 2.x Keras compile/fit API with distribution strategy.
I0417 21:39:37.125556 140366129284928 optimization.py:89] using Adamw optimizer
I0417 21:39:37.125855 140366129284928 optimization.py:142] gradient_clip_norm=1.000000
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:39:37.853424 140366129284928 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:39:37.854593 140366129284928 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:39:37.858469 140366129284928 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:39:37.859195 140366129284928 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
WARNING:tensorflow:The argument `steps_per_execution` is no longer experimental. Pass `steps_per_execution` instead of `experimental_steps_per_execution`.
W0417 21:39:37.859984 140366129284928 training.py:532] The argument `steps_per_execution` is no longer experimental. Pass `steps_per_execution` instead of `experimental_steps_per_execution`.
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:39:37.872842 140366129284928 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:39:37.873593 140366129284928 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:39:37.874910 140366129284928 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:39:37.875601 140366129284928 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
2021-04-17 21:39:37.907891: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-17 21:39:37.908385: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2000185000 Hz
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 1
I0417 21:39:37.950160 140366129284928 training.py:1298] Heterogeneous profiling: now profiling batch size 1
INFO:tensorflow:Running non-virtual train step
I0417 21:39:37.998199 140352509945600 training.py:940] Running non-virtual train step
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:39:41.184223 140366129284928 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
I0417 21:39:41.185943 140366129284928 cross_device_ops.py:565] Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Running non-virtual train step
I0417 21:39:42.633162 140352509945600 training.py:940] Running non-virtual train step
2021-04-17 21:39:48.771810: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa694001770 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-04-17 21:39:48.771850: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
2021-04-17 21:39:48.891352: I tensorflow/compiler/jit/xla_compilation_cache.cc:333] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2021-04-17 21:39:50.271958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
Epoch 1/100000
     1/100000 [..............................] - ETA: 775:44:03 - loss: 0.9212 - accuracy: 0.0000e+00I0417 21:40:05.877291 140366129284928 keras_utils.py:163] TimeHistory: 27.93 seconds, 0.04 examples/second between steps 0 and 1
2021-04-17 21:40:06.174716: I tensorflow/core/profiler/lib/profiler_session.cc:136] Profiler session initializing.
2021-04-17 21:40:06.174769: I tensorflow/core/profiler/lib/profiler_session.cc:155] Profiler session started.
2021-04-17 21:40:06.175617: E tensorflow/core/profiler/internal/gpu/cupti_tracer.cc:1415] function cupti_interface_->Subscribe( &subscriber_, (CUpti_CallbackFunc)ApiCallback, this)failed with error CUPTI_ERROR_INSUFFICIENT_PRIVILEGES
     2/100000 [..............................] - ETA: 35:53:23 - loss: 0.9011 - accuracy: 0.0000e+00 I0417 21:40:07.169088 140366129284928 keras_utils.py:163] TimeHistory: 0.99 seconds, 1.01 examples/second between steps 1 and 2
2021-04-17 21:40:07.171734: I tensorflow/core/profiler/lib/profiler_session.cc:71] Profiler session collecting data.
2021-04-17 21:40:07.190083: I tensorflow/core/profiler/internal/gpu/cupti_collector.cc:228]  GpuTracer has collected 0 callback api events and 0 activity events. 
2021-04-17 21:40:07.197055: I tensorflow/core/profiler/lib/profiler_session.cc:172] Profiler session tear down.
2021-04-17 21:40:07.204140: I tensorflow/core/profiler/rpc/client/save_profile.cc:137] Creating directory: /root/dev/logs/bert-glue-04_17_21_1618695570972/summaries/train/plugins/profile/2021_04_17_21_40_07
2021-04-17 21:40:07.207865: I tensorflow/core/profiler/rpc/client/save_profile.cc:143] Dumped gzipped tool data for trace.json.gz to /root/dev/logs/bert-glue-04_17_21_1618695570972/summaries/train/plugins/profile/2021_04_17_21_40_07/ba38ffac2928.trace.json.gz
2021-04-17 21:40:07.245518: I tensorflow/core/profiler/rpc/client/save_profile.cc:137] Creating directory: /root/dev/logs/bert-glue-04_17_21_1618695570972/summaries/train/plugins/profile/2021_04_17_21_40_07
2021-04-17 21:40:07.252565: I tensorflow/core/profiler/rpc/client/save_profile.cc:143] Dumped gzipped tool data for memory_profile.json.gz to /root/dev/logs/bert-glue-04_17_21_1618695570972/summaries/train/plugins/profile/2021_04_17_21_40_07/ba38ffac2928.memory_profile.json.gz
2021-04-17 21:40:07.253079: I tensorflow/core/profiler/rpc/client/capture_profile.cc:251] Creating directory: /root/dev/logs/bert-glue-04_17_21_1618695570972/summaries/train/plugins/profile/2021_04_17_21_40_07Dumped tool data for xplane.pb to /root/dev/logs/bert-glue-04_17_21_1618695570972/summaries/train/plugins/profile/2021_04_17_21_40_07/ba38ffac2928.xplane.pb
Dumped tool data for overview_page.pb to /root/dev/logs/bert-glue-04_17_21_1618695570972/summaries/train/plugins/profile/2021_04_17_21_40_07/ba38ffac2928.overview_page.pb
Dumped tool data for input_pipeline.pb to /root/dev/logs/bert-glue-04_17_21_1618695570972/summaries/train/plugins/profile/2021_04_17_21_40_07/ba38ffac2928.input_pipeline.pb
Dumped tool data for tensorflow_stats.pb to /root/dev/logs/bert-glue-04_17_21_1618695570972/summaries/train/plugins/profile/2021_04_17_21_40_07/ba38ffac2928.tensorflow_stats.pb
Dumped tool data for kernel_stats.pb to /root/dev/logs/bert-glue-04_17_21_1618695570972/summaries/train/plugins/profile/2021_04_17_21_40_07/ba38ffac2928.kernel_stats.pb

     3/100000 [..............................] - ETA: 19:49:51 - loss: 0.8547 - accuracy: 0.1111    I0417 21:40:07.304864 140366129284928 keras_utils.py:163] TimeHistory: 0.05 seconds, 20.76 examples/second between steps 2 and 3
     4/100000 [..............................] - ETA: 160:23:07 - loss: 0.8265 - accuracy: 0.2083I0417 21:40:23.199565 140366129284928 keras_utils.py:163] TimeHistory: 15.89 seconds, 0.06 examples/second between steps 3 and 4
     5/100000 [..............................] - ETA: 120:39:35 - loss: 0.8137 - accuracy: 0.2467I0417 21:40:23.252853 140366129284928 keras_utils.py:163] TimeHistory: 0.05 seconds, 19.75 examples/second between steps 4 and 5
I0417 21:40:23.301158 140366129284928 keras_utils.py:163] TimeHistory: 0.05 seconds, 21.32 examples/second between steps 5 and 6
     7/100000 [..............................] - ETA: 80:53:08 - loss: 0.7974 - accuracy: 0.2646 I0417 21:40:23.349461 140366129284928 keras_utils.py:163] TimeHistory: 0.05 seconds, 21.36 examples/second between steps 6 and 7
I0417 21:40:23.397678 140366129284928 keras_utils.py:163] TimeHistory: 0.05 seconds, 21.30 examples/second between steps 7 and 8
     9/100000 [..............................] - ETA: 60:59:43 - loss: 0.7794 - accuracy: 0.2969I0417 21:40:23.445152 140366129284928 keras_utils.py:163] TimeHistory: 0.05 seconds, 21.65 examples/second between steps 8 and 9
    10/100000 [..............................] - ETA: 103:15:32 - loss: 0.7712 - accuracy: 0.3172I0417 21:40:39.336501 140366129284928 keras_utils.py:163] TimeHistory: 15.89 seconds, 0.06 examples/second between steps 9 and 10
    11/100000 [..............................] - ETA: 93:05:12 - loss: 0.7658 - accuracy: 0.3297 I0417 21:40:39.391913 140366129284928 keras_utils.py:163] TimeHistory: 0.05 seconds, 18.90 examples/second between steps 10 and 11
I0417 21:40:39.440659 140366129284928 keras_utils.py:163] TimeHistory: 0.05 seconds, 21.15 examples/second between steps 11 and 12
    13/100000 [..............................] - ETA: 77:47:46 - loss: 0.7599 - accuracy: 0.3465I0417 21:40:39.489289 140366129284928 keras_utils.py:163] TimeHistory: 0.05 seconds, 21.17 examples/second between steps 12 and 13
    14/100000 [..............................] - ETA: 106:28:01 - loss: 0.7573 - accuracy: 0.3524I0417 21:40:55.710861 140366129284928 keras_utils.py:163] TimeHistory: 16.22 seconds, 0.06 examples/second between steps 13 and 14
I0417 21:40:55.757884 140366129284928 keras_utils.py:163] TimeHistory: 0.04 seconds, 22.47 examples/second between steps 14 and 15
    16/100000 [..............................] - ETA: 92:26:00 - loss: 0.7524 - accuracy: 0.3607 I0417 21:40:55.799010 140366129284928 keras_utils.py:163] TimeHistory: 0.04 seconds, 25.17 examples/second between steps 15 and 16
I0417 21:40:55.839342 140366129284928 keras_utils.py:163] TimeHistory: 0.04 seconds, 25.63 examples/second between steps 16 and 17
    18/100000 [..............................] - ETA: 81:42:10 - loss: 0.7491 - accuracy: 0.3651I0417 21:40:55.888076 140366129284928 keras_utils.py:163] TimeHistory: 0.05 seconds, 21.09 examples/second between steps 17 and 18
I0417 21:40:55.935967 140366129284928 keras_utils.py:163] TimeHistory: 0.05 seconds, 21.46 examples/second between steps 18 and 19
    20/100000 [..............................] - ETA: 96:20:30 - loss: 0.7496 - accuracy: 0.3645I0417 21:41:11.788156 140366129284928 keras_utils.py:163] TimeHistory: 15.85 seconds, 0.06 examples/second between steps 19 and 20
I0417 21:41:11.791222 140366129284928 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695570972/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 2
I0417 21:41:11.791516 140366129284928 training.py:1298] Heterogeneous profiling: now profiling batch size 2
INFO:tensorflow:Running non-virtual train step
I0417 21:41:11.803724 140359697499904 training.py:940] Running non-virtual train step
    21/100000 [..............................] - ETA: 125:25:47 - loss: 0.7495 - accuracy: 0.3666I0417 21:41:36.205907 140366129284928 keras_utils.py:163] TimeHistory: 24.41 seconds, 0.08 examples/second between steps 20 and 21
    22/100000 [..............................] - ETA: 119:31:59 - loss: 0.7490 - accuracy: 0.3689I0417 21:41:36.263940 140366129284928 keras_utils.py:163] TimeHistory: 0.06 seconds, 36.21 examples/second between steps 21 and 22
    23/100000 [..............................] - ETA: 115:21:34 - loss: 0.7484 - accuracy: 0.3696I0417 21:41:37.262956 140366129284928 keras_utils.py:163] TimeHistory: 1.00 seconds, 2.00 examples/second between steps 22 and 23
    24/100000 [..............................] - ETA: 110:25:09 - loss: 0.7475 - accuracy: 0.3720I0417 21:41:37.326065 140366129284928 keras_utils.py:163] TimeHistory: 0.06 seconds, 32.57 examples/second between steps 23 and 24
    25/100000 [..............................] - ETA: 105:53:23 - loss: 0.7464 - accuracy: 0.3758I0417 21:41:37.388605 140366129284928 keras_utils.py:163] TimeHistory: 0.06 seconds, 32.68 examples/second between steps 24 and 25
    26/100000 [..............................] - ETA: 121:13:20 - loss: 0.7452 - accuracy: 0.3794I0417 21:41:55.005853 140366129284928 keras_utils.py:163] TimeHistory: 17.62 seconds, 0.11 examples/second between steps 25 and 26
    27/100000 [..............................] - ETA: 116:37:08 - loss: 0.7437 - accuracy: 0.3839I0417 21:41:55.061767 140366129284928 keras_utils.py:163] TimeHistory: 0.05 seconds, 37.55 examples/second between steps 26 and 27
    28/100000 [..............................] - ETA: 112:21:53 - loss: 0.7425 - accuracy: 0.3870I0417 21:41:55.126169 140366129284928 keras_utils.py:163] TimeHistory: 0.06 seconds, 31.82 examples/second between steps 27 and 28
    29/100000 [..............................] - ETA: 108:24:44 - loss: 0.7411 - accuracy: 0.3909I0417 21:41:55.188266 140366129284928 keras_utils.py:163] TimeHistory: 0.06 seconds, 32.92 examples/second between steps 28 and 29
    30/100000 [..............................] - ETA: 104:43:56 - loss: 0.7397 - accuracy: 0.3954I0417 21:41:55.250371 140366129284928 keras_utils.py:163] TimeHistory: 0.06 seconds, 32.89 examples/second between steps 29 and 30
    31/100000 [..............................] - ETA: 101:17:51 - loss: 0.7384 - accuracy: 0.3988I0417 21:41:55.312256 140366129284928 keras_utils.py:163] TimeHistory: 0.06 seconds, 33.06 examples/second between steps 30 and 31
    32/100000 [..............................] - ETA: 98:05:06 - loss: 0.7372 - accuracy: 0.4019 I0417 21:41:55.374870 140366129284928 keras_utils.py:163] TimeHistory: 0.06 seconds, 32.60 examples/second between steps 31 and 32
    33/100000 [..............................] - ETA: 110:20:55 - loss: 0.7360 - accuracy: 0.4049I0417 21:42:13.040830 140366129284928 keras_utils.py:163] TimeHistory: 17.66 seconds, 0.11 examples/second between steps 32 and 33
    34/100000 [..............................] - ETA: 121:51:34 - loss: 0.7349 - accuracy: 0.4077I0417 21:42:30.695685 140366129284928 keras_utils.py:163] TimeHistory: 17.65 seconds, 0.11 examples/second between steps 33 and 34
    35/100000 [..............................] - ETA: 118:19:21 - loss: 0.7339 - accuracy: 0.4098I0417 21:42:30.754501 140366129284928 keras_utils.py:163] TimeHistory: 0.06 seconds, 35.55 examples/second between steps 34 and 35
    36/100000 [..............................] - ETA: 114:59:05 - loss: 0.7330 - accuracy: 0.4112I0417 21:42:30.810077 140366129284928 keras_utils.py:163] TimeHistory: 0.05 seconds, 36.95 examples/second between steps 35 and 36
    37/100000 [..............................] - ETA: 111:50:21 - loss: 0.7323 - accuracy: 0.4121I0417 21:42:30.874338 140366129284928 keras_utils.py:163] TimeHistory: 0.06 seconds, 31.85 examples/second between steps 36 and 37
    38/100000 [..............................] - ETA: 122:02:22 - loss: 0.7315 - accuracy: 0.4130I0417 21:42:48.495687 140366129284928 keras_utils.py:163] TimeHistory: 17.62 seconds, 0.11 examples/second between steps 37 and 38
    39/100000 [..............................] - ETA: 131:39:20 - loss: 0.7307 - accuracy: 0.4139I0417 21:43:06.052475 140366129284928 keras_utils.py:163] TimeHistory: 17.55 seconds, 0.11 examples/second between steps 38 and 39
    40/100000 [..............................] - ETA: 128:19:45 - loss: 0.7299 - accuracy: 0.4148I0417 21:43:06.123408 140366129284928 keras_utils.py:163] TimeHistory: 0.07 seconds, 29.21 examples/second between steps 39 and 40
I0417 21:43:06.125249 140366129284928 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695570972/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 4
I0417 21:43:06.125451 140366129284928 training.py:1298] Heterogeneous profiling: now profiling batch size 4
INFO:tensorflow:Running non-virtual train step
I0417 21:43:06.133990 140359739447040 training.py:940] Running non-virtual train step
    41/100000 [..............................] - ETA: 142:29:07 - loss: 0.7292 - accuracy: 0.4154I0417 21:43:31.140457 140366129284928 keras_utils.py:163] TimeHistory: 25.01 seconds, 0.16 examples/second between steps 40 and 41
    42/100000 [..............................] - ETA: 139:42:17 - loss: 0.7286 - accuracy: 0.4160I0417 21:43:32.167912 140366129284928 keras_utils.py:163] TimeHistory: 1.02 seconds, 3.90 examples/second between steps 41 and 42
    43/100000 [..............................] - ETA: 136:26:20 - loss: 0.7282 - accuracy: 0.4163I0417 21:43:32.261411 140366129284928 keras_utils.py:163] TimeHistory: 0.09 seconds, 43.65 examples/second between steps 42 and 43
    44/100000 [..............................] - ETA: 133:19:24 - loss: 0.7279 - accuracy: 0.4164I0417 21:43:32.352550 140366129284928 keras_utils.py:163] TimeHistory: 0.09 seconds, 44.66 examples/second between steps 43 and 44
    45/100000 [..............................] - ETA: 130:20:56 - loss: 0.7275 - accuracy: 0.4169I0417 21:43:32.442661 140366129284928 keras_utils.py:163] TimeHistory: 0.09 seconds, 45.07 examples/second between steps 44 and 45
    46/100000 [..............................] - ETA: 127:30:21 - loss: 0.7271 - accuracy: 0.4174I0417 21:43:32.531679 140366129284928 keras_utils.py:163] TimeHistory: 0.09 seconds, 45.60 examples/second between steps 45 and 46
    47/100000 [..............................] - ETA: 124:47:09 - loss: 0.7268 - accuracy: 0.4179I0417 21:43:32.619824 140366129284928 keras_utils.py:163] TimeHistory: 0.09 seconds, 46.08 examples/second between steps 46 and 47
    48/100000 [..............................] - ETA: 122:10:54 - loss: 0.7265 - accuracy: 0.4185I0417 21:43:32.707823 140366129284928 keras_utils.py:163] TimeHistory: 0.09 seconds, 46.11 examples/second between steps 47 and 48
    49/100000 [..............................] - ETA: 130:11:02 - loss: 0.7262 - accuracy: 0.4191I0417 21:43:50.945608 140366129284928 keras_utils.py:163] TimeHistory: 18.24 seconds, 0.22 examples/second between steps 48 and 49
    50/100000 [..............................] - ETA: 127:34:45 - loss: 0.7259 - accuracy: 0.4195I0417 21:43:51.039352 140366129284928 keras_utils.py:163] TimeHistory: 0.09 seconds, 43.92 examples/second between steps 49 and 50
    51/100000 [..............................] - ETA: 125:04:32 - loss: 0.7257 - accuracy: 0.4200I0417 21:43:51.128093 140366129284928 keras_utils.py:163] TimeHistory: 0.09 seconds, 45.84 examples/second between steps 50 and 51
    52/100000 [..............................] - ETA: 122:40:13 - loss: 0.7254 - accuracy: 0.4205I0417 21:43:51.217026 140366129284928 keras_utils.py:163] TimeHistory: 0.09 seconds, 45.70 examples/second between steps 51 and 52
    53/100000 [..............................] - ETA: 120:21:27 - loss: 0.7252 - accuracy: 0.4211I0417 21:43:51.305845 140366129284928 keras_utils.py:163] TimeHistory: 0.09 seconds, 45.71 examples/second between steps 52 and 53
    54/100000 [..............................] - ETA: 118:07:23 - loss: 0.7250 - accuracy: 0.4215I0417 21:43:51.377574 140366129284928 keras_utils.py:163] TimeHistory: 0.07 seconds, 56.82 examples/second between steps 53 and 54
    55/100000 [..............................] - ETA: 125:13:53 - loss: 0.7247 - accuracy: 0.4220I0417 21:44:09.461555 140366129284928 keras_utils.py:163] TimeHistory: 18.08 seconds, 0.22 examples/second between steps 54 and 55
    56/100000 [..............................] - ETA: 123:00:01 - loss: 0.7244 - accuracy: 0.4227I0417 21:44:09.554188 140366129284928 keras_utils.py:163] TimeHistory: 0.09 seconds, 44.49 examples/second between steps 55 and 56
    57/100000 [..............................] - ETA: 129:45:52 - loss: 0.7241 - accuracy: 0.4235I0417 21:44:27.632132 140366129284928 keras_utils.py:163] TimeHistory: 18.08 seconds, 0.22 examples/second between steps 56 and 57
    58/100000 [..............................] - ETA: 127:32:05 - loss: 0.7238 - accuracy: 0.4241I0417 21:44:27.730614 140366129284928 keras_utils.py:163] TimeHistory: 0.10 seconds, 41.67 examples/second between steps 57 and 58
    59/100000 [..............................] - ETA: 125:22:47 - loss: 0.7236 - accuracy: 0.4245I0417 21:44:27.824807 140366129284928 keras_utils.py:163] TimeHistory: 0.09 seconds, 43.12 examples/second between steps 58 and 59
    60/100000 [..............................] - ETA: 131:45:06 - loss: 0.7234 - accuracy: 0.4250I0417 21:44:45.886197 140366129284928 keras_utils.py:163] TimeHistory: 18.06 seconds, 0.22 examples/second between steps 59 and 60
I0417 21:44:45.889052 140366129284928 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695570972/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 8
I0417 21:44:45.889321 140366129284928 training.py:1298] Heterogeneous profiling: now profiling batch size 8
INFO:tensorflow:Running non-virtual train step
I0417 21:44:45.898607 140359781394176 training.py:940] Running non-virtual train step
    61/100000 [..............................] - ETA: 141:31:39 - loss: 0.7233 - accuracy: 0.4252I0417 21:45:11.763498 140366129284928 keras_utils.py:163] TimeHistory: 25.87 seconds, 0.31 examples/second between steps 60 and 61
    62/100000 [..............................] - ETA: 139:46:23 - loss: 0.7231 - accuracy: 0.4256I0417 21:45:13.009211 140366129284928 keras_utils.py:163] TimeHistory: 1.24 seconds, 6.44 examples/second between steps 61 and 62
    63/100000 [..............................] - ETA: 137:34:50 - loss: 0.7229 - accuracy: 0.4259I0417 21:45:13.150488 140366129284928 keras_utils.py:163] TimeHistory: 0.14 seconds, 57.32 examples/second between steps 62 and 63
    64/100000 [..............................] - ETA: 135:27:26 - loss: 0.7228 - accuracy: 0.4261I0417 21:45:13.291003 140366129284928 keras_utils.py:163] TimeHistory: 0.14 seconds, 57.51 examples/second between steps 63 and 64
    65/100000 [..............................] - ETA: 133:24:01 - loss: 0.7226 - accuracy: 0.4262I0417 21:45:13.431289 140366129284928 keras_utils.py:163] TimeHistory: 0.14 seconds, 57.60 examples/second between steps 64 and 65
    66/100000 [..............................] - ETA: 131:24:24 - loss: 0.7224 - accuracy: 0.4264I0417 21:45:13.571948 140366129284928 keras_utils.py:163] TimeHistory: 0.14 seconds, 57.42 examples/second between steps 65 and 66
    67/100000 [..............................] - ETA: 129:28:25 - loss: 0.7222 - accuracy: 0.4267I0417 21:45:13.712970 140366129284928 keras_utils.py:163] TimeHistory: 0.14 seconds, 57.28 examples/second between steps 66 and 67
    68/100000 [..............................] - ETA: 127:35:53 - loss: 0.7221 - accuracy: 0.4269I0417 21:45:13.853273 140366129284928 keras_utils.py:163] TimeHistory: 0.14 seconds, 57.57 examples/second between steps 67 and 68
    69/100000 [..............................] - ETA: 125:46:39 - loss: 0.7219 - accuracy: 0.4273I0417 21:45:13.992868 140366129284928 keras_utils.py:163] TimeHistory: 0.14 seconds, 57.86 examples/second between steps 68 and 69
    70/100000 [..............................] - ETA: 124:00:35 - loss: 0.7217 - accuracy: 0.4276I0417 21:45:14.132924 140366129284928 keras_utils.py:163] TimeHistory: 0.14 seconds, 57.66 examples/second between steps 69 and 70
    71/100000 [..............................] - ETA: 122:17:34 - loss: 0.7215 - accuracy: 0.4281I0417 21:45:14.273683 140366129284928 keras_utils.py:163] TimeHistory: 0.14 seconds, 57.35 examples/second between steps 70 and 71
    72/100000 [..............................] - ETA: 120:37:27 - loss: 0.7213 - accuracy: 0.4286I0417 21:45:14.415016 140366129284928 keras_utils.py:163] TimeHistory: 0.14 seconds, 57.14 examples/second between steps 71 and 72
    73/100000 [..............................] - ETA: 126:11:06 - loss: 0.7212 - accuracy: 0.4290I0417 21:45:33.188228 140366129284928 keras_utils.py:163] TimeHistory: 18.77 seconds, 0.43 examples/second between steps 72 and 73
    74/100000 [..............................] - ETA: 124:30:39 - loss: 0.7210 - accuracy: 0.4294I0417 21:45:33.333824 140366129284928 keras_utils.py:163] TimeHistory: 0.14 seconds, 56.05 examples/second between steps 73 and 74
    75/100000 [..............................] - ETA: 122:52:11 - loss: 0.7209 - accuracy: 0.4298I0417 21:45:33.447759 140366129284928 keras_utils.py:163] TimeHistory: 0.11 seconds, 71.14 examples/second between steps 74 and 75
    76/100000 [..............................] - ETA: 121:16:56 - loss: 0.7207 - accuracy: 0.4303I0417 21:45:33.588106 140366129284928 keras_utils.py:163] TimeHistory: 0.14 seconds, 57.59 examples/second between steps 75 and 76
    77/100000 [..............................] - ETA: 119:44:12 - loss: 0.7206 - accuracy: 0.4309I0417 21:45:33.729069 140366129284928 keras_utils.py:163] TimeHistory: 0.14 seconds, 57.32 examples/second between steps 76 and 77
    78/100000 [..............................] - ETA: 118:13:51 - loss: 0.7205 - accuracy: 0.4313I0417 21:45:33.869150 140366129284928 keras_utils.py:163] TimeHistory: 0.14 seconds, 57.71 examples/second between steps 77 and 78
    79/100000 [..............................] - ETA: 116:45:50 - loss: 0.7204 - accuracy: 0.4317I0417 21:45:34.009145 140366129284928 keras_utils.py:163] TimeHistory: 0.14 seconds, 57.72 examples/second between steps 78 and 79
    80/100000 [..............................] - ETA: 121:51:14 - loss: 0.7203 - accuracy: 0.4321I0417 21:45:52.707770 140366129284928 keras_utils.py:163] TimeHistory: 18.70 seconds, 0.43 examples/second between steps 79 and 80
I0417 21:45:52.710780 140366129284928 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695570972/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 12
I0417 21:45:52.711043 140366129284928 training.py:1298] Heterogeneous profiling: now profiling batch size 12
INFO:tensorflow:Running non-virtual train step
I0417 21:45:52.720382 140360773965568 training.py:940] Running non-virtual train step
    81/100000 [..............................] - ETA: 129:48:24 - loss: 0.7202 - accuracy: 0.4325I0417 21:46:20.024072 140366129284928 keras_utils.py:163] TimeHistory: 27.31 seconds, 0.44 examples/second between steps 80 and 81
    82/100000 [..............................] - ETA: 128:15:21 - loss: 0.7201 - accuracy: 0.4329I0417 21:46:20.178548 140366129284928 keras_utils.py:163] TimeHistory: 0.15 seconds, 79.22 examples/second between steps 81 and 82
    83/100000 [..............................] - ETA: 127:07:52 - loss: 0.7200 - accuracy: 0.4334I0417 21:46:21.480339 140366129284928 keras_utils.py:163] TimeHistory: 1.30 seconds, 9.23 examples/second between steps 82 and 83
    84/100000 [..............................] - ETA: 125:39:47 - loss: 0.7198 - accuracy: 0.4338I0417 21:46:21.674032 140366129284928 keras_utils.py:163] TimeHistory: 0.19 seconds, 62.52 examples/second between steps 83 and 84
    85/100000 [..............................] - ETA: 124:13:47 - loss: 0.7198 - accuracy: 0.4342I0417 21:46:21.867780 140366129284928 keras_utils.py:163] TimeHistory: 0.19 seconds, 62.44 examples/second between steps 84 and 85
    86/100000 [..............................] - ETA: 122:48:57 - loss: 0.7197 - accuracy: 0.4346I0417 21:46:22.017709 140366129284928 keras_utils.py:163] TimeHistory: 0.15 seconds, 80.78 examples/second between steps 85 and 86
    87/100000 [..............................] - ETA: 121:26:56 - loss: 0.7196 - accuracy: 0.4350I0417 21:46:22.210433 140366129284928 keras_utils.py:163] TimeHistory: 0.19 seconds, 62.70 examples/second between steps 86 and 87
    88/100000 [..............................] - ETA: 120:06:49 - loss: 0.7195 - accuracy: 0.4354I0417 21:46:22.404400 140366129284928 keras_utils.py:163] TimeHistory: 0.19 seconds, 62.33 examples/second between steps 87 and 88
    89/100000 [..............................] - ETA: 118:48:30 - loss: 0.7194 - accuracy: 0.4359I0417 21:46:22.597190 140366129284928 keras_utils.py:163] TimeHistory: 0.19 seconds, 62.69 examples/second between steps 88 and 89
    90/100000 [..............................] - ETA: 117:31:55 - loss: 0.7193 - accuracy: 0.4363I0417 21:46:22.789103 140366129284928 keras_utils.py:163] TimeHistory: 0.19 seconds, 62.97 examples/second between steps 89 and 90
    91/100000 [..............................] - ETA: 116:17:03 - loss: 0.7192 - accuracy: 0.4367I0417 21:46:22.981323 140366129284928 keras_utils.py:163] TimeHistory: 0.19 seconds, 62.87 examples/second between steps 90 and 91
    92/100000 [..............................] - ETA: 115:03:50 - loss: 0.7191 - accuracy: 0.4370I0417 21:46:23.173401 140366129284928 keras_utils.py:163] TimeHistory: 0.19 seconds, 62.89 examples/second between steps 91 and 92
    93/100000 [..............................] - ETA: 113:52:11 - loss: 0.7191 - accuracy: 0.4374I0417 21:46:23.364988 140366129284928 keras_utils.py:163] TimeHistory: 0.19 seconds, 63.09 examples/second between steps 92 and 93
    94/100000 [..............................] - ETA: 112:42:06 - loss: 0.7190 - accuracy: 0.4377I0417 21:46:23.557389 140366129284928 keras_utils.py:163] TimeHistory: 0.19 seconds, 62.83 examples/second between steps 93 and 94
    95/100000 [..............................] - ETA: 111:33:30 - loss: 0.7189 - accuracy: 0.4381I0417 21:46:23.749669 140366129284928 keras_utils.py:163] TimeHistory: 0.19 seconds, 62.86 examples/second between steps 94 and 95
    96/100000 [..............................] - ETA: 110:26:20 - loss: 0.7188 - accuracy: 0.4386I0417 21:46:23.941421 140366129284928 keras_utils.py:163] TimeHistory: 0.19 seconds, 63.02 examples/second between steps 95 and 96
    97/100000 [..............................] - ETA: 109:20:35 - loss: 0.7187 - accuracy: 0.4390I0417 21:46:24.133788 140366129284928 keras_utils.py:163] TimeHistory: 0.19 seconds, 62.83 examples/second between steps 96 and 97
    98/100000 [..............................] - ETA: 108:16:11 - loss: 0.7186 - accuracy: 0.4395I0417 21:46:24.326171 140366129284928 keras_utils.py:163] TimeHistory: 0.19 seconds, 62.84 examples/second between steps 97 and 98
    99/100000 [..............................] - ETA: 107:13:06 - loss: 0.7185 - accuracy: 0.4399I0417 21:46:24.518583 140366129284928 keras_utils.py:163] TimeHistory: 0.19 seconds, 62.79 examples/second between steps 98 and 99
   100/100000 [..............................] - ETA: 106:11:17 - loss: 0.7184 - accuracy: 0.4403I0417 21:46:24.710584 140366129284928 keras_utils.py:163] TimeHistory: 0.19 seconds, 63.01 examples/second between steps 99 and 100
I0417 21:46:24.712324 140366129284928 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695570972/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 16
I0417 21:46:24.712537 140366129284928 training.py:1298] Heterogeneous profiling: now profiling batch size 16
INFO:tensorflow:Running non-virtual train step
I0417 21:46:24.720639 140360551393024 training.py:940] Running non-virtual train step
   101/100000 [..............................] - ETA: 112:56:09 - loss: 0.7183 - accuracy: 0.4407I0417 21:46:52.858150 140366129284928 keras_utils.py:163] TimeHistory: 28.15 seconds, 0.57 examples/second between steps 100 and 101
   102/100000 [..............................] - ETA: 112:10:03 - loss: 0.7182 - accuracy: 0.4410I0417 21:46:54.135152 140366129284928 keras_utils.py:163] TimeHistory: 1.27 seconds, 12.56 examples/second between steps 101 and 102
   103/100000 [..............................] - ETA: 111:08:00 - loss: 0.7182 - accuracy: 0.4413I0417 21:46:54.380067 140366129284928 keras_utils.py:163] TimeHistory: 0.24 seconds, 65.79 examples/second between steps 102 and 103
   104/100000 [..............................] - ETA: 110:07:08 - loss: 0.7181 - accuracy: 0.4416I0417 21:46:54.623231 140366129284928 keras_utils.py:163] TimeHistory: 0.24 seconds, 66.18 examples/second between steps 103 and 104
   105/100000 [..............................] - ETA: 109:07:25 - loss: 0.7181 - accuracy: 0.4419I0417 21:46:54.865983 140366129284928 keras_utils.py:163] TimeHistory: 0.24 seconds, 66.29 examples/second between steps 104 and 105
   106/100000 [..............................] - ETA: 108:08:51 - loss: 0.7180 - accuracy: 0.4422I0417 21:46:55.108785 140366129284928 keras_utils.py:163] TimeHistory: 0.24 seconds, 66.28 examples/second between steps 105 and 106
   107/100000 [..............................] - ETA: 107:11:22 - loss: 0.7180 - accuracy: 0.4425I0417 21:46:55.350390 140366129284928 keras_utils.py:163] TimeHistory: 0.24 seconds, 66.58 examples/second between steps 106 and 107
   108/100000 [..............................] - ETA: 106:14:58 - loss: 0.7179 - accuracy: 0.4428I0417 21:46:55.592786 140366129284928 keras_utils.py:163] TimeHistory: 0.24 seconds, 66.37 examples/second between steps 107 and 108
   109/100000 [..............................] - ETA: 105:19:37 - loss: 0.7179 - accuracy: 0.4431I0417 21:46:55.835182 140366129284928 keras_utils.py:163] TimeHistory: 0.24 seconds, 66.37 examples/second between steps 108 and 109
   110/100000 [..............................] - ETA: 104:25:16 - loss: 0.7178 - accuracy: 0.4434I0417 21:46:56.077116 140366129284928 keras_utils.py:163] TimeHistory: 0.24 seconds, 66.50 examples/second between steps 109 and 110
   111/100000 [..............................] - ETA: 103:31:55 - loss: 0.7178 - accuracy: 0.4438I0417 21:46:56.319813 140366129284928 keras_utils.py:163] TimeHistory: 0.24 seconds, 66.33 examples/second between steps 110 and 111
   112/100000 [..............................] - ETA: 102:39:32 - loss: 0.7177 - accuracy: 0.4441I0417 21:46:56.562657 140366129284928 keras_utils.py:163] TimeHistory: 0.24 seconds, 66.25 examples/second between steps 111 and 112
   113/100000 [..............................] - ETA: 101:48:05 - loss: 0.7176 - accuracy: 0.4445I0417 21:46:56.804553 140366129284928 keras_utils.py:163] TimeHistory: 0.24 seconds, 66.55 examples/second between steps 112 and 113
   114/100000 [..............................] - ETA: 100:57:32 - loss: 0.7176 - accuracy: 0.4448I0417 21:46:57.047275 140366129284928 keras_utils.py:163] TimeHistory: 0.24 seconds, 66.29 examples/second between steps 113 and 114
   115/100000 [..............................] - ETA: 100:07:54 - loss: 0.7175 - accuracy: 0.4451I0417 21:46:57.290475 140366129284928 keras_utils.py:163] TimeHistory: 0.24 seconds, 66.20 examples/second between steps 114 and 115
   116/100000 [..............................] - ETA: 99:19:07 - loss: 0.7174 - accuracy: 0.4455 I0417 21:46:57.533589 140366129284928 keras_utils.py:163] TimeHistory: 0.24 seconds, 66.17 examples/second between steps 115 and 116
   117/100000 [..............................] - ETA: 103:29:55 - loss: 0.7174 - accuracy: 0.4458I0417 21:47:18.594201 140366129284928 keras_utils.py:163] TimeHistory: 21.06 seconds, 0.76 examples/second between steps 116 and 117
   118/100000 [..............................] - ETA: 102:40:17 - loss: 0.7173 - accuracy: 0.4462I0417 21:47:18.840728 140366129284928 keras_utils.py:163] TimeHistory: 0.24 seconds, 65.59 examples/second between steps 117 and 118
   119/100000 [..............................] - ETA: 101:51:28 - loss: 0.7172 - accuracy: 0.4465I0417 21:47:19.084424 140366129284928 keras_utils.py:163] TimeHistory: 0.24 seconds, 66.03 examples/second between steps 118 and 119
   120/100000 [..............................] - ETA: 105:56:46 - loss: 0.7172 - accuracy: 0.4469I0417 21:47:40.296438 140366129284928 keras_utils.py:163] TimeHistory: 21.21 seconds, 0.75 examples/second between steps 119 and 120
I0417 21:47:40.299552 140366129284928 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695570972/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 24
I0417 21:47:40.299812 140366129284928 training.py:1298] Heterogeneous profiling: now profiling batch size 24
INFO:tensorflow:Running non-virtual train step
I0417 21:47:40.308985 140360530417408 training.py:940] Running non-virtual train step
   121/100000 [..............................] - ETA: 112:16:22 - loss: 0.7171 - accuracy: 0.4472I0417 21:48:11.483796 140366129284928 keras_utils.py:163] TimeHistory: 31.18 seconds, 0.77 examples/second between steps 120 and 121
   122/100000 [..............................] - ETA: 111:39:16 - loss: 0.7170 - accuracy: 0.4475I0417 21:48:12.838992 140366129284928 keras_utils.py:163] TimeHistory: 1.35 seconds, 17.75 examples/second between steps 121 and 122
   123/100000 [..............................] - ETA: 110:49:08 - loss: 0.7170 - accuracy: 0.4478I0417 21:48:13.193888 140366129284928 keras_utils.py:163] TimeHistory: 0.35 seconds, 67.96 examples/second between steps 122 and 123
   124/100000 [..............................] - ETA: 109:59:48 - loss: 0.7169 - accuracy: 0.4482I0417 21:48:13.547821 140366129284928 keras_utils.py:163] TimeHistory: 0.35 seconds, 68.09 examples/second between steps 123 and 124
   125/100000 [..............................] - ETA: 109:11:15 - loss: 0.7169 - accuracy: 0.4485I0417 21:48:13.900803 140366129284928 keras_utils.py:163] TimeHistory: 0.35 seconds, 68.25 examples/second between steps 124 and 125
   126/100000 [..............................] - ETA: 108:23:29 - loss: 0.7168 - accuracy: 0.4489I0417 21:48:14.254195 140366129284928 keras_utils.py:163] TimeHistory: 0.35 seconds, 68.17 examples/second between steps 125 and 126
   127/100000 [..............................] - ETA: 107:36:28 - loss: 0.7167 - accuracy: 0.4492I0417 21:48:14.607518 140366129284928 keras_utils.py:163] TimeHistory: 0.35 seconds, 68.19 examples/second between steps 126 and 127
   128/100000 [..............................] - ETA: 106:50:11 - loss: 0.7167 - accuracy: 0.4496I0417 21:48:14.960110 140366129284928 keras_utils.py:163] TimeHistory: 0.35 seconds, 68.36 examples/second between steps 127 and 128
   129/100000 [..............................] - ETA: 106:03:28 - loss: 0.7166 - accuracy: 0.4500I0417 21:48:15.222555 140366129284928 keras_utils.py:163] TimeHistory: 0.26 seconds, 91.92 examples/second between steps 128 and 129
   130/100000 [..............................] - ETA: 105:18:38 - loss: 0.7165 - accuracy: 0.4503I0417 21:48:15.576592 140366129284928 keras_utils.py:163] TimeHistory: 0.35 seconds, 68.05 examples/second between steps 129 and 130
   131/100000 [..............................] - ETA: 104:34:29 - loss: 0.7165 - accuracy: 0.4507I0417 21:48:15.929292 140366129284928 keras_utils.py:163] TimeHistory: 0.35 seconds, 68.30 examples/second between steps 130 and 131
   132/100000 [..............................] - ETA: 103:51:00 - loss: 0.7164 - accuracy: 0.4510I0417 21:48:16.281719 140366129284928 keras_utils.py:163] TimeHistory: 0.35 seconds, 68.38 examples/second between steps 131 and 132
   133/100000 [..............................] - ETA: 103:08:11 - loss: 0.7164 - accuracy: 0.4513I0417 21:48:16.635051 140366129284928 keras_utils.py:163] TimeHistory: 0.35 seconds, 68.19 examples/second between steps 132 and 133
   134/100000 [..............................] - ETA: 102:26:01 - loss: 0.7163 - accuracy: 0.4515I0417 21:48:16.987427 140366129284928 keras_utils.py:163] TimeHistory: 0.35 seconds, 68.39 examples/second between steps 133 and 134
   135/100000 [..............................] - ETA: 101:44:28 - loss: 0.7163 - accuracy: 0.4518I0417 21:48:17.340449 140366129284928 keras_utils.py:163] TimeHistory: 0.35 seconds, 68.25 examples/second between steps 134 and 135
   136/100000 [..............................] - ETA: 101:03:32 - loss: 0.7162 - accuracy: 0.4521I0417 21:48:17.693295 140366129284928 keras_utils.py:163] TimeHistory: 0.35 seconds, 68.27 examples/second between steps 135 and 136
   137/100000 [..............................] - ETA: 100:23:12 - loss: 0.7161 - accuracy: 0.4524I0417 21:48:18.045268 140366129284928 keras_utils.py:163] TimeHistory: 0.35 seconds, 68.44 examples/second between steps 136 and 137
   138/100000 [..............................] - ETA: 99:43:28 - loss: 0.7161 - accuracy: 0.4527 I0417 21:48:18.398586 140366129284928 keras_utils.py:163] TimeHistory: 0.35 seconds, 68.19 examples/second between steps 137 and 138
   139/100000 [..............................] - ETA: 99:04:18 - loss: 0.7160 - accuracy: 0.4530I0417 21:48:18.751468 140366129284928 keras_utils.py:163] TimeHistory: 0.35 seconds, 68.28 examples/second between steps 138 and 139
   140/100000 [..............................] - ETA: 98:25:43 - loss: 0.7160 - accuracy: 0.4532I0417 21:48:19.104689 140366129284928 keras_utils.py:163] TimeHistory: 0.35 seconds, 68.20 examples/second between steps 139 and 140
I0417 21:48:19.106563 140366129284928 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695570972/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 32
I0417 21:48:19.106747 140366129284928 training.py:1298] Heterogeneous profiling: now profiling batch size 32
INFO:tensorflow:Running non-virtual train step
I0417 21:48:19.114825 140360368654080 training.py:940] Running non-virtual train step
   141/100000 [..............................] - ETA: 102:55:05 - loss: 0.7159 - accuracy: 0.4534I0417 21:48:45.316998 140366129284928 keras_utils.py:163] TimeHistory: 26.21 seconds, 1.22 examples/second between steps 140 and 141
   142/100000 [..............................] - ETA: 102:27:39 - loss: 0.7159 - accuracy: 0.4537I0417 21:48:46.708186 140366129284928 keras_utils.py:163] TimeHistory: 1.39 seconds, 23.06 examples/second between steps 141 and 142
   143/100000 [..............................] - ETA: 101:49:33 - loss: 0.7159 - accuracy: 0.4539I0417 21:48:47.156125 140366129284928 keras_utils.py:163] TimeHistory: 0.45 seconds, 71.71 examples/second between steps 142 and 143
   144/100000 [..............................] - ETA: 101:11:59 - loss: 0.7158 - accuracy: 0.4541I0417 21:48:47.604902 140366129284928 keras_utils.py:163] TimeHistory: 0.45 seconds, 71.56 examples/second between steps 143 and 144
   145/100000 [..............................] - ETA: 100:34:55 - loss: 0.7158 - accuracy: 0.4543I0417 21:48:48.052169 140366129284928 keras_utils.py:163] TimeHistory: 0.45 seconds, 71.78 examples/second between steps 144 and 145
   146/100000 [..............................] - ETA: 99:58:22 - loss: 0.7157 - accuracy: 0.4545 I0417 21:48:48.498648 140366129284928 keras_utils.py:163] TimeHistory: 0.45 seconds, 71.89 examples/second between steps 145 and 146
   147/100000 [..............................] - ETA: 99:22:19 - loss: 0.7157 - accuracy: 0.4547I0417 21:48:48.945028 140366129284928 keras_utils.py:163] TimeHistory: 0.44 seconds, 71.91 examples/second between steps 146 and 147
   148/100000 [..............................] - ETA: 98:46:46 - loss: 0.7156 - accuracy: 0.4549I0417 21:48:49.393440 140366129284928 keras_utils.py:163] TimeHistory: 0.45 seconds, 71.59 examples/second between steps 147 and 148
   149/100000 [..............................] - ETA: 98:11:41 - loss: 0.7156 - accuracy: 0.4551I0417 21:48:49.839472 140366129284928 keras_utils.py:163] TimeHistory: 0.44 seconds, 71.96 examples/second between steps 148 and 149
   150/100000 [..............................] - ETA: 97:37:04 - loss: 0.7155 - accuracy: 0.4553I0417 21:48:50.286069 140366129284928 keras_utils.py:163] TimeHistory: 0.44 seconds, 71.91 examples/second between steps 149 and 150
   151/100000 [..............................] - ETA: 97:02:55 - loss: 0.7155 - accuracy: 0.4555I0417 21:48:50.732777 140366129284928 keras_utils.py:163] TimeHistory: 0.45 seconds, 71.87 examples/second between steps 150 and 151
   152/100000 [..............................] - ETA: 96:29:14 - loss: 0.7154 - accuracy: 0.4557I0417 21:48:51.180143 140366129284928 keras_utils.py:163] TimeHistory: 0.45 seconds, 71.74 examples/second between steps 151 and 152
   153/100000 [..............................] - ETA: 95:55:59 - loss: 0.7154 - accuracy: 0.4560I0417 21:48:51.627611 140366129284928 keras_utils.py:163] TimeHistory: 0.45 seconds, 71.76 examples/second between steps 152 and 153
   154/100000 [..............................] - ETA: 95:23:09 - loss: 0.7153 - accuracy: 0.4562I0417 21:48:52.073967 140366129284928 keras_utils.py:163] TimeHistory: 0.44 seconds, 71.93 examples/second between steps 153 and 154
   155/100000 [..............................] - ETA: 94:50:47 - loss: 0.7153 - accuracy: 0.4564I0417 21:48:52.521957 140366129284928 keras_utils.py:163] TimeHistory: 0.45 seconds, 71.68 examples/second between steps 154 and 155
   156/100000 [..............................] - ETA: 94:18:49 - loss: 0.7152 - accuracy: 0.4566I0417 21:48:52.969626 140366129284928 keras_utils.py:163] TimeHistory: 0.45 seconds, 71.71 examples/second between steps 155 and 156
   157/100000 [..............................] - ETA: 93:47:15 - loss: 0.7152 - accuracy: 0.4569I0417 21:48:53.416015 140366129284928 keras_utils.py:163] TimeHistory: 0.45 seconds, 71.90 examples/second between steps 156 and 157
   158/100000 [..............................] - ETA: 93:16:05 - loss: 0.7151 - accuracy: 0.4571I0417 21:48:53.862674 140366129284928 keras_utils.py:163] TimeHistory: 0.45 seconds, 71.86 examples/second between steps 157 and 158
   159/100000 [..............................] - ETA: 92:45:18 - loss: 0.7151 - accuracy: 0.4573I0417 21:48:54.308658 140366129284928 keras_utils.py:163] TimeHistory: 0.44 seconds, 71.97 examples/second between steps 158 and 159
   160/100000 [..............................] - ETA: 92:14:55 - loss: 0.7150 - accuracy: 0.4575I0417 21:48:54.755268 140366129284928 keras_utils.py:163] TimeHistory: 0.45 seconds, 71.87 examples/second between steps 159 and 160
I0417 21:48:54.757049 140366129284928 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695570972/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling: now profiling batch size 48
I0417 21:48:54.757233 140366129284928 training.py:1298] Heterogeneous profiling: now profiling batch size 48
INFO:tensorflow:Running non-virtual train step
I0417 21:48:54.765509 140360251205376 training.py:940] Running non-virtual train step
   161/100000 [..............................] - ETA: 96:24:45 - loss: 0.7150 - accuracy: 0.4577I0417 21:49:22.109388 140366129284928 keras_utils.py:163] TimeHistory: 27.35 seconds, 1.75 examples/second between steps 160 and 161
   162/100000 [..............................] - ETA: 96:05:55 - loss: 0.7150 - accuracy: 0.4579I0417 21:49:23.768804 140366129284928 keras_utils.py:163] TimeHistory: 1.66 seconds, 28.98 examples/second between steps 161 and 162
   163/100000 [..............................] - ETA: 95:36:59 - loss: 0.7149 - accuracy: 0.4581I0417 21:49:24.422309 140366129284928 keras_utils.py:163] TimeHistory: 0.65 seconds, 73.64 examples/second between steps 162 and 163
   164/100000 [..............................] - ETA: 95:08:23 - loss: 0.7149 - accuracy: 0.4583I0417 21:49:25.074030 140366129284928 keras_utils.py:163] TimeHistory: 0.65 seconds, 73.82 examples/second between steps 163 and 164
   165/100000 [..............................] - ETA: 94:40:09 - loss: 0.7148 - accuracy: 0.4584I0417 21:49:25.727617 140366129284928 keras_utils.py:163] TimeHistory: 0.65 seconds, 73.61 examples/second between steps 164 and 165
   166/100000 [..............................] - ETA: 94:12:14 - loss: 0.7148 - accuracy: 0.4586I0417 21:49:26.380048 140366129284928 keras_utils.py:163] TimeHistory: 0.65 seconds, 73.74 examples/second between steps 165 and 166
   167/100000 [..............................] - ETA: 93:44:41 - loss: 0.7148 - accuracy: 0.4587I0417 21:49:27.033485 140366129284928 keras_utils.py:163] TimeHistory: 0.65 seconds, 73.64 examples/second between steps 166 and 167
   168/100000 [..............................] - ETA: 93:17:27 - loss: 0.7147 - accuracy: 0.4589I0417 21:49:27.685578 140366129284928 keras_utils.py:163] TimeHistory: 0.65 seconds, 73.79 examples/second between steps 167 and 168
   169/100000 [..............................] - ETA: 92:50:32 - loss: 0.7147 - accuracy: 0.4591I0417 21:49:28.338912 140366129284928 keras_utils.py:163] TimeHistory: 0.65 seconds, 73.64 examples/second between steps 168 and 169
   170/100000 [..............................] - ETA: 92:23:57 - loss: 0.7147 - accuracy: 0.4592I0417 21:49:28.992038 140366129284928 keras_utils.py:163] TimeHistory: 0.65 seconds, 73.67 examples/second between steps 169 and 170
   171/100000 [..............................] - ETA: 91:57:41 - loss: 0.7146 - accuracy: 0.4594I0417 21:49:29.645864 140366129284928 keras_utils.py:163] TimeHistory: 0.65 seconds, 73.59 examples/second between steps 170 and 171
   172/100000 [..............................] - ETA: 91:31:43 - loss: 0.7146 - accuracy: 0.4595I0417 21:49:30.298861 140366129284928 keras_utils.py:163] TimeHistory: 0.65 seconds, 73.67 examples/second between steps 171 and 172
   173/100000 [..............................] - ETA: 91:06:03 - loss: 0.7146 - accuracy: 0.4597I0417 21:49:30.951205 140366129284928 keras_utils.py:163] TimeHistory: 0.65 seconds, 73.74 examples/second between steps 172 and 173
   174/100000 [..............................] - ETA: 90:40:41 - loss: 0.7145 - accuracy: 0.4598I0417 21:49:31.604774 140366129284928 keras_utils.py:163] TimeHistory: 0.65 seconds, 73.61 examples/second between steps 173 and 174
   175/100000 [..............................] - ETA: 90:15:37 - loss: 0.7145 - accuracy: 0.4600I0417 21:49:32.260021 140366129284928 keras_utils.py:163] TimeHistory: 0.65 seconds, 73.42 examples/second between steps 174 and 175
   176/100000 [..............................] - ETA: 89:50:49 - loss: 0.7145 - accuracy: 0.4601I0417 21:49:32.912199 140366129284928 keras_utils.py:163] TimeHistory: 0.65 seconds, 73.77 examples/second between steps 175 and 176
   177/100000 [..............................] - ETA: 89:26:19 - loss: 0.7144 - accuracy: 0.4602I0417 21:49:33.565300 140366129284928 keras_utils.py:163] TimeHistory: 0.65 seconds, 73.67 examples/second between steps 176 and 177
   178/100000 [..............................] - ETA: 89:02:05 - loss: 0.7144 - accuracy: 0.4604I0417 21:49:34.218025 140366129284928 keras_utils.py:163] TimeHistory: 0.65 seconds, 73.71 examples/second between steps 177 and 178
   179/100000 [..............................] - ETA: 88:38:07 - loss: 0.7144 - accuracy: 0.4605I0417 21:49:34.871542 140366129284928 keras_utils.py:163] TimeHistory: 0.65 seconds, 73.60 examples/second between steps 178 and 179
   180/100000 [..............................] - ETA: 88:12:52 - loss: 0.7144 - accuracy: 0.4606I0417 21:49:35.356934 140366129284928 keras_utils.py:163] TimeHistory: 0.48 seconds, 99.20 examples/second between steps 179 and 180
I0417 21:49:35.358738 140366129284928 keras_utils.py:179] Wrote to /root/dev/logs/bert-glue-04_17_21_1618695570972/heterogeneous_profile.txt
INFO:tensorflow:Heterogeneous profiling complete
I0417 21:49:35.358927 140366129284928 training.py:1295] Heterogeneous profiling complete
100000/100000 [==============================] - 597s 6ms/step - loss: 0.7099 - accuracy: 0.4819
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._masked_softmax
W0417 21:49:37.939142 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._dropout
W0417 21:49:37.939337 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._masked_softmax
W0417 21:49:37.939408 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._dropout
W0417 21:49:37.939517 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._masked_softmax
W0417 21:49:37.939572 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._dropout
W0417 21:49:37.939620 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._masked_softmax
W0417 21:49:37.939667 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._dropout
W0417 21:49:37.939717 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._masked_softmax
W0417 21:49:37.939766 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._dropout
W0417 21:49:37.939814 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._masked_softmax
W0417 21:49:37.939863 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._dropout
W0417 21:49:37.939912 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._masked_softmax
W0417 21:49:37.939961 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._dropout
W0417 21:49:37.940010 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._masked_softmax
W0417 21:49:37.940060 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._dropout
W0417 21:49:37.940109 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._masked_softmax
W0417 21:49:37.940163 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._dropout
W0417 21:49:37.940212 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._masked_softmax
W0417 21:49:37.940263 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._dropout
W0417 21:49:37.940312 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._masked_softmax
W0417 21:49:37.940363 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._dropout
W0417 21:49:37.940411 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._masked_softmax
W0417 21:49:37.940461 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._masked_softmax
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._dropout
W0417 21:49:37.940514 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._dropout
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:49:37.940564 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-4._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:49:37.940611 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-5._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:49:37.940660 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-6._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:49:37.940709 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-7._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:49:37.940758 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-8._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:49:37.940807 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-9._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:49:37.940855 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-10._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:49:37.940905 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-11._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:49:37.940954 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-12._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:49:37.941003 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-13._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:49:37.941052 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-14._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._masked_softmax._mask_expansion_axes
W0417 21:49:37.941101 140366129284928 util.py:161] Unresolved object in checkpoint: (root).model.layer_with_weights-15._attention_layer._masked_softmax._mask_expansion_axes
WARNING:tensorflow:A checkpoint was restored (e.g. tf.train.Checkpoint.restore or tf.keras.Model.load_weights) but not all checkpointed values were used. See above for specific issues. Use expect_partial() on the load status object, e.g. tf.train.Checkpoint.restore(...).expect_partial(), to silence these warnings, or use assert_consumed() to make the check explicit. See https://www.tensorflow.org/guide/checkpoint#loading_mechanics for details.
W0417 21:49:37.941156 140366129284928 util.py:169] A checkpoint was restored (e.g. tf.train.Checkpoint.restore or tf.keras.Model.load_weights) but not all checkpointed values were used. See above for specific issues. Use expect_partial() on the load status object, e.g. tf.train.Checkpoint.restore(...).expect_partial(), to silence these warnings, or use assert_consumed() to make the check explicit. See https://www.tensorflow.org/guide/checkpoint#loading_mechanics for details.
