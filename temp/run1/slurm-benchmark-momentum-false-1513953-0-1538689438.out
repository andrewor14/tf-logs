2018-10-04 17:44:06.401464: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-10-04 17:44:06.605285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
totalMemory: 15.90GiB freeMemory: 15.61GiB
2018-10-04 17:44:06.750659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 1 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
totalMemory: 15.90GiB freeMemory: 15.61GiB
2018-10-04 17:44:06.904582: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 2 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:82:00.0
totalMemory: 15.90GiB freeMemory: 15.61GiB
2018-10-04 17:44:07.059150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 3 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:83:00.0
totalMemory: 15.90GiB freeMemory: 15.61GiB
2018-10-04 17:44:07.061833: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1, 2, 3
2018-10-04 17:44:08.188008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-10-04 17:44:08.188058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 2 3 
2018-10-04 17:44:08.188066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y N N 
2018-10-04 17:44:08.188073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N N N 
2018-10-04 17:44:08.188078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 2:   N N N Y 
2018-10-04 17:44:08.188083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 3:   N N Y N 
2018-10-04 17:44:08.189165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/device:GPU:0 with 15129 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2018-10-04 17:44:08.328117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/device:GPU:1 with 15129 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-16GB, pci bus id: 0000:04:00.0, compute capability: 6.0)
2018-10-04 17:44:08.466776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/device:GPU:2 with 15129 MB memory) -> physical GPU (device: 2, name: Tesla P100-PCIE-16GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
2018-10-04 17:44:08.605627: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/device:GPU:3 with 15129 MB memory) -> physical GPU (device: 3, name: Tesla P100-PCIE-16GB, pci bus id: 0000:83:00.0, compute capability: 6.0)
2018-10-04 17:44:08.766678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1, 2, 3
2018-10-04 17:44:08.766895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-10-04 17:44:08.766907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 2 3 
2018-10-04 17:44:08.766914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y N N 
2018-10-04 17:44:08.766920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N N N 
2018-10-04 17:44:08.766925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 2:   N N N Y 
2018-10-04 17:44:08.766930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 3:   N N Y N 
2018-10-04 17:44:08.767356: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/device:GPU:0 with 15129 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2018-10-04 17:44:08.767470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/device:GPU:1 with 15129 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-16GB, pci bus id: 0000:04:00.0, compute capability: 6.0)
2018-10-04 17:44:08.767561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/device:GPU:2 with 15129 MB memory) -> physical GPU (device: 2, name: Tesla P100-PCIE-16GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
2018-10-04 17:44:08.767632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/device:GPU:3 with 15129 MB memory) -> physical GPU (device: 3, name: Tesla P100-PCIE-16GB, pci bus id: 0000:83:00.0, compute capability: 6.0)
2018-10-04 17:44:08.768701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1, 2, 3
2018-10-04 17:44:08.768812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-10-04 17:44:08.768840: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 2 3 
2018-10-04 17:44:08.768846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y N N 
2018-10-04 17:44:08.768851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N N N 
2018-10-04 17:44:08.768856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 2:   N N N Y 
2018-10-04 17:44:08.768862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 3:   N N Y N 
2018-10-04 17:44:08.769196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/device:GPU:0 with 15129 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2018-10-04 17:44:08.769269: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/device:GPU:1 with 15129 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-16GB, pci bus id: 0000:04:00.0, compute capability: 6.0)
2018-10-04 17:44:08.769347: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/device:GPU:2 with 15129 MB memory) -> physical GPU (device: 2, name: Tesla P100-PCIE-16GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
2018-10-04 17:44:08.769405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/device:GPU:3 with 15129 MB memory) -> physical GPU (device: 3, name: Tesla P100-PCIE-16GB, pci bus id: 0000:83:00.0, compute capability: 6.0)
Tensorflow version: 1.10.1
All local devices:
[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 10705311364336769668
, name: "/device:GPU:0"
device_type: "GPU"
memory_limit: 15864515789
locality {
  bus_id: 1
  links {
    link {
      device_id: 1
      type: "StreamExecutor"
      strength: 1
    }
  }
}
incarnation: 14307260006313755529
physical_device_desc: "device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0"
, name: "/device:GPU:1"
device_type: "GPU"
memory_limit: 15864515789
locality {
  bus_id: 1
  links {
    link {
      type: "StreamExecutor"
      strength: 1
    }
  }
}
incarnation: 2726883027232655718
physical_device_desc: "device: 1, name: Tesla P100-PCIE-16GB, pci bus id: 0000:04:00.0, compute capability: 6.0"
, name: "/device:GPU:2"
device_type: "GPU"
memory_limit: 15864515789
locality {
  bus_id: 2
  numa_node: 1
  links {
    link {
      device_id: 3
      type: "StreamExecutor"
      strength: 1
    }
  }
}
incarnation: 11237176853503345032
physical_device_desc: "device: 2, name: Tesla P100-PCIE-16GB, pci bus id: 0000:82:00.0, compute capability: 6.0"
, name: "/device:GPU:3"
device_type: "GPU"
memory_limit: 15864453530
locality {
  bus_id: 2
  numa_node: 1
  links {
    link {
      device_id: 2
      type: "StreamExecutor"
      strength: 1
    }
  }
}
incarnation: 2623390343290299714
physical_device_desc: "device: 3, name: Tesla P100-PCIE-16GB, pci bus id: 0000:83:00.0, compute capability: 6.0"
]
GPU is available? True
GPU device name: /device:GPU:0
CUDA_VISIBLE_DEVICES = 0,1,2,3
==================================================
|                                                |
|        GPU devices detected. Success!          |
|                                                |
==================================================

Running this commit: bd240ef Set up run environment for imagenet resnet50_v1.5
I1004 17:44:15.446551 47933679464064 tf_logging.py:115] Params:

Params(model='resnet50_v1.5', eval=False, eval_interval_secs=0, forward_only=False, freeze_when_forward_only=False, print_training_accuracy=True, batch_size=64, batch_group_size=1, num_batches=None, num_epochs=100.0, num_warmup_batches=None, autotune_threshold=None, num_gpus=4, gpu_indices='', display_every=10, data_dir='/tigress/haoyuz/imagenet-dataset/', data_name=None, resize_method='bilinear', distortions=True, use_datasets=True, input_preprocessor='default', gpu_thread_mode='gpu_shared', per_gpu_thread_count=0, hierarchical_copy=False, network_topology=<NetworkTopology.DGX1: 'dgx1'>, gradient_repacking=0, compact_gradient_transfer=True, variable_consistency='strong', cache_data=False, local_parameter_device='gpu', device='gpu', data_format='NCHW', num_intra_threads=None, num_inter_threads=0, trace_file='', use_chrome_trace_format=True, tfprof_file=None, graph_file=None, partitioned_graph_file_prefix=None, optimizer='momentum', init_learning_rate=None, piecewise_learning_rate_schedule=None, num_epochs_per_decay=0.0, learning_rate_decay_factor=0.0, num_learning_rate_warmup_epochs=0.0, minimum_learning_rate=0.0, momentum=0.9, rmsprop_decay=0.9, rmsprop_momentum=0.9, rmsprop_epsilon=1.0, ksync_num_replicas=4, ksync_mode='sync', ksync_scaling_duration=6500.0, gradient_clip=None, weight_decay=4e-05, gpu_memory_frac_for_testing=0.0, use_tf_layers=True, tf_random_seed=1234, debugger=None, use_python32_barrier=False, datasets_use_prefetch=True, datasets_prefetch_buffer_size=1, datasets_num_private_threads=None, use_multi_device_iterator=False, multi_device_iterator_max_buffer_size=1, winograd_nonfused=True, batchnorm_persistent=True, sync_on_finish=False, staged_vars=False, force_gpu_compatible=False, allow_growth=None, xla=False, fuse_decode_and_crop=True, distort_color_in_yiq=True, enable_optimizations=True, rewriter_config=None, loss_type_to_report='total_loss', single_l2_loss_op=False, use_resource_vars=False, mkl=False, kmp_blocktime=30, kmp_affinity='granularity=fine,verbose,compact,1,0', kmp_settings=1, use_fp16=True, fp16_loss_scale=None, fp16_vars=False, fp16_enable_auto_loss_scale=False, fp16_inc_loss_scale_every_n=1000, variable_update='parameter_server', all_reduce_spec=None, agg_small_grads_max_bytes=0, agg_small_grads_max_group=10, allreduce_merge_scope=1, job_name='ps', ps_hosts='tiger-i19g8:2222', worker_hosts='tiger-i20g6:2222,tiger-i20g7:2222,tiger-i20g12:2222,tiger-i20g15:2222', controller_host=None, task_index=0, server_protocol='grpc', cross_replica_sync=False, horovod_device='', summary_verbosity=0, save_summaries_steps=0, save_model_secs=0, max_ckpts_to_keep=5, train_dir='/tigress/andrewor/logs/resnet50_imagenet_1538689438', eval_dir='/tmp/tf_cnn_benchmarks/eval', benchmark_log_dir=None, benchmark_test_id=None)


2018-10-04 17:44:15.502957: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-10-04 17:44:15.734663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
totalMemory: 15.90GiB freeMemory: 15.61GiB
2018-10-04 17:44:15.957008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 1 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
totalMemory: 15.90GiB freeMemory: 15.61GiB
2018-10-04 17:44:16.105839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 2 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:82:00.0
totalMemory: 15.90GiB freeMemory: 15.61GiB
2018-10-04 17:44:16.258983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 3 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:83:00.0
totalMemory: 15.90GiB freeMemory: 15.61GiB
2018-10-04 17:44:16.261711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1, 2, 3
2018-10-04 17:44:17.382138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-10-04 17:44:17.382191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 2 3 
2018-10-04 17:44:17.382200: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y N N 
2018-10-04 17:44:17.382206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N N N 
2018-10-04 17:44:17.382211: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 2:   N N N Y 
2018-10-04 17:44:17.382216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 3:   N N Y N 
2018-10-04 17:44:17.383287: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:ps/replica:0/task:0/device:GPU:0 with 15129 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2018-10-04 17:44:17.522687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:ps/replica:0/task:0/device:GPU:1 with 15129 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-16GB, pci bus id: 0000:04:00.0, compute capability: 6.0)
2018-10-04 17:44:17.663328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:ps/replica:0/task:0/device:GPU:2 with 15129 MB memory) -> physical GPU (device: 2, name: Tesla P100-PCIE-16GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
2018-10-04 17:44:17.802343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:ps/replica:0/task:0/device:GPU:3 with 15129 MB memory) -> physical GPU (device: 3, name: Tesla P100-PCIE-16GB, pci bus id: 0000:83:00.0, compute capability: 6.0)
2018-10-04 17:44:17.964069: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job ps -> {0 -> localhost:2222}
2018-10-04 17:44:17.964111: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job worker -> {0 -> tiger-i20g6:2222, 1 -> tiger-i20g7:2222, 2 -> tiger-i20g12:2222, 3 -> tiger-i20g15:2222}
2018-10-04 17:44:17.966009: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:375] Started server with target: grpc://localhost:2222
I1004 17:44:17.980474 47933679464064 tf_logging.py:115] TensorFlow:  1.10
I1004 17:44:17.984130 47933679464064 tf_logging.py:115] Model:       resnet50_v1.5
I1004 17:44:17.984216 47933679464064 tf_logging.py:115] Dataset:     imagenet
I1004 17:44:17.984317 47933679464064 tf_logging.py:115] Mode:        training
I1004 17:44:17.984369 47933679464064 tf_logging.py:115] SingleSess:  False
I1004 17:44:17.984454 47933679464064 tf_logging.py:115] Batch size:  1024 global
I1004 17:44:17.984508 47933679464064 tf_logging.py:115]              64.0 per device
I1004 17:44:17.984555 47933679464064 tf_logging.py:115] Num batches: 125113
I1004 17:44:17.984604 47933679464064 tf_logging.py:115] Num epochs:  100.00
I1004 17:44:17.984812 47933679464064 tf_logging.py:115] Devices:     ['/job:worker/replica:0/task:0/gpu:0', '/job:worker/replica:0/task:0/gpu:1', '/job:worker/replica:0/task:0/gpu:2', '/job:worker/replica:0/task:0/gpu:3']
I1004 17:44:17.984982 47933679464064 tf_logging.py:115] Data format: NCHW
I1004 17:44:17.985055 47933679464064 tf_logging.py:115] Optimizer:   momentum
I1004 17:44:17.985118 47933679464064 tf_logging.py:115] Variables:   parameter_server
I1004 17:44:17.985167 47933679464064 tf_logging.py:115] Sync:        False
I1004 17:44:17.985213 47933679464064 tf_logging.py:115] ==========
I1004 17:44:17.985291 47933679464064 tf_logging.py:115] Running parameter server 0
